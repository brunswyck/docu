

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ACLs &mdash; debian &amp; networking 20171017 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="debian &amp; networking 20171017 documentation" href="../../../index.html"/>
        <link rel="up" title="basics" href="inhoud.html"/>
        <link rel="next" title="DHCP" href="dhcp.html"/>
        <link rel="prev" title="VLANS" href="vlans.html"/>
    <link href="../../../_static/mylayout.css" rel="stylesheet" type="text/css">


  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> debian & networking
          

          
          </a>

          
            
            
              <div class="version">
                201710
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../inhoud.html">Routing/Switching</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="inhoud.html">basics</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="connect2console.html">Connect to console</a></li>
<li class="toctree-l3"><a class="reference internal" href="routingConcepts.html">Routing Concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="staticRouting.html">Static Routes</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamicRouting.html">Dynamic Routing</a></li>
<li class="toctree-l3"><a class="reference internal" href="switchedNetworks.html">switched networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="switchConfiguration.html">Switch Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="vlans.html">VLANS</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">ACLs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#acl-operation">ACL operation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#acl-wildcard-masking">ACL Wildcard Masking</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wildcard-mask-abbreviations">Wildcard Mask Abbreviations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rules-for-applying-acls">Rules for applying ACLs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#acl-placement">ACL Placement</a></li>
<li class="toctree-l4"><a class="reference internal" href="#applying-standard-ipv4-acls-to-interface">Applying standard ipv4 ACLs to interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="#named-standard-acls">Named Standard ACLs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exercises">exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="#editing-numbered-acls">Editing Numbered ACLs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#adding-a-line-to-nacl">adding a line to NACL</a></li>
<li class="toctree-l4"><a class="reference internal" href="#verifying-standard-acl-interfaces">verifying standard ACL interfaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="#acl-vs-ip-acl">ACL VS IP ACL</a></li>
<li class="toctree-l4"><a class="reference internal" href="#clearing-acl-statistics">Clearing ACL Statistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#accesss-class-command">Accesss-class command</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-implicit-deny-any">The implicit Deny Any</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-order-of-aces-in-an-acl">The order of ACEs in an ACL</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sequencing-considerations-during-configuration">Sequencing considerations during configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#acl-and-routing-processes">ACL and Routing Processes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#troubleshooting-std-ipv4-acls">Troubleshooting StD IPv4 ACLs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exercices">Exercices</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ch7-qna">Ch7 QnA</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dhcp.html">DHCP</a></li>
<li class="toctree-l3"><a class="reference internal" href="nat.html">NAT</a></li>
<li class="toctree-l3"><a class="reference internal" href="lldpAndLicensing.html">Device Discovery Management &amp; Maintenance</a></li>
<li class="toctree-l3"><a class="reference internal" href="finals.html">routing n switching basics finals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sn/inhoud.html">scaling networks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../vim.html">VIM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../commands.html">BASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../git.html">GIT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripting.html">Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../storage/storage.html">Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rest.html">reStructuredText Primer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trading.html">Trading</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">debian & networking</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../inhoud.html">Routing/Switching</a> &raquo;</li>
        
          <li><a href="inhoud.html">basics</a> &raquo;</li>
        
      <li>ACLs</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/nw/rns/basics/acl.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="acls">
<h1>ACLs<a class="headerlink" href="#acls" title="Permalink to this headline">¶</a></h1>
<p>When configured, ACLs perform the following tasks:</p>
<blockquote>
<div><ul class="simple">
<li>Limit network traffic to increase network performance. For example, if corporate policy does not allow video traffic on the network, ACLs that block video traffic could be configured and applied. This would greatly reduce the network load and increase network performance.</li>
<li>Provide traffic flow control. ACLs can restrict the delivery of routing updates to ensure that the updates are from a known source.</li>
<li>Provide a basic level of security for network access. ACLs can allow one host to access a part of the network and prevent another host from accessing the same area. For example, access to the Human Resources network can be restricted to authorized users.</li>
<li>Filter traffic based on traffic type. For example, an ACL can permit email traffic, but block all Telnet traffic.</li>
<li>Screen hosts to permit or deny access to network services. ACLs can permit or deny a user to access file types, such as FTP or HTTP.</li>
</ul>
</div></blockquote>
<p>By default, a router does not have ACLs configured; therefore, by default a router does not filter traffic. Traffic that enters the router is routed solely based on information within the routing table. However, when an ACL is applied to an interface, the router performs the additional task of evaluating all network packets as they pass through the interface to determine if the packet can be forwarded.</p>
<p>In addition to either permitting or denying traffic, ACLs can be used for selecting types of traffic to be analyzed, forwarded, or processed in other ways. For example, ACLs can be used to classify traffic to enable priority processing.</p>
<p><strong>An ACL is a sequential list of permit or deny statements, known as access control entries (ACEs)</strong>. ACEs are also commonly called ACL statements. When network traffic passes through an interface configured with an ACL, the router compares the information within the packet against each ACE, in sequential order, to determine if the packet matches one of the ACEs. This process is called packet filtering.</p>
<p>Packet filtering controls access to a network by analyzing the incoming and outgoing packets and forwarding them or discarding them based on given criteria. Packet filtering can occur at Layer 3 or Layer 4.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Standard ACLs only filter at Layer 3. Extended ACLs filter at Layer 3 and Layer 4.</p>
</div>
<p>Note: Extended ACLs are beyond the scope of this course.</p>
<div class="section" id="acl-operation">
<h2>ACL operation<a class="headerlink" href="#acl-operation" title="Permalink to this headline">¶</a></h2>
<p>The source IPv4 address is the filtering criteria set in each ACE of a standard IPv4 ACL. A router configured with a standard IPv4 ACL <strong>extracts the source IPv4 address from the packet header</strong>. The router <em>starts at the top of the ACL and compares the address to each ACE sequentially. When a match is made, the router carries out the instruction, either permitting or denying the packet. After a match is made, the remaining ACEs in the ACL, if any</em> <strong>are not analyzed</strong>.</p>
<p>If the source IPv4 address does not match any ACEs in the ACL, the packet is discarded.The last statement of an ACL is always an implicit deny. This statement is automatically inserted at the end of each ACL even though it is not physically present. The implicit deny blocks all traffic. <strong>Because of this implicit deny, an ACL that does not have at least one permit statement will block all traffic</strong></p>
<p>ACLs define the set of rules that give added control for packets that enter inbound interfaces, packets that relay through the router, and packets that exit outbound interfaces of the router. ACLs do not act on packets that originate from the router itself.</p>
<p>ACLs can be configured to apply to inbound traffic and outbound traffic as shown in the figure.</p>
<img alt="../../../_images/inbound_outbound_acl.png" src="../../../_images/inbound_outbound_acl.png" />
<p><strong>Inbound ACLs</strong>
Incoming packets are processed before they are routed to the outbound interface. An inbound ACL is efficient because it saves the overhead of routing lookups if the packet is discarded. If the packet is permitted by the ACL, it is then processed for routing. Inbound ACLs are best used to filter packets when the network attached to an inbound interface is the only source of packets that need to be examined.
<strong>Outbound ACLs</strong>
Incoming packets are routed to the outbound interface, and then they are processed through the outbound ACL. Outbound ACLs are best used when the same filter will be applied to packets coming from multiple inbound interfaces before exiting the same outbound interface.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="c1"># show access- lists</span>
<span class="n">Standard</span> <span class="n">IP</span> <span class="n">access</span> <span class="nb">list</span> <span class="mi">11</span>
    <span class="mi">10</span> <span class="n">deny</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">10.0</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.255</span>
    <span class="mi">20</span> <span class="n">permit</span> <span class="nb">any</span>
</pre></div>
</div>
<p>The first line of the ACL prevent s any packets originating in the 192.168.10.0/24 network, which includes Internet Control Message Protocol (ICMP) echoe s (ping requests). The second line of the ACL allows all other ip traffic from any source to transverse the router.</p>
<p>Remove access list 11 from the configuration</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">no</span> <span class="pre">access-list</span></code> command deletes all ACLs configured on the router . The <code class="docutils literal notranslate"><span class="pre">no</span> <span class="pre">access-list</span> <span class="pre">#</span></code> command removes only a specific ACL.</p>
</div>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># int se0/0/0</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># no ip access-group 11 out</span>

<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># no access-list 11</span>
</pre></div>
</div>
</div>
<div class="section" id="acl-wildcard-masking">
<h2>ACL Wildcard Masking<a class="headerlink" href="#acl-wildcard-masking" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">0 means to match ip address bit - 1 means ignore address bit and zerofy</p>
</div>
<ol class="arabic simple">
<li>write out ip in binary</li>
<li>write WM in binary</li>
<li>0 match the address bit, 1 ignore address bit and put on 0</li>
</ol>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="25%" />
<col width="54%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">&#160;</th>
<th class="head">Decimal Address</th>
<th class="head">Binary Address</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>IP to process</td>
<td>192.168.10.0</td>
<td>11000000.10101000.00001010.00000000</td>
</tr>
<tr class="row-odd"><td>Wildcard Mask</td>
<td>0.0.255.255</td>
<td>00000000.00000000.11111111.11111111</td>
</tr>
<tr class="row-even"><td>Resulting IP</td>
<td>192.168.0.0</td>
<td>11000000.10101000.00000000.00000000</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Unlike IPv4 ACLs, IPv6 ACLs do not use wildcard masks. Instead, the prefix-length is used to indicate how much of an IPv6 source or destination address should be matched</p>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="24%" />
<col width="54%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">&#160;</th>
<th class="head">Decimal</th>
<th class="head">Binary</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>IP Address</td>
<td>192.168.16.0</td>
<td>11000000.10101000.00010000.00000000</td>
</tr>
<tr class="row-odd"><td>Wildcard Mask</td>
<td>0.0.15.255</td>
<td>00000000.00000000.00001111.11111111</td>
</tr>
<tr class="row-even"><td>Result Range</td>
<td>192.168.16.0</td>
<td>11000000.10101000.00010000.00000000</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>to</td>
<td>to</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>192.168.31.255</td>
<td>11000000.10101000.00011111.11111111</td>
</tr>
</tbody>
</table>
<p>The first two octets and first four bits of the third octet must match exactly.
The last four bits in the third octet and the last octet can be any valid number.
This results in a mask that checks for the range of networks 192.168.16.0 to 192.168.31.0.</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="20%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">&#160;</th>
<th class="head">Decimal</th>
<th class="head">Binary</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>IP Address</td>
<td>192.168.1.0</td>
<td>11000000.10101000.00000001.00000000</td>
</tr>
<tr class="row-odd"><td>Wildcard Mask</td>
<td>0.0.254.255</td>
<td>00000000.00000000.11111110.11111111</td>
</tr>
<tr class="row-even"><td>Result</td>
<td>192.168.1.0</td>
<td>11000000.10101000.00000001.00000000</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>all odd numbered subnets</td>
</tr>
</tbody>
</table>
<p>a wildcard mask that matches the first two octets, and the least significant bit in the third octet.
The last octet and the first seven bits in the third octet can be any valid number.
The result is a mask that would permit or deny all hosts from odd subnets from the 192.168.0.0 major network.</p>
<p>calculate WM for 192.168.3.32/28 Permit nw access for the 14 users in the nw</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">&#160;</th>
<th class="head">255.255.255.255</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>(-)</td>
<td>255.255.255.240</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>0.0.0.15</td>
</tr>
</tbody>
</table>
<p>match only networks 192.168.10.0 and 192.168.11.0</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">&#160;</th>
<th class="head">255.255.255.255</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>(-)</td>
<td>255.255.254.0</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>0.0.1.255</td>
</tr>
</tbody>
</table>
<p>You could accomplish the same result with statements like the two shown below:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 10 permit 192.168.10.0</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 10 permit 192.168.11.0</span>

<span class="n">It</span> <span class="ow">is</span> <span class="n">far</span> <span class="n">more</span> <span class="n">efficient</span> <span class="n">to</span> <span class="n">configure</span> <span class="n">the</span> <span class="n">wildcard</span> <span class="n">mask</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">following</span> <span class="n">way</span>
      <span class="o">-------------------------------------------------</span>

<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 10 permit 192.168.10.0 0.0.1.255</span>
</pre></div>
</div>
</div>
<div class="section" id="wildcard-mask-abbreviations">
<h2>Wildcard Mask Abbreviations<a class="headerlink" href="#wildcard-mask-abbreviations" title="Permalink to this headline">¶</a></h2>
<img alt="../../../_images/wildcard_abbreviations.png" src="../../../_images/wildcard_abbreviations.png" />
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span>R1(config)# access-list 1 permit 0.0.0.0 255.255.255.255
!OR
R1(config)# access-list 1 permit any

R1(config)# access-list 1 permit 192.168.10.10 0.0.0.0
R1(config)# access-list 1 permit host 192.168.10.10
</pre></div>
</div>
<img alt="../../../_images/permit_or_deny.png" src="../../../_images/permit_or_deny.png" />
</div>
<div class="section" id="rules-for-applying-acls">
<h2>Rules for applying ACLs<a class="headerlink" href="#rules-for-applying-acls" title="Permalink to this headline">¶</a></h2>
<img alt="../../../_images/acl_rules1.png" src="../../../_images/acl_rules1.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If we needed ACLs for both protocols, on both interfaces and in both directions, this would require eight separate ACLs. Each interface would have four ACLs; two ACLs for IPv4 and two ACLs for IPv6. For each protocol, one ACL is for inbound traffic and one for outbound traffic.</p>
</div>
<ul class="simple">
<li>Use ACLs in firewall routers positioned between your internal network and an external network such as the Internet.</li>
<li>Use ACLs on a router positioned between two parts of your network to control traffic entering or exiting a specific part of your internal network.</li>
<li>Configure ACLs on border routers, that is, routers situated at the edges of your networks. This provides a very basic buffer from the outside network, or between a less controlled area of your own network and a more sensitive area of your network.</li>
<li><strong>Configure ACLs for each network protocol configured on the border router</strong> interfaces.</li>
</ul>
<dl class="docutils">
<dt>One ACL per protocol:</dt>
<dd>To controll traffic flow on an interface an ACL must be defined for EACH Protocol enabled on the interface</dd>
<dt>One ACL per direction:</dt>
<dd>ACLs control traffic in one direction at a time on an interface. Two seperate ACLs must be created to control inbound &amp; outbound traffic</dd>
<dt>One ACL per interface:</dt>
<dd>ACLs control traffic for an interface, eg. GigabitEthernet 0/0</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Test your ACLs on a development network before implementing them.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Inbound ACLs, packets are processed before routing, Outbound ACLs after routing has performed</p>
</div>
</div>
<div class="section" id="acl-placement">
<h2>ACL Placement<a class="headerlink" href="#acl-placement" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Locate extended ACLs as close as possible to the source of the traffic to be filtered. This way, undesirable traffic is denied close to the source network without crossing the network infrastructure.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Because standard ACLs do not specify destination addresses, place them as close to the destination as possible. Placing a standard ACL at the source of the traffic will effectively prevent that traffic from reaching any other networks through the interface where the ACL is applied.</p>
</div>
<p><strong>extended ACLs are placed as close as possible to the source and standard ACLs are placed as close as possible to the destination</strong></p>
<ul class="simple">
<li>Placement of the ACL and therefore, the type of ACL used may also depend on</li>
</ul>
<dl class="docutils">
<dt>The extent of the network administrator’s control:</dt>
<dd>Placement of the ACL can depend on whether or not the network administrator has control of both the source and destination networks.</dd>
<dt>Bandwidth of the networks involved:</dt>
<dd>Filtering unwanted traffic at the source prevents transmission of the traffic before it consumes bandwidth on the path to a destination. This is especially important in low bandwidth networks.</dd>
<dt>Ease of configuration:</dt>
<dd>If a network administrator wants to deny traffic coming from several networks, one option is to use a single standard ACL on the router closest to the destination. The disadvantage is that traffic from these networks will use bandwidth unnecessarily. An extended ACL could be used on each router where the traffic originated. This will save bandwidth by filtering the traffic at the source but requires creating extended ACLs on multiple routers.</dd>
</dl>
<div class="section" id="standard-acl-placement">
<h3>Standard ACL placement<a class="headerlink" href="#standard-acl-placement" title="Permalink to this headline">¶</a></h3>
<img alt="../../../_images/standard_acl_placement.png" src="../../../_images/standard_acl_placement.png" />
<dl class="docutils">
<dt>R3 S0/0/1 interface:</dt>
<dd>Applying a standard ACL to prevent traffic from 192.168.10.0/24 from entering the S0/0/1 interface will prevent this traffic from reaching 192.168.30.0/24 and all other networks reachable by R3. This includes the 192.168.31.0/24 network. Because the intent of the ACL is to filter traffic destined only for 192.168.30.0/24, a standard ACL should not be applied to this interface.</dd>
<dt>R3 G0/0 interface:</dt>
<dd>Applying the standard ACL to traffic exiting the G0/0 interface will filter packets from 192.168.10.0/24 to 192.168.30.0/24. This will not affect other networks reachable by R3. Packets from 192.168.10.0/24 will still be able to reach 192.168.31.0/24.</dd>
</dl>
<p>Access-list: defines a standard ACL with a number in the range of 1 through 99</p>
<p>Router(config)# <strong>access-list</strong> 10 {<strong>deny | permit | remark</strong>} source [source-wildcard] [<strong>log</strong>]</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 10 permit 192.168.10.0 0.0.0.255</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># exit</span>
<span class="n">R1</span><span class="c1"># show access-lists</span>
<span class="n">Standard</span> <span class="n">IP</span> <span class="n">access</span> <span class="nb">list</span> <span class="mi">10</span>
    <span class="mi">10</span> <span class="n">permit</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">wildcard</span> <span class="n">bits</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.255</span>
<span class="n">R1</span><span class="c1"># conf t</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># no access-list 10</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># exit</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># show access-lists</span>
<span class="n">R1</span><span class="c1">#</span>

<span class="n">use</span> <span class="n">the</span> <span class="n">ability</span> <span class="n">to</span> <span class="n">use</span> <span class="n">remark</span>
<span class="o">-----------------------------</span>

<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 10 remark Permit hosts from the 192.168.10.0 LAN</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 10 permit 192.168.10.0 0.0.0.255</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># exit</span>
<span class="n">R1</span><span class="c1"># show running-config | include access-list 10</span>
<span class="n">access</span><span class="o">-</span><span class="nb">list</span> <span class="mi">10</span> <span class="n">remark</span> <span class="n">Permit</span> <span class="n">hosts</span> <span class="kn">from</span> <span class="nn">the</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">10.0</span> <span class="n">LAN</span>
<span class="n">access</span><span class="o">-</span><span class="nb">list</span> <span class="mi">10</span> <span class="n">permit</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">10.0</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.255</span>
<span class="n">R1</span><span class="c1">#</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="applying-standard-ipv4-acls-to-interface">
<h2>Applying standard ipv4 ACLs to interface<a class="headerlink" href="#applying-standard-ipv4-acls-to-interface" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Router(config-if)# <strong>ip access-group</strong> { access-list-number | access-list-name } { <strong>in | out</strong> }</li>
</ul>
<dl class="docutils">
<dt>to remove ACL from interface:</dt>
<dd><code class="docutils literal notranslate"><span class="pre">no</span> <span class="pre">ip</span> <span class="pre">access-group</span> <span class="pre">10</span></code> and then <code class="docutils literal notranslate"><span class="pre">no</span> <span class="pre">access-list</span> <span class="pre">10</span></code></dd>
</dl>
<ol class="arabic simple">
<li>create the entry:
R1(config)# access-<strong>list</strong> 1 permit 192.168.10.0 0.0.0.255</li>
<li>select the interface:
R1(config)# interface serial 0/0/0</li>
<li>activate on interface:
R1(config-if)# ip access-<strong>group</strong> 1 <strong>out</strong></li>
</ol>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># no access-list 1</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 1 deny host 192.168.10.10</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 1 permit 192.168.10.0 0.0.0.255</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># interface **S0/0/0**</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ip access-group 1 **out**</span>
</pre></div>
</div>
<p>This is not very efficient, better to apply it to the inbound interface so the router doesn’t have to examine packets</p>
<img alt="../../../_images/efficiency_standard_acl_deny_host.png" src="../../../_images/efficiency_standard_acl_deny_host.png" />
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># no access-list 1</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 1 deny host 192.168.10.10</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 1 permit any</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># interface **g0/0**</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ip access-group 1 **in**</span>
</pre></div>
</div>
</div>
<div class="section" id="named-standard-acls">
<h2>Named Standard ACLs<a class="headerlink" href="#named-standard-acls" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Router(config)# <strong>ip</strong> access-list [<strong>standard | extended</strong>] name</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">name must be unique and cannot begin with number</p>
</div>
</li>
<li><p class="first">Router(config-std-nacl)# [<strong>permit | deny | remark</strong>] {source [source-wildcard]} [<strong>log</strong>]</p>
</li>
<li><p class="first">Router(config-if)# <strong>ip access-group</strong> name [<strong>in | out</strong>]</p>
<ul class="simple">
<li>Activates the named IP ACL on an interface</li>
</ul>
</li>
</ol>
<img alt="../../../_images/named_acl_example.png" src="../../../_images/named_acl_example.png" />
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># ip access-list standard NO_ACCESS</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">std</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1"># deny host 192.168.11.10</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">std</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1"># permit any</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">std</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1"># exit</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># interface g0/0</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ip access-group NO_ACCESS out</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">mnemonics -&gt; X to the source, X’ersource :) standard to destination = STD</p>
</div>
</div>
<div class="section" id="exercises">
<h2>exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<div class="section" id="pt-configuring-numbered-standard-ipv4-acls">
<h3>PT Configuring Numbered Standard IPv4 ACLs<a class="headerlink" href="#pt-configuring-numbered-standard-ipv4-acls" title="Permalink to this headline">¶</a></h3>
<p>Addressing Table</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="15%" />
<col width="22%" />
<col width="24%" />
<col width="24%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Device</th>
<th class="head">Interface</th>
<th class="head">IP Address</th>
<th class="head">Subnet Mask</th>
<th class="head">Default Gateway</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>R1</td>
<td>G0/0</td>
<td>192.168.10.1</td>
<td>255.255.255.0</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>G0/1</td>
<td>192.168.11.1</td>
<td>255.255.255.0</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>S0/0/0</td>
<td>10.1.1.1</td>
<td>255.255.255.252</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>S0/0/1</td>
<td>10.3.3.1</td>
<td>255.255.255.252</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>R2</td>
<td>G0/0</td>
<td>192.168.20.1</td>
<td>255.255.255.0</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>S0/0/0</td>
<td>10.1.1.2</td>
<td>255.255.255.252</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>S0/0/1</td>
<td>10.2.2.1</td>
<td>255.255.255.252</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>R3</td>
<td>G0/0</td>
<td>192.168.30.1</td>
<td>255.255.255.0</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>S0/0/0</td>
<td>10.3.3.2</td>
<td>255.255.255.252</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>S0/0/1</td>
<td>10.2.2.2</td>
<td>255.255.255.252</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>PC1</td>
<td>NIC</td>
<td>192.168.10.10</td>
<td>255.255.255.0</td>
<td>192.168.10.1</td>
</tr>
<tr class="row-odd"><td>PC2</td>
<td>NIC</td>
<td>192.168.11.10</td>
<td>255.255.255.0</td>
<td>192.168.11.1</td>
</tr>
<tr class="row-even"><td>PC3</td>
<td>NIC</td>
<td>192.168.30.10</td>
<td>255.255.255.0</td>
<td>192.168.30.1</td>
</tr>
<tr class="row-odd"><td>WebServer</td>
<td>NIC</td>
<td>192.168.20.254</td>
<td>255.255.255.0</td>
<td>192.168.20.1</td>
</tr>
</tbody>
</table>
<img alt="../../../_images/ex1_std_acls.png" src="../../../_images/ex1_std_acls.png" />
<p>Objectives
* Part 1: Plan an ACL Implementation
* Part 2: Configure, Apply, and verify a STanDard ACL</p>
<p>Scenario
defining filtering criteria, configuring standard ACLs, applying ACLs to router interfaces, and verifying and testing the ACL implementation. The routers are already configured, including IP addresses and Enhanced Interior Gateway Routing Protocol (EIGRP) routing.</p>
<ol class="arabic">
<li><p class="first">Verify full connectivity before applying ACLs</p>
</li>
<li><p class="first">apply following policies on R2</p>
<ol class="loweralpha simple">
<li>The 192.168.11.0/24 network is not allowed access to the WebServer on the 192.168.20.0/24 network.</li>
<li>All other access is permitted</li>
</ol>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R2</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 1 deny 192.168.11.0 0.0.0.255</span>
<span class="n">R2</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 1 permit any</span>
<span class="n">R2</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># interface G0/0</span>
<span class="n">R2</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ip access-group 1 out</span>
</pre></div>
</div>
</li>
<li><p class="first">apply following policies on R3</p>
<ol class="loweralpha simple">
<li>The 192.168.10.0/24 network is not allowed to communicate with the 192.168.30.0/24 network</li>
<li>All other access is permitted</li>
</ol>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R3</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#do show access-list</span>
<span class="n">R3</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#access-list 1 deny 192.168.10.0 0.0.0.255</span>
<span class="n">R3</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#access-list 1 permit any</span>
<span class="n">R3</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#interface g0/0</span>
<span class="n">R3</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1">#ip access-group 1 out</span>
</pre></div>
</div>
</li>
<li><p class="first">Use the <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">access-list</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">run</span></code> or <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">ip</span> <span class="pre">interface</span> <span class="pre">gigabitethernet</span> <span class="pre">0/0</span></code> command to verify ACL placements</p>
</li>
<li><p class="first">time to ping around to see what succeeds and fails</p>
<ol class="arabic simple">
<li>A ping from 192.168.10.10 to 192.168.11.10 succeeds.</li>
<li>A ping from 192.168.10.10 to 192.168.20.254 succeeds.</li>
<li>A ping from 192.168.11.10 to 192.168.20.254 fails.</li>
<li>A ping from 192.168.10.10 to 192.168.30.10 fails.</li>
<li>A ping from 192.168.11.10 to 192.168.30.10 succeeds.</li>
<li>A ping from 192.168.30.10 to 192.168.20.254 succeeds.</li>
</ol>
</li>
</ol>
</div>
<div class="section" id="pt-configuring-named-standard-ipv4-acls">
<h3>PT Configuring Named Standard IPv4 ACLs<a class="headerlink" href="#pt-configuring-named-standard-ipv4-acls" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="15%" />
<col width="23%" />
<col width="21%" />
<col width="23%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Device</th>
<th class="head">Interface</th>
<th class="head">IP Address</th>
<th class="head">Subnet Mask</th>
<th class="head">Default Gateway</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>R1</td>
<td>F0/0</td>
<td>192.168.10.1</td>
<td>255.255.255.0</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>R1</td>
<td>F0/1</td>
<td>192.168.20.1</td>
<td>255.255.255.0</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>R1</td>
<td>E0/0/0</td>
<td>192.168.100.1</td>
<td>255.255.255.0</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>R1</td>
<td>E0/1/0</td>
<td>192.168.200.1</td>
<td>255.255.255.0</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>File Server</td>
<td>NIC</td>
<td>192.168.200.100</td>
<td>255.255.255.0</td>
<td>192.168.200.1</td>
</tr>
<tr class="row-odd"><td>WebServer</td>
<td>NIC</td>
<td>192.168.100.100</td>
<td>255.255.255.0</td>
<td>192.168.100.1</td>
</tr>
<tr class="row-even"><td>PC0</td>
<td>NIC</td>
<td>192.168.20.3</td>
<td>255.255.255.0</td>
<td>192.168.20.1</td>
</tr>
<tr class="row-odd"><td>PC1</td>
<td>NIC</td>
<td>192.168.20.4</td>
<td>255.255.255.0</td>
<td>192.168.20.1</td>
</tr>
<tr class="row-even"><td>PC2</td>
<td>NIC</td>
<td>192.168.10.3</td>
<td>255.255.255.0</td>
<td>192.168.10.1</td>
</tr>
</tbody>
</table>
<p>solution:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="c1">#show access-list</span>
<span class="n">R1</span><span class="c1">#show ip access-lists</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#ip access-list standard File_Server_Restrictions</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">std</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1">#permit host 192.168.20.4</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">std</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1">#deny any</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">std</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1">#?</span>
  <span class="o">&lt;</span><span class="mi">1</span><span class="o">-</span><span class="mi">2147483647</span><span class="o">&gt;</span>  <span class="n">Sequence</span> <span class="n">Number</span>
  <span class="n">default</span>         <span class="n">Set</span> <span class="n">a</span> <span class="n">command</span> <span class="n">to</span> <span class="n">its</span> <span class="n">defaults</span>
  <span class="n">deny</span>            <span class="n">Specify</span> <span class="n">packets</span> <span class="n">to</span> <span class="n">reject</span>
  <span class="n">exit</span>            <span class="n">Exit</span> <span class="kn">from</span> <span class="nn">access</span><span class="o">-</span><span class="nb">list</span> <span class="n">configuration</span> <span class="n">mode</span>
  <span class="n">no</span>              <span class="n">Negate</span> <span class="n">a</span> <span class="n">command</span> <span class="ow">or</span> <span class="nb">set</span> <span class="n">its</span> <span class="n">defaults</span>
  <span class="n">permit</span>          <span class="n">Specify</span> <span class="n">packets</span> <span class="n">to</span> <span class="n">forward</span>
  <span class="n">remark</span>          <span class="n">Access</span> <span class="nb">list</span> <span class="n">entry</span> <span class="n">comment</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">std</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1">#do show access-list</span>
<span class="n">Standard</span> <span class="n">IP</span> <span class="n">access</span> <span class="nb">list</span> <span class="n">File_Server_Restrictions</span>
    <span class="mi">10</span> <span class="n">permit</span> <span class="n">host</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">20.4</span>
    <span class="mi">20</span> <span class="n">deny</span> <span class="nb">any</span>

<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">std</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1">#do show ip access-list</span>
<span class="n">Standard</span> <span class="n">IP</span> <span class="n">access</span> <span class="nb">list</span> <span class="n">File_Server_Restrictions</span>
    <span class="mi">10</span> <span class="n">permit</span> <span class="n">host</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">20.4</span>
    <span class="mi">20</span> <span class="n">deny</span> <span class="nb">any</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">&#64; this point no difference is noticable between show or show ip access-list</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">the answer: There may be more than just IPv4 access-lists on the router. If so, the command show access-lists would show them all, including IPX or other types that may exist. On that same router, the command show ip access-lists would only show the IP access-lists, and not the IPX or other types.</p>
</div>
</div>
<div class="section" id="lab-config-mod-std-ipv4-acls">
<h3>Lab Config/Mod Std IPv4 ACLs<a class="headerlink" href="#lab-config-mod-std-ipv4-acls" title="Permalink to this headline">¶</a></h3>
<img alt="../../../_images/Lab_7.2.2.6.png" src="../../../_images/Lab_7.2.2.6.png" />
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="19%" />
<col width="23%" />
<col width="23%" />
<col width="23%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Device</th>
<th class="head">Interface</th>
<th class="head">IP Address</th>
<th class="head">Subnet Mask</th>
<th class="head">Default Gateway</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>R1</td>
<td>G0/1</td>
<td>192.168.10.1</td>
<td>255.255.255.0</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>Lo0</td>
<td>192.168.20.1</td>
<td>255.255.255.0</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>S0/0/0 (DCE)</td>
<td>10.1.1.1</td>
<td>255.255.255.252</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>ISP</td>
<td>S0/0/0</td>
<td>10.1.1.2</td>
<td>255.255.255.252</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>S0/0/1 (DCE)</td>
<td>10.2.2.2</td>
<td>255.255.255.252</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>Lo0</td>
<td>209.165.200.225</td>
<td>255.255.255.224</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>R3</td>
<td>G0/1</td>
<td>192.168.30.1</td>
<td>255.255.255.0</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>Lo0</td>
<td>192.168.40.1</td>
<td>255.255.255.0</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>S0/0/1</td>
<td>10.2.2.1</td>
<td>255.255.255.252</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>S1</td>
<td>VLAN 1</td>
<td>192.168.10.11</td>
<td>255.255.255.0</td>
<td>192.168.10.1</td>
</tr>
<tr class="row-even"><td>S3</td>
<td>VLAN 1</td>
<td>192.168.30.11</td>
<td>255.255.255.0</td>
<td>192.168.30.1</td>
</tr>
<tr class="row-odd"><td>PC-A</td>
<td>NIC</td>
<td>192.168.10.3</td>
<td>255.255.255.0</td>
<td>192.168.10.1</td>
</tr>
<tr class="row-even"><td>PC-C</td>
<td>NIC</td>
<td>192.168.30.3</td>
<td>255.255.255.0</td>
<td>192.168.30.1</td>
</tr>
</tbody>
</table>
<ol class="arabic simple">
<li>Configure IP addresses on PC-A and PC-C</li>
<li>configure basic settings for routers</li>
</ol>
<blockquote>
<div><ul>
<li><p class="first">Console into router and enter global config</p>
</li>
<li><p class="first">copy following and paste it to the running config</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">no</span> <span class="n">ip</span> <span class="n">domain</span><span class="o">-</span><span class="n">lookup</span>
<span class="n">hostname</span> <span class="n">R1</span>
<span class="n">service</span> <span class="n">password</span><span class="o">-</span><span class="n">encryption</span>
<span class="n">enable</span> <span class="n">secret</span> <span class="k">class</span>
<span class="nc">banner</span> <span class="n">motd</span> <span class="c1">#</span>
<span class="n">Unauthorized</span> <span class="n">access</span> <span class="ow">is</span> <span class="n">strictly</span> <span class="n">prohibited</span><span class="o">.</span> <span class="c1">#</span>
<span class="n">Line</span> <span class="n">con</span> <span class="mi">0</span>
<span class="n">password</span> <span class="n">cisco</span>
<span class="n">login</span>
<span class="n">logging</span> <span class="n">synchronous</span>
<span class="n">line</span> <span class="n">vty</span> <span class="mi">0</span> <span class="mi">4</span>
<span class="n">password</span> <span class="n">cisco</span>
<span class="n">login</span>
</pre></div>
</div>
</li>
<li><p class="first">Configure the device name as shown in the topology.</p>
</li>
<li><p class="first">Create loopback interfaces on each router as shown in the Addressing Table.</p>
</li>
<li><p class="first">Configure interface IP addresses as shown in the Topology and Addressing Table.</p>
</li>
<li><p class="first">Assign a clock rate of <strong>128000</strong> to the DCE serial interfaces.</p>
</li>
<li><p class="first">Enable Telnet access.</p>
</li>
<li><p class="first">Copy the running configuration to the startup configuration.</p>
</li>
</ul>
</div></blockquote>
<ol class="arabic">
<li><p class="first">(optional)Configure basics on the switches</p>
<ul>
<li><p class="first">Console into switch and enter global config mode</p>
</li>
<li><p class="first">Copy the following and paste it into the running config</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">no</span> <span class="n">ip</span> <span class="n">domain</span><span class="o">-</span><span class="n">lookup</span>
<span class="n">service</span> <span class="n">password</span><span class="o">-</span><span class="n">encryption</span>
<span class="n">enable</span> <span class="n">secret</span> <span class="k">class</span>
<span class="nc">banner</span> <span class="n">motd</span> <span class="c1">#</span>
<span class="n">Unauthorized</span> <span class="n">access</span> <span class="ow">is</span> <span class="n">strictly</span> <span class="n">prohibited</span><span class="o">.</span> <span class="c1">#</span>
<span class="n">Line</span> <span class="n">con</span> <span class="mi">0</span>
<span class="n">password</span> <span class="n">cisco</span>
<span class="n">login</span>
<span class="n">logging</span> <span class="n">synchronous</span>
<span class="n">line</span> <span class="n">vty</span> <span class="mi">0</span> <span class="mi">15</span>
<span class="n">password</span> <span class="n">cisco</span>
<span class="n">login</span>
<span class="n">exit</span>
</pre></div>
</div>
</li>
<li><p class="first">Configure the device name as shown in the topology.</p>
</li>
<li><p class="first">Configure the management interface IP address as shown in the Topology and Addressing Table.</p>
</li>
<li><p class="first">Configure a default gateway.</p>
</li>
<li><p class="first">Enable Telnet access.</p>
</li>
<li><p class="first">Copy the running configuration to the startup configuration.</p>
</li>
</ul>
</li>
<li><p class="first">Configure RIP routing on R1, ISP and R3</p>
<ul>
<li><p class="first">Configure RIP version 2 and advertise all networks on R1, ISP, and R3. The OSPF configuration for R1 and ISP is included for reference.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># router rip</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1"># version 2</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1"># network 192.168.10.0</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1"># network 192.168.20.0</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1"># network 10.1.1.0</span>
<span class="n">ISP</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># router rip</span>
<span class="n">ISP</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1"># version 2</span>
<span class="n">ISP</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1"># network 209.165.200.224</span>
<span class="n">ISP</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1"># network 10.1.1.0</span>
<span class="n">ISP</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1"># network 10.2.2.0</span>
</pre></div>
</div>
</li>
<li><p class="first">After configuring Rip on R1, ISP, and R3, verify that all routers have complete routing tables, listing all networks. Troubleshoot if this is not the case.</p>
</li>
</ul>
</li>
<li><p class="first">Verify connectivity between devices.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is very important to test whether connectivity is working before you configure and apply access lists!</p>
</div>
<ul class="simple">
<li>From PC-A, ping PC-C and the loopback interface on R3. Were your pings successful?</li>
<li>From R1, ping PC-C and the loopback interface on R3. Were your pings successful?</li>
<li>From PC-C, ping PC-A and the loopback interface on R1. Were your pings successful?</li>
<li>From R3, ping PC-A and the loopback interface on R1. Were your pings successful?</li>
</ul>
</li>
<li><p class="first">Configure numbered standard ACL</p>
<ul>
<li><p class="first">Standard ACLs filter traffic based on the source IP address only. A typical best practice for standard ACLs is to configure and apply it as close to the destination as possible. For the first access list, create a standard numbered ACL that allows traffic from all hosts on the 192.168.10.0/24 network and all hosts on the 192.168.20.0/24 network to access all hosts on the 192.168.30.0/24 network.</p>
</li>
<li><p class="first">The security policy also states that a deny any access control entry (ACE), also referred to as an ACL statement, should be present at the end of all ACLs. What wildcard mask would you use to allow all hosts on the 192.168.10.0/24 network to access the 192.168.30.0/24 network?</p>
</li>
<li><p class="first">Following Cisco’s recommended best practices, on which router would you place this ACL? On which interface would you place this ACL? In what direction would you apply it?</p>
</li>
<li><p class="first">Configure the ACL on R3. Use 1 for the access list number.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R3</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 1 remark Allow R1 LANs Access</span>
<span class="n">R3</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 1 permit 192.168.10.0 0.0.0.255</span>
<span class="n">R3</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 1 permit 192.168.20.0 0.0.0.255</span>
<span class="n">R3</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 1 deny any</span>
</pre></div>
</div>
</li>
<li><p class="first">Apply the ACL to the appropriate interface in the proper direction.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R3</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># interface g0/1</span>
<span class="n">R3</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ip access-group 1 out</span>
</pre></div>
</div>
</li>
<li><p class="first">Verify a numbered ACL.
The use of varios show commands can aid you in verifying both the syntax and placement of your ACLs in your router.
To see access list 1 in its entirety with all ACEs, which command would you use?</p>
</li>
</ul>
</li>
<li><p class="first">On R3, issue the <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">access-lists</span> <span class="pre">1</span></code> command.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R3</span><span class="c1"># show access-list 1</span>
<span class="n">Standard</span> <span class="n">IP</span> <span class="n">access</span> <span class="nb">list</span> <span class="mi">1</span>
    <span class="mi">10</span> <span class="n">permit</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">wildcard</span> <span class="n">bits</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.255</span>
    <span class="mi">20</span> <span class="n">permit</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">wildcard</span> <span class="n">bits</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.255</span>
    <span class="mi">30</span> <span class="n">deny</span>   <span class="nb">any</span>
</pre></div>
</div>
</li>
<li><p class="first">On R3, issue the <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">ip</span> <span class="pre">interface</span> <span class="pre">g0/1</span></code> command.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R3</span><span class="c1"># show ip interface g0/1</span>
<span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mi">1</span> <span class="ow">is</span> <span class="n">up</span><span class="p">,</span> <span class="n">line</span> <span class="n">protocol</span> <span class="ow">is</span> <span class="n">up</span>
  <span class="n">Internet</span> <span class="n">address</span> <span class="ow">is</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">30.1</span><span class="o">/</span><span class="mi">24</span>
  <span class="n">Broadcast</span> <span class="n">address</span> <span class="ow">is</span> <span class="mf">255.255</span><span class="o">.</span><span class="mf">255.255</span>
  <span class="n">Address</span> <span class="n">determined</span> <span class="n">by</span> <span class="n">non</span><span class="o">-</span><span class="n">volatile</span> <span class="n">memory</span>
  <span class="n">MTU</span> <span class="ow">is</span> <span class="mi">1500</span> <span class="nb">bytes</span>
  <span class="n">Helper</span> <span class="n">address</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">set</span>
  <span class="n">Directed</span> <span class="n">broadcast</span> <span class="n">forwarding</span> <span class="ow">is</span> <span class="n">disabled</span>
  <span class="n">Multicast</span> <span class="n">reserved</span> <span class="n">groups</span> <span class="n">joined</span><span class="p">:</span> <span class="mf">224.0</span><span class="o">.</span><span class="mf">0.10</span>
  <span class="n">Outgoing</span> <span class="n">access</span> <span class="nb">list</span> <span class="ow">is</span> <span class="mi">1</span>
  <span class="n">Inbound</span> <span class="n">access</span> <span class="nb">list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">set</span>
  <span class="n">Output</span> <span class="n">omitted</span>
</pre></div>
</div>
</li>
<li><p class="first">Test the ACL to see if it allows traffic from the 192.168.10.0/24 network access to the 192.168.30.0/24 network. From the PC-A command prompt, ping the PC-C IP address. Were the pings successful?</p>
</li>
<li><p class="first">Test the ACL to see if it allows traffic from the 192.168.20.0/24 network access to the 192.168.30.0/24 network. You must do an extended ping and use the loopback 0 address on R1 as your source. Ping PC-C’s IP address. Were the pings successful?</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span>R1#
ping
Protocol [ip]:
Target IP address:
192.168.30.3
Repeat count [5]:
Datagram size [100]:
Timeout in seconds [2]:
Extended commands [n]:
y
Source address or interface:
192.168.20.1
Type of service [0]:
Set DF bit in IP header? [no]:
Validate reply data? [no]:
Data pattern [0xABCD]:
Loose, Strict, Record, Timestamp, Verbose[none]:
Sweep range of sizes [n]:
Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 192.168.30.3, timeout is 2 seconds:
Packet sent with a source address of 192.168.20.1
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 28/29/32 ms
</pre></div>
</div>
<ul class="simple">
<li>From the R1 prompt, ping PC-C’s IP address again.
<code class="docutils literal notranslate"><span class="pre">R1#</span> <span class="pre">ping</span> <span class="pre">192.168.30.3</span></code> Was the ping successful? Why or why not?</li>
</ul>
</li>
<li><p class="first">Configure a named standard ACL. Create a named standard ACL that conforms to the following policy: allow traffic from all hosts on the 192.168.40.0/24 network access to all hosts on the 192.168.10.0/24 network. Also, only allow host PC-C access to the 192.168.10.0/24 network. The name of this access list should be called BRANCH-OFFICE-POLICY.
Following Cisco’s recommended best practices, on which router would you place this ACL? On which interface would you place this ACL? In what direction would you apply it?</p>
<ul>
<li><p class="first">Create the standard named ACL BRANCH-OFFICE-POLICY on R1.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># ip access-list standard BRANCH-OFFICE-POLICY</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">std</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1"># permit host 192.168.30.3</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">std</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1"># permit 192.168.40.0 0.0.0.255</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">std</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1"># end</span>
<span class="n">R1</span><span class="c1">#</span>
<span class="n">Feb</span> <span class="mi">15</span> <span class="mi">15</span><span class="p">:</span><span class="mi">56</span><span class="p">:</span><span class="mf">55.707</span><span class="p">:</span> <span class="o">%</span><span class="n">SYS</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="n">CONFIG_I</span><span class="p">:</span> <span class="n">Configured</span> <span class="kn">from</span> <span class="nn">console</span> <span class="n">by</span> <span class="n">console</span>
</pre></div>
</div>
<p>Looking at the first permit ACE in the access list, what is another way to write this?</p>
</li>
<li><p class="first">Apply the ACL to the appropriate interface in the proper direction.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="c1"># config t</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># interface g0/1</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ip access-group BRANCH-OFFICE-POLICY out</span>
</pre></div>
</div>
</li>
<li><p class="first">Verify a named ACL.</p>
<ol class="arabic">
<li><p class="first">On R1, issue the show access-lists command.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="c1"># show access-lists</span>
<span class="n">Standard</span> <span class="n">IP</span> <span class="n">access</span> <span class="nb">list</span> <span class="n">BRANCH</span><span class="o">-</span><span class="n">OFFICE</span><span class="o">-</span><span class="n">POLICY</span>
 <span class="mi">10</span> <span class="n">permit</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">30.3</span>
 <span class="mi">20</span> <span class="n">permit</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">40.0</span><span class="p">,</span> <span class="n">wildcard</span> <span class="n">bits</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.255</span>
</pre></div>
</div>
<p>Is there any difference between this ACL on R1 with the ACL on R3? If so, what is it?</p>
</li>
<li><p class="first">On R1, issue the <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">ip</span> <span class="pre">interface</span> <span class="pre">g0/1</span></code> command.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="c1">#</span>
<span class="n">show</span> <span class="n">ip</span> <span class="n">interface</span> <span class="n">g0</span><span class="o">/</span><span class="mi">1</span>
<span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mi">1</span> <span class="ow">is</span> <span class="n">up</span><span class="p">,</span> <span class="n">line</span> <span class="n">protocol</span> <span class="ow">is</span> <span class="n">up</span>
  <span class="n">Internet</span> <span class="n">address</span> <span class="ow">is</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">10.1</span><span class="o">/</span><span class="mi">24</span>
  <span class="n">Broadcast</span> <span class="n">address</span> <span class="ow">is</span> <span class="mf">255.255</span><span class="o">.</span><span class="mf">255.255</span>
  <span class="n">Address</span> <span class="n">determined</span> <span class="n">by</span> <span class="n">non</span><span class="o">-</span><span class="n">volatile</span> <span class="n">memory</span>
  <span class="n">MTU</span> <span class="ow">is</span> <span class="mi">1500</span> <span class="nb">bytes</span>
  <span class="n">Helper</span> <span class="n">address</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">set</span>
  <span class="n">Directed</span> <span class="n">broadcast</span> <span class="n">forwarding</span> <span class="ow">is</span> <span class="n">disabled</span>
  <span class="n">Multicast</span> <span class="n">reserved</span> <span class="n">groups</span> <span class="n">joined</span><span class="p">:</span> <span class="mf">224.0</span><span class="o">.</span><span class="mf">0.10</span>
  <span class="n">Outgoing</span> <span class="n">access</span> <span class="nb">list</span> <span class="ow">is</span> <span class="n">BRANCH</span><span class="o">-</span><span class="n">OFFICE</span><span class="o">-</span><span class="n">POLICY</span>
  <span class="n">Inbound</span> <span class="n">access</span> <span class="nb">list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">set</span>
<span class="o">&lt;</span><span class="n">Output</span> <span class="n">omitted</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">Test the ACL. From the command prompt on PC-C, ping PC-A’s IP address. Were the pingssuccessful?</p>
</li>
<li><p class="first">Test the ACL to ensure that only the PC-C host is allowed access to the 192.168.10.0/24 network. You must do an extended ping and use the G0/1 address on R3 as your source. Ping PC-A’s IP address. Were the pings successful?</p>
</li>
<li><p class="first">Test the ACL to see if it allows traffic from the 192.168.40.0/24 network access to the 192.168.10.0/24 network. You must perform an extended ping and use the loopback 0 address on R3 as your source. Ping PC-A’s IP address. Were the pings successful?</p>
</li>
</ol>
</li>
</ul>
</li>
<li><p class="first">Management has decided that users from the 209.165.200.224/27 network should be allowed full access to the 192.168.10.0/24 network. Management also wants ACLs on all of their router s to follow consistent rules. A deny any ACE should be placed at the end of all ACLs. You must modify the BRANCH-OFFICE-POLICY ACL. You will add two additional lines to this ACL. There are two ways you could do this:</p>
<ul>
<li><p class="first">OPTION 1: Issue a no ip access-list standard BRANCH-OFFICE-POLICY command in global configuration mode. This would effectively take the whole ACL out of the router. Depending upon the router IOS, one of the following scenarios would occur:</p>
<p>all filtering of packets would be cancelled and all packets would be allowed through the router; or, because you did not take off the ip access-group command on the G0/1 interface, filtering is still in place. Regardless, when the ACL is gone, you could retype the whole ACL, or cut and paste it in from a text editor.</p>
</li>
<li><p class="first">OPTION 2: You can modify ACLs in place by adding or deleting specific lines within the ACL itself. This can come in handy, especially with ACLs that have many lines of code. The retyping of the whole ACL or cutting and pasting can easily lead to errors. Modifying specific lines within the ACL is easily accomplished. For this lab, use Option 2.</p>
</li>
<li><p class="first">From R1 privileged EXEC mode, issue a show access-lists command.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="c1"># show access-lists</span>
<span class="n">Standard</span> <span class="n">IP</span> <span class="n">access</span> <span class="nb">list</span> <span class="n">BRANCH</span><span class="o">-</span><span class="n">OFFICE</span><span class="o">-</span><span class="n">POLICY</span>
    <span class="mi">10</span> <span class="n">permit</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">30.3</span> <span class="p">(</span><span class="mi">8</span> <span class="n">matches</span><span class="p">)</span>
    <span class="mi">20</span> <span class="n">permit</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">40.0</span><span class="p">,</span> <span class="n">wildcard</span> <span class="n">bits</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.255</span> <span class="p">(</span><span class="mi">5</span> <span class="n">matches</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">Add two additional lines at the end of the ACL. From global config mode, modify the ACL, BRANCH-OFFICE-POLICY.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="c1">#(config)# ip access-list standard BRANCH-OFFICE-POLICY</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">std</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1"># 30 permit 209.165.200.224 0.0.0.31</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">std</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1"># 40 deny any</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">std</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1"># end</span>
</pre></div>
</div>
</li>
<li><p class="first">Verify the ACL.</p>
<ol class="arabic">
<li><p class="first">On R1, issue the show access-lists command.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="c1"># show access-lists</span>
<span class="n">Standard</span> <span class="n">IP</span> <span class="n">access</span> <span class="nb">list</span> <span class="n">BRANCH</span><span class="o">-</span><span class="n">OFFICE</span><span class="o">-</span><span class="n">POLICY</span>
    <span class="mi">10</span> <span class="n">permit</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">30.3</span> <span class="p">(</span><span class="mi">8</span> <span class="n">matches</span><span class="p">)</span>
    <span class="mi">20</span> <span class="n">permit</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">40.0</span><span class="p">,</span> <span class="n">wildcard</span> <span class="n">bits</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.255</span> <span class="p">(</span><span class="mi">5</span> <span class="n">matches</span><span class="p">)</span>
    <span class="mi">30</span> <span class="n">permit</span> <span class="mf">209.165</span><span class="o">.</span><span class="mf">200.224</span><span class="p">,</span> <span class="n">wildcard</span> <span class="n">bits</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.31</span>
    <span class="mi">40</span> <span class="n">deny</span>   <span class="nb">any</span>
</pre></div>
</div>
<p>Do you have to apply the BRANCH-OFFICE-POLICY to the G0/1 interface on R1?</p>
</li>
<li><p class="first">From the ISP command prompt, issue an extended ping. Test the ACL to see if it allows traffic from the 209.165.200.224/27 network access to the 192.168.10.0/24 network. You must do an extended ping and use the loopback 0 address on ISP as your source. Ping PC-A’s IP address. Were the pings successful?</p>
</li>
</ol>
</li>
</ul>
</li>
</ol>
<p>Reflection
1. As you can see, standard ACLs are very powerful and work quite well. Why would you ever have the need for
using extended ACLs?
2. Typically, more typing is required when using a named ACL as opposed to a numbered ACL. Why would you
choose named ACLs over numbered?</p>
</div>
</div>
<div class="section" id="editing-numbered-acls">
<h2>Editing Numbered ACLs<a class="headerlink" href="#editing-numbered-acls" title="Permalink to this headline">¶</a></h2>
<div class="section" id="method-1-use-a-text-editor">
<h3>Method 1 - Use a Text Editor<a class="headerlink" href="#method-1-use-a-text-editor" title="Permalink to this headline">¶</a></h3>
<p>After someone is familiar with creating and editing ACLs, it may be easier to construct the ACL using a text editor such as Microsoft Notepad. This allows you to create or edit the ACL and then paste it into the router interface. For an existing ACL, you can use the show running-config command to display the ACL, copy and paste it into the text editor, make the necessary changes, and paste it back in to the router interface.</p>
<p>Configuration: For example, assume that the host IPv4 address in the figure was incorrectly entered. Instead of the 192.168.10.99 host, it should have been the 192.168.10.10 host. Here are the steps to edit and correct ACL 1:</p>
<ol class="arabic simple">
<li>Display the ACL using the show running-config command. The example in the figure uses the include keyword to display only the ACEs.</li>
<li>Highlight the ACL, copy it, and then paste it into a Notepad. Edit the list as required. After the ACL is correctly displayed in Notepad, highlight it and copy it.</li>
</ol>
<p>Step 3. In global configuration mode, remove the access list using the no access-list 1 command. Otherwise, the new statements would be appended to the existing ACL. Then paste the new ACL into the configuration of the router.</p>
<p>Step 4. Using the show running-config command, verify the changes</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">when using the no access-list command, different IOS software releases act differently. If the ACL that has been deleted is still applied to an interface, some IOS versions act as if <strong>no ACL is protecting your network while others deny all traffic</strong></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For this reason it is <strong>good practice to remove the reference to the access list from the interface</strong> before modifying the access list. If there is an error in the new list, disable it and troubleshoot the problem. In that instance, the network has no ACL during the correction process.</p>
</div>
</div>
<div class="section" id="method-2-use-sequence-numbers">
<h3>Method 2 - Use Sequence Numbers<a class="headerlink" href="#method-2-use-sequence-numbers" title="Permalink to this headline">¶</a></h3>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">goto</span> <span class="n">acl</span>
<span class="o">--------</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="n">ip</span> <span class="n">access</span><span class="o">-</span><span class="nb">list</span> <span class="n">standard</span> <span class="mi">1</span>

<span class="n">fix</span> <span class="n">line</span>
<span class="o">--------</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">std</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1"># no 10</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">std</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1"># 10 deny host 192.168.10.10</span>

<span class="n">verify</span>
<span class="o">------</span>
<span class="n">R1</span><span class="c1"># show access-lists</span>
<span class="n">R1</span><span class="c1"># show running-config | include access-list 1</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Cisco IOS implements an internal logic to standard access lists. The order in which standard ACEs are entered may not be the order in which they are stored, displayed or processed by the router. The show access-lists command displays the ACEs with their sequence numbers.</p>
</div>
</div>
</div>
<div class="section" id="adding-a-line-to-nacl">
<h2>adding a line to NACL<a class="headerlink" href="#adding-a-line-to-nacl" title="Permalink to this headline">¶</a></h2>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="c1">#show access-lists</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="n">ip</span> <span class="n">access</span><span class="o">-</span><span class="nb">list</span> <span class="n">standard</span> <span class="n">NAME_OF_ACCESS_LIST</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1"># 15 deny host 192.168.11.11</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1"># end</span>
</pre></div>
</div>
</div>
<div class="section" id="verifying-standard-acl-interfaces">
<h2>verifying standard ACL interfaces<a class="headerlink" href="#verifying-standard-acl-interfaces" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">R1#</span> <span class="pre">show</span> <span class="pre">ip</span> <span class="pre">interface</span> <span class="pre">s0/0/0</span></code></p>
<p>Outgoing access list is 1
Inbound  access list is not set</p>
<p><code class="docutils literal notranslate"><span class="pre">R1#</span> <span class="pre">show</span> <span class="pre">ip</span> <span class="pre">interface</span> <span class="pre">g0/0</span></code></p>
<p>Outgoing access list is NO_ACCESS
Inbound  access list is not set</p>
<p><code class="docutils literal notranslate"><span class="pre">R1#</span> <span class="pre">show</span> <span class="pre">access-lists</span></code></p>
</div>
<div class="section" id="acl-vs-ip-acl">
<h2>ACL VS IP ACL<a class="headerlink" href="#acl-vs-ip-acl" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">access-list</span></code> command is used to define a numbered ACL, meaning that the ACL will be identified in the configuration by its number. This number also designates the type of this ACL, i.e. standard IP, extended IP, MAC, etc. See here:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Router</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#access-list ?</span>
 <span class="o">&lt;</span><span class="mi">1</span><span class="o">-</span><span class="mi">99</span><span class="o">&gt;</span>            <span class="n">IP</span> <span class="n">standard</span> <span class="n">access</span> <span class="nb">list</span>
 <span class="o">&lt;</span><span class="mi">100</span><span class="o">-</span><span class="mi">199</span><span class="o">&gt;</span>         <span class="n">IP</span> <span class="n">extended</span> <span class="n">access</span> <span class="nb">list</span>
 <span class="o">&lt;</span><span class="mi">1100</span><span class="o">-</span><span class="mi">1199</span><span class="o">&gt;</span>       <span class="n">Extended</span> <span class="mi">48</span><span class="o">-</span><span class="n">bit</span> <span class="n">MAC</span> <span class="n">address</span> <span class="n">access</span> <span class="nb">list</span>
 <span class="o">&lt;</span><span class="mi">1300</span><span class="o">-</span><span class="mi">1999</span><span class="o">&gt;</span>       <span class="n">IP</span> <span class="n">standard</span> <span class="n">access</span> <span class="nb">list</span> <span class="p">(</span><span class="n">expanded</span> <span class="nb">range</span><span class="p">)</span>
 <span class="o">&lt;</span><span class="mi">200</span><span class="o">-</span><span class="mi">299</span><span class="o">&gt;</span>         <span class="n">Protocol</span> <span class="nb">type</span><span class="o">-</span><span class="n">code</span> <span class="n">access</span> <span class="nb">list</span>
 <span class="o">&lt;</span><span class="mi">2000</span><span class="o">-</span><span class="mi">2699</span><span class="o">&gt;</span>       <span class="n">IP</span> <span class="n">extended</span> <span class="n">access</span> <span class="nb">list</span> <span class="p">(</span><span class="n">expanded</span> <span class="nb">range</span><span class="p">)</span>
 <span class="o">&lt;</span><span class="mi">700</span><span class="o">-</span><span class="mi">799</span><span class="o">&gt;</span>         <span class="mi">48</span><span class="o">-</span><span class="n">bit</span> <span class="n">MAC</span> <span class="n">address</span> <span class="n">access</span> <span class="nb">list</span>
</pre></div>
</div>
<p>Following this help output, if you want to define a standard IP ACL, it has to be identified by a number in the range 1-99 or 1300-1999. Analogously, if you want to define an extended IP ACL, it must be numbered from the range 100-199 or 2000-2699. MAC ACLs would use the range 700-799 for standard ACL and 1100-1199 for extended ACL.</p>
<p>The ip access-list command defines a named IPv4 ACL, either standard or extended. A named IP ACL is totally equivalent to a numbered IP ACL in its behavior - the only difference is in the way it is configured and referenced in the configuration. Also, using the ip access-list command, you can not define different types of ACLs like MAC ACLs. Otherwise, a named and a numbered ACLs behave identically.</p>
<p>For example, these two ACLs would provide identical results:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">access</span><span class="o">-</span><span class="nb">list</span> <span class="mi">1</span> <span class="n">deny</span> <span class="n">host</span> <span class="mf">192.0</span><span class="o">.</span><span class="mf">2.4</span>
<span class="n">access</span><span class="o">-</span><span class="nb">list</span> <span class="mi">1</span> <span class="n">deny</span> <span class="mf">192.0</span><span class="o">.</span><span class="mf">2.128</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.127</span>
<span class="n">access</span><span class="o">-</span><span class="nb">list</span> <span class="mi">1</span> <span class="n">permit</span> <span class="nb">any</span>
</pre></div>
</div>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ip</span> <span class="n">access</span><span class="o">-</span><span class="nb">list</span> <span class="n">standard</span> <span class="n">MyACL1</span>
 <span class="n">deny</span> <span class="n">host</span> <span class="mf">192.0</span><span class="o">.</span><span class="mf">2.4</span>
 <span class="n">deny</span> <span class="mf">192.0</span><span class="o">.</span><span class="mf">2.128</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.127</span>
 <span class="n">permit</span> <span class="nb">any</span>
</pre></div>
</div>
<p>Also, these two ACLs would provide identical results:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">access</span><span class="o">-</span><span class="nb">list</span> <span class="mi">100</span> <span class="n">permit</span> <span class="n">tcp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="n">eq</span> <span class="mi">80</span>
<span class="n">access</span><span class="o">-</span><span class="nb">list</span> <span class="mi">100</span> <span class="n">permit</span> <span class="n">tcp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="n">eq</span> <span class="mi">443</span>
<span class="n">access</span><span class="o">-</span><span class="nb">list</span> <span class="mi">100</span> <span class="n">permit</span> <span class="n">udp</span> <span class="nb">any</span> <span class="n">host</span> <span class="mf">192.0</span><span class="o">.</span><span class="mf">2.1</span> <span class="n">eq</span> <span class="mi">53</span>
</pre></div>
</div>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ip</span> <span class="n">access</span><span class="o">-</span><span class="nb">list</span> <span class="n">extended</span> <span class="n">MyACL2</span>
  <span class="n">permit</span> <span class="n">tcp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="n">eq</span> <span class="mi">80</span>
  <span class="n">permit</span> <span class="n">tcp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="n">eq</span> <span class="mi">443</span>
  <span class="n">permit</span> <span class="n">udp</span> <span class="nb">any</span> <span class="n">host</span> <span class="mf">192.0</span><span class="o">.</span><span class="mf">2.1</span> <span class="n">eq</span> <span class="mi">53</span>
</pre></div>
</div>
<p>Apart from the obvious advantage of giving ACLs meaningful names instead of just numbers, the <strong>named ACLs have another advantage: they can actually be edited. Numbered ACLs cannot really be edited - you can only add new entries to their end but if you need to remove or replace an entry, you need to remove the entire ACL</strong> and enter it anew. With named ACLs, it is actually possible to perform in-place editing.</p>
<p>Let’s take the last <strong>named ACL</strong> posted. If you perform <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">ip</span> <span class="pre">access-lists</span></code> you will get the following output:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Router</span><span class="c1">#show ip access-lists</span>
<span class="n">Extended</span> <span class="n">IP</span> <span class="n">access</span> <span class="nb">list</span> <span class="n">MyACL2</span>
 <span class="mi">10</span> <span class="n">permit</span> <span class="n">tcp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="n">eq</span> <span class="n">www</span>
 <span class="mi">20</span> <span class="n">permit</span> <span class="n">tcp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="n">eq</span> <span class="mi">443</span>
 <span class="mi">30</span> <span class="n">permit</span> <span class="n">udp</span> <span class="nb">any</span> <span class="n">host</span> <span class="mf">192.0</span><span class="o">.</span><span class="mf">2.1</span> <span class="n">eq</span> <span class="n">domain</span>
</pre></div>
</div>
<p>Note the numbers 10,20,30 at the each line. They allow you to remove that particular line or insert a new line between them. For example, if I wanted to insert a new rule between the first and second entry, it would be done as follows:
ch7_named_acl_ipv4_pt.pn
.. code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ip</span> <span class="n">access</span><span class="o">-</span><span class="nb">list</span> <span class="n">extended</span> <span class="n">MyACL2</span>
 <span class="mi">15</span> <span class="n">permit</span> <span class="n">tcp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="n">eq</span> <span class="mi">110</span>
</pre></div>
</div>
<p>Now the <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">ip</span> <span class="pre">access-lists</span></code> would say:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Extended</span> <span class="n">IP</span> <span class="n">access</span> <span class="nb">list</span> <span class="n">MyACL2</span>
 <span class="mi">10</span> <span class="n">permit</span> <span class="n">tcp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="n">eq</span> <span class="n">www</span>
 <span class="mi">15</span> <span class="n">permit</span> <span class="n">tcp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="n">eq</span> <span class="n">pop3</span>
 <span class="mi">20</span> <span class="n">permit</span> <span class="n">tcp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="n">eq</span> <span class="mi">443</span>
 <span class="mi">30</span> <span class="n">permit</span> <span class="n">udp</span> <span class="nb">any</span> <span class="n">host</span> <span class="mf">192.0</span><span class="o">.</span><span class="mf">2.1</span> <span class="n">eq</span> <span class="n">domain</span>
</pre></div>
</div>
<p>I could use any number bch7_named_acl_ipv4_pt.pnetween 11 and 19, inclusive.</p>
<p>Now, if I wanted to remove the line 30 (the one permitting the DNS access), the command would be:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ip</span> <span class="n">access</span><span class="o">-</span><span class="nb">list</span> <span class="n">extended</span> <span class="n">MyACL2</span>
<span class="n">no</span> <span class="mi">30</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">ip</span> <span class="pre">access-lists</span></code> would now produce:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Extended</span> <span class="n">IP</span> <span class="n">access</span> <span class="nb">list</span> <span class="n">MyACL2</span>
 <span class="mi">10</span> <span class="n">permit</span> <span class="n">tcp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="n">eq</span> <span class="n">www</span>
 <span class="mi">15</span> <span class="n">permit</span> <span class="n">tcp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="n">eq</span> <span class="n">pop3</span>
 <span class="mi">20</span> <span class="n">permit</span> <span class="n">tcp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="n">eq</span> <span class="mi">443</span>
</pre></div>
</div>
<p>These numbers are not really stored in the configuration - they are only runtime-remembered. If you restart the router, they will be reset again to 10,20,30,etc. In case you need to resequence the ACL without restarting the router, you can use the command <code class="docutils literal notranslate"><span class="pre">ip</span> <span class="pre">access-list</span> <span class="pre">resequence</span> <span class="pre">MyACL2</span> <span class="pre">10</span> <span class="pre">10</span></code> where the <strong>first “10” number specifies the starting number of the ACL entry, and the second “10” represents the increment</strong>. After entering this command in the global configuration mode, the show ip access-lists again shows:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Extended</span> <span class="n">IP</span> <span class="n">access</span> <span class="nb">list</span> <span class="n">MyACL2</span>
 <span class="mi">10</span> <span class="n">permit</span> <span class="n">tcp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="n">eq</span> <span class="n">www</span>
 <span class="mi">20</span> <span class="n">permit</span> <span class="n">tcp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="n">eq</span> <span class="n">pop3</span>
 <span class="mi">30</span> <span class="n">permit</span> <span class="n">tcp</span> <span class="nb">any</span> <span class="nb">any</span> <span class="n">eq</span> <span class="mi">443</span>
</pre></div>
</div>
<p>So to wrap it up, <em>numbered ACLs and named ACLs defined using the ip access-list command have the same effect</em>. However, <strong>the named ACLs are more flexible</strong> in the way they are defined, managed and referenced.</p>
</div>
<div class="section" id="clearing-acl-statistics">
<h2>Clearing ACL Statistics<a class="headerlink" href="#clearing-acl-statistics" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">R1#</span> <span class="pre">clear</span> <span class="pre">access-list</span> <span class="pre">counters</span> <span class="pre">1</span></code> or <code class="docutils literal notranslate"><span class="pre">clear</span> <span class="pre">access-list</span> <span class="pre">counters</span> <span class="pre">ACL_NAME</span></code></p>
<img alt="../../../_images/clear_matches_acl.png" src="../../../_images/clear_matches_acl.png" />
</div>
<div class="section" id="accesss-class-command">
<h2>Accesss-class command<a class="headerlink" href="#accesss-class-command" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">access-class</span></code> command configured in line configuration mode restricts incoming and outgoing connections between a particular VTY (into a Cisco device) and the addresses in an access list.</p>
<p>The command syntax of the access-class command is:</p>
<p><code class="docutils literal notranslate"><span class="pre">Router(config-line)#</span> <span class="pre">access-class</span> <span class="pre">access-list-number</span> <span class="pre">{</span> <span class="pre">in</span> <span class="pre">[</span> <span class="pre">vrf-also</span> <span class="pre">]</span> <span class="pre">|</span> <span class="pre">out</span> <span class="pre">}</span></code></p>
<p>The parameter in restricts incoming connections between the addresses in the access list and the Cisco device, while the parameter out restricts outgoing connections between a particular Cisco device and the addresses in the access list.</p>
<p>The following should be considered when configuring access lists on VTYs:</p>
<blockquote>
<div>Both named and numbered access lists can be applied to VTYs.
Identical restrictions should be set on all the VTYs, because a user can attempt to connect to any of them.</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Access lists apply to packets that travel through a router. They are not designed to block packets that originate within the router. By default, an outbound ACL does not prevent remote access connections initiated from the router.</p>
</div>
<img alt="../../../_images/ch7_access_class_1.png" src="../../../_images/ch7_access_class_1.png" />
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># line vty 0 15</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">line</span><span class="p">)</span><span class="c1"># login local</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">line</span><span class="p">)</span><span class="c1"># transport input ssh</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">line</span><span class="p">)</span><span class="c1"># access-class 21 in</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">line</span><span class="p">)</span><span class="c1"># exit</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 21 permit 192.168.10.0 0.0.0.255</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 21 deny any</span>
</pre></div>
</div>
</div>
<div class="section" id="the-implicit-deny-any">
<h2>The implicit Deny Any<a class="headerlink" href="#the-implicit-deny-any" title="Permalink to this headline">¶</a></h2>
<p>A single-entry ACL with only one deny entry has the effect of denying all traffic. At least one permit ACE must be configured in an ACL or all traffic is blocked.</p>
<p>For the network in the figure, applying either ACL 1 or ACL 2 to the S0/0/0 interface of R1 in the outbound direction will have the same effect. Network 192.168.10.0 will be permitted to access the networks reachable through S0/0/0, while 192.168.11.0 will not be allowed to access those networks. In ACL 1, if a packet does not match the permit statement, it is discarded.</p>
<img alt="../../../_images/Ch7_implicit_deny_any.png" src="../../../_images/Ch7_implicit_deny_any.png" />
<p>ACL 1</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 1 permit 192.168.10.0 0.0.0.255</span>
</pre></div>
</div>
<p>ACL 2</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 2 permit 192.168.10.0 0.0.0.255</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 2 deny any</span>
</pre></div>
</div>
</div>
<div class="section" id="the-order-of-aces-in-an-acl">
<h2>The order of ACEs in an ACL<a class="headerlink" href="#the-order-of-aces-in-an-acl" title="Permalink to this headline">¶</a></h2>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 3 deny 192.168.10.0 0.0.0.255</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 3 permit host 192.168.10.10</span>
<span class="o">%</span> <span class="n">Access</span> <span class="n">rule</span> <span class="n">can</span><span class="s1">&#39;t be configured at higher sequence num as it is part of the existing rule at sequence num 10</span>
</pre></div>
</div>
<p>ACL 3 Host statement conflicts with previous range statement</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 4 permit host 192.168.10.10</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 4 deny 192.168.10.0 0.0.0.255</span>
</pre></div>
</div>
<p>ACL 4
.. note:: Host statement can always be configured before range statements</p>
<p>ACL 5</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 5 deny 192.168.10.0 0.0.0.255</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 5 permit host 192.168.11.10</span>
</pre></div>
</div>
<p>Host statement can be configured if there’s no conflict</p>
</div>
<div class="section" id="sequencing-considerations-during-configuration">
<h2>Sequencing considerations during configuration<a class="headerlink" href="#sequencing-considerations-during-configuration" title="Permalink to this headline">¶</a></h2>
<img alt="../../../_images/Ch7_sequencing_config.png" src="../../../_images/Ch7_sequencing_config.png" />
<img alt="../../../_images/Ch7_sequencing_after_reload.png" src="../../../_images/Ch7_sequencing_after_reload.png" />
<p>The order in which the standard ACEs are listed is the sequence used by the IOS to process the list. Notice that the statements are grouped into two sections, host statements followed by range statements. The sequence number indicates the order that the statement was entered, not the order the statement will be processed.</p>
<p><strong>The host statements are listed first but not necessarily in the order that they were entered. The IOS puts host statements in an order using a special hashing function</strong>. The resulting order optimizes the search for a host ACL entry. <strong>The range statements are displayed after the host statements. These statements are listed in the order in which they were entered</strong>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The hashing function is only applied to host statements in an IPv4 standard access list.</p>
</div>
<p>Recall that standard and numbered ACLs can be edited using sequence numbers. When inserting a new ACL statement, the sequence number will only affect the location of a range statement in the list. <strong>Host statements will always be put in order using the hashing function.</strong></p>
</div>
<div class="section" id="acl-and-routing-processes">
<h2>ACL and Routing Processes<a class="headerlink" href="#acl-and-routing-processes" title="Permalink to this headline">¶</a></h2>
<p>open in new tab to view properly</p>
<a class="reference internal image-reference" href="../../../_images/Ch7_acl_router_processes.png"><img alt="../../../_images/Ch7_acl_router_processes.png" src="../../../_images/Ch7_acl_router_processes.png" style="width: 1874px; height: 360px;" /></a>
<p>When a packet arrives at a router interface, the router process is the same, whether ACLs are used or not. As a frame enters an interface, the router checks to see whether the destination Layer 2 address matches its interface Layer 2 address, or whether the frame is a broadcast frame.</p>
<p>If the frame address is accepted, the frame information is stripped off and the router checks for an ACL on the inbound interface. If an ACL exists, the packet is tested against the statements in the list.</p>
<p>If the packet matches a statement, the packet is either permitted or denied. If the packet is accepted, it is then checked against routing table entries to determine the destination interface. If a routing table entry exists for the destination, the packet is then switched to the outgoing interface, otherwise the packet is dropped.</p>
<p>Next, the router checks whether the outgoing interface has an ACL. If an ACL exists, the packet is tested against the statements in the list.</p>
<p>If the packet matches a statement, it is either permitted or denied.</p>
<p>If there is no ACL or the packet is permitted, the packet is encapsulated in the new Layer 2 protocol and forwarded out the interface to the next device.</p>
</div>
<div class="section" id="troubleshooting-std-ipv4-acls">
<h2>Troubleshooting StD IPv4 ACLs<a class="headerlink" href="#troubleshooting-std-ipv4-acls" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">access-list</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">R1#</span> <span class="pre">show</span> <span class="pre">run</span> <span class="pre">|</span> <span class="pre">section</span> <span class="pre">interface</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">R1#</span> <span class="pre">show</span> <span class="pre">run</span> <span class="pre">|</span> <span class="pre">section</span> <span class="pre">line</span> <span class="pre">vty</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">R1(config)#</span> <span class="pre">ip</span> <span class="pre">access-list</span> <span class="pre">standard</span> <span class="pre">PC1-SSH</span></code> followed by <code class="docutils literal notranslate"><span class="pre">R1(config-std-nacl)#</span> <span class="pre">no</span> <span class="pre">10</span></code> followed by correction <code class="docutils literal notranslate"><span class="pre">R1(config-std-nacl)#</span> <span class="pre">10</span> <span class="pre">permit</span> <span class="pre">host</span> <span class="pre">192.168.10.10</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">R1#</span> <span class="pre">clear</span> <span class="pre">access-list</span> <span class="pre">counters</span></code> to only show new matches</li>
</ul>
<ol class="arabic">
<li><p class="first">check access-list</p>
</li>
<li><p class="first">check if access-list is applied to the correct interface</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="c1"># conf t</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># interface g0/1</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># no ip access-group 20 in</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># interface g0/0</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ip access-group 20 out</span>
</pre></div>
</div>
</li>
<li><p class="first">check if access-list is applied via access-class on vty’s</p>
</li>
</ol>
</div>
<div class="section" id="exercices">
<h2>Exercices<a class="headerlink" href="#exercices" title="Permalink to this headline">¶</a></h2>
<div class="section" id="pt-troubleshooting-std-ipv4-acls">
<h3>PT Troubleshooting StD IPv4 ACLs<a class="headerlink" href="#pt-troubleshooting-std-ipv4-acls" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>Policy:</dt>
<dd><ul class="first last simple">
<li>Hosts from the 192.168.0.0/24 network are unable to access network 10.0.0.0/8.</li>
<li>L3 can’t access any devices in network 192.168.0.0/24.</li>
<li>L3 can’t access Server1 or Server2. L3 should only access Server3.</li>
<li>Hosts from the 172.16.0.0/16 network have full access to Server1, Server2 and Server3.</li>
</ul>
</dd>
</dl>
<table border="1" class="docutils" id="id1">
<caption><span class="caption-text">7.3.2.4 Packet Tracer</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><p class="first">given:</p>
<div class="code last highlight-default notranslate"><div class="highlight"><pre><span></span>interface GigabitEthernet0/0
 ip address 10.0.0.1 255.0.0.0
 ip access-group FROM_10 in
 duplex auto
 speed auto
!
interface GigabitEthernet0/1
 ip address 172.16.0.1 255.255.0.0
 ip access-group FROM_172 in
 duplex auto
 speed auto
!
interface GigabitEthernet0/2
 ip address 192.168.0.1 255.255.255.0
 duplex auto
 speed auto
!
interface Vlan1
 no ip address
 shutdown
!
ip classless
!
ip flow-export version 9
!
!
ip access-list standard FROM_192
 deny 192.168.0.0 0.0.0.255
 permit any
ip access-list standard FROM_10
 deny host 10.0.0.22
 permit any
ip access-list standard FROM_172
 deny host 172.16.0.2
 permit any
!
</pre></div>
</div>
</td>
<td><p class="first">solution:</p>
<div class="code last highlight-default notranslate"><div class="highlight"><pre><span></span>interface GigabitEthernet0/0
 ip address 10.0.0.1 255.0.0.0
 ip access-group FROM_10 in
 ip access-group FROM_192 out
 duplex auto
 speed auto
!
interface GigabitEthernet0/1
 ip address 172.16.0.1 255.255.0.0
 ip access-group FROM_172 in
 duplex auto
 speed auto
!
interface GigabitEthernet0/2
 ip address 192.168.0.1 255.255.255.0
 duplex auto
 speed auto
!
interface Vlan1
 no ip address
 shutdown
!
ip classless
!
ip flow-export version 9
!
!
ip access-list standard FROM_192
 deny 192.168.0.0 0.0.0.255
 permit any
ip access-list standard FROM_10
 deny host 10.0.0.2
 permit any
ip access-list standard FROM_172
!
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="pt-ch7-skills-integration-challenge">
<h3>PT Ch7 Skills Integration Challenge<a class="headerlink" href="#pt-ch7-skills-integration-challenge" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="14%" />
<col width="20%" />
<col width="22%" />
<col width="22%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Device</th>
<th class="head">Interface</th>
<th class="head">IP Address</th>
<th class="head">Subnet Mask</th>
<th class="head">Default Gateway</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td rowspan="4"><blockquote class="first">
<div>HQ1</div></blockquote>
<p>HQServer HQ2</p>
<blockquote class="last">
<div><p>Branch</p>
<blockquote>
<div>ISP</div></blockquote>
</div></blockquote>
</td>
<td>G0/0</td>
<td>172.16.127.254</td>
<td>255.255.192.0</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>G0/1</td>
<td>172.16.63.254</td>
<td>255.255.192.0</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>S0/0/0</td>
<td>192.168.0.1</td>
<td>255.255.255.252</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>S0/0/1</td>
<td>64.104.34.2</td>
<td>255.255.255.252</td>
<td>64.104.34.1</td>
</tr>
<tr class="row-even"><td rowspan="3"><p class="first">BranchServer,B2</p>
<blockquote class="last">
<div><p>B1</p>
<p>HQ</p>
</div></blockquote>
</td>
<td>G0/0</td>
<td>172.16.159.254</td>
<td>255.255.240.0</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>G0/1</td>
<td>172.16.143.254</td>
<td>255.255.240.0</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>S0/0/0</td>
<td>192.168.0.2</td>
<td>255.255.255.252</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>HQ1</td>
<td>NIC</td>
<td>172.16.64.1</td>
<td>255.255.192.0</td>
<td>172.16.127.254</td>
</tr>
<tr class="row-even"><td>HQ2</td>
<td>NIC</td>
<td>172.16.0.2</td>
<td>255.255.192.0</td>
<td>172.16.63.254</td>
</tr>
<tr class="row-odd"><td>HQServer.pka</td>
<td>NIC</td>
<td>172.16.0.1</td>
<td>255.255.192.0</td>
<td>172.16.63.254</td>
</tr>
<tr class="row-even"><td>B1</td>
<td>NIC</td>
<td>172.16.144.1</td>
<td>255.255.240.0</td>
<td>172.16.159.254</td>
</tr>
<tr class="row-odd"><td>B2</td>
<td>NIC</td>
<td>172.16.128.2</td>
<td>255.255.240.0</td>
<td>172.16.143.254</td>
</tr>
<tr class="row-even"><td>BranchServer.pka</td>
<td>NIC</td>
<td>172.16.128.1</td>
<td>255.255.240.0</td>
<td>172.16.143.254</td>
</tr>
</tbody>
</table>
<img alt="../../../_images/Ch7_Skills_Integration.png" src="../../../_images/Ch7_Skills_Integration.png" />
<ol class="arabic">
<li><p class="first">Configure HQ &amp; Branch with RIPv2 routing:</p>
<ul>
<li><p class="first">Advertise all three attached networks. Do not advertise the link to the internet.</p>
</li>
<li><p class="first">Configure appropriate interfaces as passive</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HQ</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#router rip</span>
<span class="n">HQ</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1">#version 2</span>
<span class="n">HQ</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1">#network 172.16.0.0</span>
<span class="n">HQ</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1">#network 192.168.0.0</span>
<span class="n">HQ</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1">#passive-interface GigabitEthernet 0/1</span>
<span class="n">HQ</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1">#passive-interface GigabitEthernet 0/0</span>
<span class="n">HQ</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1">#passive-interface Serial 0/0/1</span>


<span class="n">Branch</span><span class="o">&gt;</span><span class="n">enable</span>
<span class="n">Branch</span><span class="c1">#conf t</span>
<span class="n">Branch</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#router rip</span>
<span class="n">Branch</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1">#version 2</span>
<span class="n">Branch</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1">#passive-interface GigabitEthernet 0/0</span>
<span class="n">Branch</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1">#passive-interface GigabitEthernet 0/1</span>
<span class="n">Branch</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1">#no auto-summary</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">By default routing protocol like RIP and EIGRP summarize subnets into major classful network at classful boundary. In other word, these protocols perform an auto-summarization each time they crosses a border between two different major networks. To disable this behavior and advertise subnets, ‘no auto-summary’ command is used. Let’s say router has two subnets 172.16.8.0/24 and 172.16.4.0/24 of Class B network and one subnet 10.2.0.0/16 of Class A. When auto-summary is enabled, router will advertise only summarized major classful network 172.16.0.0/16.</p>
</div>
<ol class="arabic">
<li><p class="first">Set a default route on HQ that directs traffic to S0/0/1 interface. Redistribute the route to Branch.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HQ</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#ip route 0.0.0.0 0.0.0.0 Serial 0/0/1</span>
<span class="o">%</span><span class="n">Default</span> <span class="n">route</span> <span class="n">without</span> <span class="n">gateway</span><span class="p">,</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">a</span> <span class="n">point</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">point</span> <span class="n">interface</span><span class="p">,</span> <span class="n">may</span> <span class="n">impact</span> <span class="n">performance</span>
<span class="n">HQ</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#router rip</span>
<span class="n">HQ</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1">#default-information originate</span>
</pre></div>
</div>
</li>
<li><p class="first">design NACL HQServer to prevent any pc’s attached to Branch G0/1 from accessing HQServer.pka. All other traffic is permitted. Configure on appropriate router, apply it to the appropriate interface and in the appropriate direction.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HQ</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#ip access-list standard HQServer</span>
<span class="n">HQ</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">std</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1">#deny 172.16.128.0 0.0.15.255</span>
<span class="n">HQ</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">std</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1">#permit any</span>
<span class="n">HQ</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">std</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1">#exit</span>
<span class="n">HQ</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#interface GigabitEthernet 0/1</span>
<span class="n">HQ</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1">#ip access-group HQServer out</span>
</pre></div>
</div>
</li>
<li><p class="first">design NACL BranchServer to prevent any pc’s attached to HQ G0/0 from accessing the Branch server. All other traffic is permitted. Configure access list on appropriate router,interface,direction.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HQ</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#ip access-list standard BranchServer</span>
<span class="n">HQ</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">std</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1">#deny 172.16.64.0 0.0.63.255</span>
<span class="n">HQ</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">std</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1">#permit any</span>
<span class="n">HQ</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">std</span><span class="o">-</span><span class="n">nacl</span><span class="p">)</span><span class="c1">#exit</span>
<span class="n">HQ</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#interface GigabitEthernet 0/1</span>
<span class="n">HQ</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1">#ip access-group BranchServer</span>
</pre></div>
</div>
</li>
</ol>
<table border="1" class="docutils" id="id2">
<caption><span class="caption-text">7.4.2.1 Packet Tracer</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><p class="first">HQ:</p>
<div class="code last highlight-default notranslate"><div class="highlight"><pre><span></span>interface GigabitEthernet0/0
ip address 172.16.127.254 255.255.192.0
 duplex auto
 speed auto
!
interface GigabitEthernet0/1
 ip address 172.16.63.254 255.255.192.0
 ip access-group HQServer out
 duplex auto
 speed auto
!
interface GigabitEthernet0/2
 no ip address
 duplex auto
 speed auto
 shutdown
!
interface Serial0/0/0
 ip address 192.168.0.1 255.255.255.252
 clock rate 2000000
!
interface Serial0/0/1
 description link_ISP
 ip address 64.104.34.2 255.255.255.252
!
interface Vlan1
 no ip address
 shutdown
!
router rip
 version 2
 passive-interface GigabitEthernet0/0
 passive-interface GigabitEthernet0/1
 passive-interface Serial0/0/1
 network 172.16.0.0
 network 192.168.0.0
 default-information originate
 no auto-summary
!
ip classless
ip route 0.0.0.0 0.0.0.0 Serial0/0/1
!
ip flow-export version 9
!
!
ip access-list standard BranchServer
 deny 172.16.64.0 0.0.63.255
 permit any
ip access-list standard HQServer
 deny 172.16.144.0 0.0.15.255
 permit any
!
</pre></div>
</div>
</td>
<td><p class="first">Branch:</p>
<div class="code last highlight-default notranslate"><div class="highlight"><pre><span></span>interface GigabitEthernet0/0
 ip address 172.16.159.254 255.255.240.0
 duplex auto
 speed auto
!
interface GigabitEthernet0/1
 ip address 172.16.143.254 255.255.240.0
 ip access-group BranchServer out
 duplex auto
 speed auto
!
interface GigabitEthernet0/2
 no ip address
 duplex auto
 speed auto
 shutdown
!
interface Serial0/0/0
 ip address 192.168.0.2 255.255.255.252
!
interface Serial0/0/1
 no ip address
 clock rate 2000000
!
interface Vlan1
 no ip address
 shutdown
!
router rip
 version 2
 passive-interface GigabitEthernet0/0
 passive-interface GigabitEthernet0/1
 no auto-summary
!
ip classless
!
ip flow-export version 9
!
!
ip access-list standard BranchServer
 deny 172.16.64.0 0.0.63.255
 permit any
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<p>using debugging to see update entries: <code class="docutils literal notranslate"><span class="pre">router#debug</span> <span class="pre">ip</span> <span class="pre">rip</span></code></p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HQ</span><span class="c1">#debug ip ?</span>
  <span class="n">eigrp</span>    <span class="n">IP</span><span class="o">-</span><span class="n">EIGRP</span> <span class="n">information</span>
  <span class="n">icmp</span>     <span class="n">ICMP</span> <span class="n">transactions</span>
  <span class="n">nat</span>      <span class="n">NAT</span> <span class="n">events</span>
  <span class="n">ospf</span>     <span class="n">OSPF</span> <span class="n">information</span>
  <span class="n">packet</span>   <span class="n">Packet</span> <span class="n">information</span>
  <span class="n">rip</span>      <span class="n">RIP</span> <span class="n">protocol</span> <span class="n">transactions</span>
  <span class="n">routing</span>  <span class="n">Routing</span> <span class="n">table</span> <span class="n">events</span>
<span class="n">HQ</span><span class="c1">#debug ipv6 ?</span>
  <span class="n">dhcp</span>     <span class="n">IPv6</span> <span class="n">DHCP</span> <span class="n">debugging</span>
  <span class="n">inspect</span>  <span class="n">Stateful</span> <span class="n">inspection</span> <span class="n">events</span>
  <span class="n">nd</span>       <span class="n">IPv6</span> <span class="n">Neighbor</span> <span class="n">Discovery</span> <span class="n">debugging</span>
  <span class="n">ospf</span>     <span class="n">OSPF</span> <span class="n">information</span>
<span class="o">---------------</span>
<span class="n">HQ</span><span class="c1">#debug ip rip</span>
<span class="o">---------------</span>
   <span class="n">RIP</span><span class="p">:</span> <span class="n">sending</span>  <span class="n">v2</span> <span class="n">update</span> <span class="n">to</span> <span class="mf">224.0</span><span class="o">.</span><span class="mf">0.9</span> <span class="n">via</span> <span class="n">Serial0</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span> <span class="p">(</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">0.1</span><span class="p">)</span>
   <span class="n">RIP</span><span class="p">:</span> <span class="n">build</span> <span class="n">update</span> <span class="n">entries</span>
         <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span> <span class="n">via</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">metric</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tag</span> <span class="mi">0</span>
         <span class="mf">172.16</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">18</span> <span class="n">via</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">metric</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tag</span> <span class="mi">0</span>
         <span class="mf">172.16</span><span class="o">.</span><span class="mf">64.0</span><span class="o">/</span><span class="mi">18</span> <span class="n">via</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">metric</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tag</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="section" id="chapter-7-exam">
<h3>Chapter 7 exam<a class="headerlink" href="#chapter-7-exam" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="19%" />
<col width="32%" />
<col width="27%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">device name</th>
<th class="head">interface</th>
<th class="head">ipaddress/submask</th>
<th class="head">gateway</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Atom</td>
<td>Gi0/0.20</td>
<td>172.16.20.0/24</td>
<td>172.16.20.254</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>Gi0/0.40</td>
<td>172.16.40.0/24</td>
<td>172.16.40.254</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>Gi0/0.60</td>
<td>172.16.60.0/24</td>
<td>172.16.60.254</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>Gi0/0.88</td>
<td>172.16.88.0/24</td>
<td>172.16.88.254</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>Gi0/1.250</td>
<td>172.16.250.0/24</td>
<td>172.16.250.254</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>Gi0/1.254</td>
<td>172.16.254.0/24</td>
<td>172.16.254.254</td>
</tr>
<tr class="row-even"><td>Neutron</td>
<td>SVI</td>
<td>172.16.88.101/24</td>
<td>172.16.88.254</td>
</tr>
<tr class="row-odd"><td>Proton</td>
<td>SVI</td>
<td>172.16.88.102/24</td>
<td>172.16.88.254</td>
</tr>
<tr class="row-even"><td>Electron</td>
<td>SVI</td>
<td>172.16.88.103/24</td>
<td>172.16.88.254</td>
</tr>
<tr class="row-odd"><td>Lab 1</td>
<td>NIC</td>
<td>172.16.20.10/24</td>
<td>172.16.20.254</td>
</tr>
<tr class="row-even"><td>Research 1</td>
<td>NIC</td>
<td>172.16.40.10/24</td>
<td>172.16.40.254</td>
</tr>
<tr class="row-odd"><td>Prod 1</td>
<td>NIC</td>
<td>172.16.60.10/24</td>
<td>172.16.60.254</td>
</tr>
<tr class="row-even"><td>Lab 2</td>
<td>NIC</td>
<td>172.16.20.20/24</td>
<td>172.16.20.254</td>
</tr>
<tr class="row-odd"><td>Research 2</td>
<td>NIC</td>
<td>172.16.40.20/24</td>
<td>172.16.40.254</td>
</tr>
<tr class="row-even"><td>Prod 2</td>
<td>NIC</td>
<td>172.16.60.20/24</td>
<td>172.16.60.254</td>
</tr>
<tr class="row-odd"><td>DNS Server</td>
<td>NIC</td>
<td>172.16.254.252</td>
<td>172.16.254.254</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="23%" />
<col width="52%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">VLAN Number</th>
<th class="head">VLAN Name</th>
<th class="head">Device/Ports</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>20</td>
<td>Lab</td>
<td>Proton: Fa0/1 - Fa0/5</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>Electron: Fa0/1 - Fa0/5</td>
</tr>
<tr class="row-even"><td>40</td>
<td>Research</td>
<td>Proton: Fa0/6 - Fa0/10</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>Electron: Fa0/6 - Fa0/10</td>
</tr>
<tr class="row-even"><td>60</td>
<td>Production</td>
<td>Proton: Fa0/11 - Fa0/15</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>Electron: Fa0/11 - Fa0/15</td>
</tr>
<tr class="row-even"><td>88</td>
<td>NetOps</td>
<td>Neutron: SVI</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>Proton: SVI</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td>Electron: SVI</td>
</tr>
</tbody>
</table>
<p>solution on router Atom</p>
<p>commands used on the switches</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">interface</span> <span class="nb">range</span> <span class="n">FastEthernet</span> <span class="mi">0</span><span class="o">/</span><span class="mi">23</span> <span class="o">-</span> <span class="mi">24</span>
<span class="n">switchport</span> <span class="n">mode</span> <span class="n">trunk</span>
<span class="n">switchport</span> <span class="n">trunk</span> <span class="n">allowed</span> <span class="n">vlan</span> <span class="mi">20</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">88</span>

<span class="n">interface</span> <span class="n">GigabitEthernet</span> <span class="mi">0</span><span class="o">/</span><span class="mi">1</span>
<span class="n">switchport</span> <span class="n">mode</span> <span class="n">trunk</span>
<span class="n">switchport</span> <span class="n">trunk</span> <span class="n">allowed</span> <span class="n">vlan</span> <span class="mi">20</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">88</span>

<span class="n">interface</span> <span class="nb">range</span> <span class="n">FastEthernet</span> <span class="mi">0</span><span class="o">/</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">22</span>
<span class="n">switchport</span> <span class="n">mode</span> <span class="n">access</span>

<span class="n">interface</span> <span class="n">vlan</span> <span class="mi">88</span>
<span class="n">ip</span> <span class="n">address</span> <span class="mf">171.16</span><span class="o">.</span><span class="mf">88.101</span> <span class="mf">255.255</span><span class="o">.</span><span class="mf">255.0</span>
<span class="n">no</span> <span class="n">shutdown</span>

<span class="n">interface</span> <span class="nb">range</span> <span class="n">FastEthernet</span> <span class="mi">0</span><span class="o">/</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">5</span>
<span class="n">switchport</span> <span class="n">access</span> <span class="n">vlan</span> <span class="mi">20</span>
<span class="n">no</span> <span class="n">shutdown</span>

<span class="n">interface</span> <span class="nb">range</span> <span class="n">FastEthernet</span> <span class="mi">0</span><span class="o">/</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">10</span>
<span class="n">switchport</span> <span class="n">access</span> <span class="n">vlan</span> <span class="mi">40</span>
<span class="n">no</span> <span class="n">shutdown</span>

<span class="n">interface</span> <span class="nb">range</span> <span class="n">FastEthernet</span> <span class="mi">0</span><span class="o">/</span><span class="mi">11</span> <span class="o">-</span> <span class="mi">15</span>
<span class="n">switchport</span> <span class="n">access</span> <span class="n">vlan</span> <span class="mi">60</span>
<span class="n">no</span> <span class="n">shutdown</span>

<span class="n">vtp</span> <span class="n">domain</span> <span class="n">School</span>
<span class="n">vtp</span> <span class="n">version</span> <span class="mi">2</span>
<span class="n">vtp</span> <span class="n">mode</span> <span class="n">client</span>
</pre></div>
</div>
<p>don’t forget to configure the gateway for switches
and ip address for mgmt vlan on every switch</p>
<dl class="docutils">
<dt>make sure you apply ACL on subinterface</dt>
<dd><code class="docutils literal notranslate"><span class="pre">Network:[[R1name]]:Ports:GigabitEthernet0/1.250:Access-group</span> <span class="pre">Out</span></code></dd>
</dl>
<p>Router configuration</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span>Atom#show run
Building configuration...

Current configuration : 1841 bytes
!
version 15.1
no service timestamps log datetime msec
no service timestamps debug datetime msec
service password-encryption
!
hostname Atom
!
enable secret 5 $1$mERr$hx5rVt7rPNoS4wqbXKX7m0
!
!
!
no ip cef
no ipv6 cef
!
!
!
!
no ip domain-lookup
!
!spanning-tree mode pvst
!
!
!
interface GigabitEthernet0/0
 no ip address
 duplex auto
 speed auto
!
interface GigabitEthernet0/0.20
 encapsulation dot1Q 20
 ip address 172.16.20.254 255.255.255.0
!
interface GigabitEthernet0/0.40
 encapsulation dot1Q 40
 ip address 172.16.40.254 255.255.255.0
!
interface GigabitEthernet0/0.60
 encapsulation dot1Q 60
 ip address 172.16.60.254 255.255.255.0
!
interface GigabitEthernet0/0.88
 encapsulation dot1Q 88
 ip address 172.16.88.254 255.255.255.0
!
interface GigabitEthernet0/1
 no ip address
 duplex auto
 speed auto
!
interface GigabitEthernet0/1.250
 encapsulation dot1Q 250
 ip address 172.16.250.254 255.255.255.0
 ip access-group INT-WEB out
!
interface GigabitEthernet0/1.254
 encapsulation dot1Q 254
 ip address 172.16.254.254 255.255.255.0
!
interface Serial0/0/0
 ip address 209.165.200.226 255.255.255.252
!
interface Serial0/0/1
 no ip address
 clock rate 2000000
 shutdown
!
interface Vlan1
 no ip address
 shutdown
!
ip classless
ip route 0.0.0.0 0.0.0.0 209.165.200.225
!
ip flow-export version 9
!
!
access-list 10 permit 172.16.60.0 0.0.0.255
ip access-list standard INT-WEB
 permit 172.16.40.0 0.0.0.255
 permit 172.16.60.0 0.0.0.255
 remark allow Research and Production VLANs to reach www.int.com
!
!
!
line con 0
 exec-timeout 180 0
 password 7 0822455D0A16
 logging synchronous
 login
!
line aux 0
!
line vty 0 4
 access-class 10 in
 password 7 0822455D0A16
 login
line vty 5 15
 access-class 10 in
 password 7 0822455D0A16
 login
!
!
!
end
</pre></div>
</div>
</div>
</div>
<div class="section" id="ch7-qna">
<h2>Ch7 QnA<a class="headerlink" href="#ch7-qna" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>ACL:</dt>
<dd>a method of controlling packet flow</dd>
<dt>ACE:</dt>
<dd>one line in an ACL</dd>
<dt>Standard ACL:</dt>
<dd>IP-based ACLs that can be numbered 1 to 99</dd>
<dt>ip access-group:</dt>
<dd>a command that is used to apply a standard ACL to an interface</dd>
<dt>access-class:</dt>
<dd>a command that is used to apply a standard ACL to one or more VTY ports</dd>
<dt>goes to next ACE:</dt>
<dd>the action taken when the criteria specified in an ACE does not match</dd>
<dt>0.0.0.31:</dt>
<dd>wildcard mask for a /27 network</dd>
<dt>match the address bit value:</dt>
<dd>the purpose of a zero in a wildcard mask</dd>
<dt>closest to destination:</dt>
<dd>the common placement location for a standard ACL</dd>
<dt>one:</dt>
<dd>the number of IP-based ACLs that can be applied to one router interface in the inbound direction</dd>
<dt>easy to modify:</dt>
<dd>an advantage of using a named ACL</dd>
<dt>host:</dt>
<dd>the common keyword that is used when only one IP address is to be matched</dd>
<dt>any:</dt>
<dd>the keyword that is the same as using an address of 0.0.0.0 255.255.255.255</dd>
<dt>permit or deny:</dt>
<dd>the actions that can be taken when a router matches an address in an ACE</dd>
<dt>Which scenario would cause an ACL misconfiguration and deny all traffic?</dt>
<dd>Apply an ACL that has all deny ACE statements</dd>
<dt>Which type of standard ACL is easiest to modify on a production router?</dt>
<dd>A named ACL that has not been applied yet</dd>
<dt>Two common reasons for having a named ACL are</dt>
<dd>its function is easier to identify
the ACL is easier to modify</dd>
</dl>
<ul class="simple">
<li>ACLs can be used for the following:<ul>
<li>Limit network traffic in order to provide adequate network performance</li>
<li>Restrict the delivery of routing updates</li>
<li>Provide a basic level of security</li>
<li>Filter traffic based on the type of traffic being sent</li>
<li>Filter traffic based on IP addressing</li>
</ul>
</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">R1(config)#</span> <span class="pre">no</span> <span class="pre">access-list</span> <span class="pre">#</span></code> command removes the ACL from the running-config immediately. HOWEVER, to disable an ACL on an interface, the command <code class="docutils literal notranslate"><span class="pre">R1(config-if)#</span> <span class="pre">no</span> <span class="pre">ip</span> <span class="pre">access-group</span></code> should be entered.</p>
</div>
<img alt="../../../_images/Ch7_qna_1.png" src="../../../_images/Ch7_qna_1.png" />
<dl class="docutils">
<dt>If a router has two interfaces and is routing both IPv4 and IPv6 traffic, how many ACLs could be created and applied to it?</dt>
<dd>3P rule: 1 ACL per Protocol, 1 per Direction, 1 per Interface (PDI). In this case 2 interfaces x 2 protocols x 2 directions = 8</dd>
</dl>
<img alt="../../../_images/Ch7_qna_2.png" src="../../../_images/Ch7_qna_2.png" />
<img alt="../../../_images/Ch7_qna_3.png" src="../../../_images/Ch7_qna_3.png" />
<img alt="../../../_images/Ch7_qna_4.png" src="../../../_images/Ch7_qna_4.png" />
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dhcp.html" class="btn btn-neutral float-right" title="DHCP" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="vlans.html" class="btn btn-neutral" title="VLANS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Patrick Brunswyck.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'20171017',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>