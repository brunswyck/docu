

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>DHCP &mdash; debian &amp; networking 20170824 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="debian &amp; networking 20170824 documentation" href="../../../index.html"/>
        <link rel="up" title="Routing/Switching" href="../routing_n_switching.html"/>
        <link rel="next" title="NAT" href="nat.html"/>
        <link rel="prev" title="ACLs" href="acl.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> debian & networking
          

          
          </a>

          
            
            
              <div class="version">
                201708
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../routing_n_switching.html">Routing/Switching</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../routing_n_switching.html#basics">basics</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="connect2console.html">Connect to console</a></li>
<li class="toctree-l3"><a class="reference internal" href="routingConcepts.html">Routing Concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="staticRouting.html">Static Routes</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamicRouting.html">Dynamic Routing</a></li>
<li class="toctree-l3"><a class="reference internal" href="switchedNetworks.html">switched networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="switchConfiguration.html">Switch Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="vlans.html">VLANS</a></li>
<li class="toctree-l3"><a class="reference internal" href="acl.html">ACLs</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">DHCP</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dhcpv4-message-format">DHCPv4 Message Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dhcpv4-discover-message">DHCPv4 Discover Message</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dhcpv4-basic-server-configuration">DHCPv4 basic server configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#verifying-dhcpv4">Verifying DHCPv4</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configure-dhcpv4-relay">Configure DHCPv4 relay</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dhcpv4-exercises">DHCPv4 Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-a-router-as-dhcp-client">Configuring a Router as DHCP Client</a></li>
<li class="toctree-l4"><a class="reference internal" href="#troubleshooting-dhcp">Troubleshooting DHCP</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dhcpv4-troubleshooting-tasks">DHCPv4 Troubleshooting Tasks</a></li>
<li class="toctree-l4"><a class="reference internal" href="#slaac">SLAAC</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dhcpv6-operations">DHCPv6 Operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dhcpv6-stateless-config">DHCPv6 Stateless Config</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dhcpv6-stateless-client">DHCPv6 Stateless Client</a></li>
<li class="toctree-l4"><a class="reference internal" href="#verify-stateless-dhcpv6">Verify Stateless dhcpv6</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dhcpv6-stateful-config">DHCPv6 Stateful Config</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dhcpv6-stateful-client">DHCPv6 Stateful Client</a></li>
<li class="toctree-l4"><a class="reference internal" href="#verify-stateful-dhcpv6">Verify Stateful dhcpv6</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configure-dhcpv6-relay">Configure DHCPv6 relay</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dhcpv6-labs">DHCPv6 labs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dhcpv6-troubleshooting-tasks">DHCPv6 Troubleshooting Tasks</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ch8-lab-troubleshooting-dhcpv6">Ch8 Lab Troubleshooting DHCPv6</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ch8-8-3-1-2-skills-integration-challenge-dhcpv4">Ch8 8.3.1.2 Skills Integration Challenge DHCPv4</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dhcpv6-conclusion">DHCPv6 conclusion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ch8-qna">Ch8 QnA</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ch8-practice-exam">Ch8 practice exam</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="nat.html">NAT</a></li>
<li class="toctree-l3"><a class="reference internal" href="lldpAndLicensing.html">Device Discovery Management &amp; Maintenance</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../vim.html">VIM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../commands.html">BASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../git.html">GIT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripting.html">Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../storage/storage.html">Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rest.html">reStructuredText Primer</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">debian & networking</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../routing_n_switching.html">Routing/Switching</a> &raquo;</li>
        
      <li>DHCP</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/nw/rns/basics/dhcp.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dhcp">
<h1>DHCP<a class="headerlink" href="#dhcp" title="Permalink to this headline">Â¶</a></h1>
<p>The DHCPv4 server dynamically assigns, or leases, an IPv4 address from a pool of addresses for a limited period of time chosen by the server, or until the client no longer needs the address.</p>
<p>Clients lease the information from the server for an administratively defined period. Administrators configure DHCPv4 servers to set the leases to time out at different intervals. The lease is typically anywhere from 24 hours to a week or more. When the lease expires, the client must ask for another address, although the client is typically reassigned the same address.</p>
<p>Lease Origination</p>
<img alt="../../../_images/Ch8_dhcp4_lease_origination.png" src="../../../_images/Ch8_dhcp4_lease_origination.png" />
<p>When the client boots (or otherwise wants to join a network), it begins a four step process to obtain a lease. As shown in Figure 2, a client starts the process with a broadcast DHCPDISCOVER message with its own MAC address to discover available DHCPv4 servers.</p>
<p>DHCP Discover (DHCPDISCOVER)</p>
<p>The DHCPDISCOVER message finds DHCPv4 servers on the network. Because the client has no valid IPv4 information at bootup, it uses Layer 2 and Layer 3 broadcast addresses to communicate with the server.</p>
<p>DHCP Offer (DHCPOFFER)</p>
<p>When the DHCPv4 server receives a DHCPDISCOVER message, it reserves an available IPv4 address to lease to the client. The server also creates an ARP entry consisting of the MAC address of the requesting client and the leased IPv4 address of the client. As shown in Figure 3, the DHCPv4 server sends the binding DHCPOFFER message to the requesting client. The DHCPOFFER message is sent as a unicast, using the Layer 2 MAC address of the server as the source address and the Layer 2 MAC address of the client as the destination.</p>
<p>DHCP Request (DHCPREQUEST)</p>
<p>When the client receives the DHCPOFFER from the server, it sends back a DHCPREQUEST message as shown in Figure 4. This message is used for both lease origination and lease renewal. When used for lease origination, the DHCPREQUEST serves as a binding acceptance notice to the selected server for the parameters it has offered and an implicit decline to any other servers that may have provided the client a binding offer.</p>
<p>Many enterprise networks use multiple DHCPv4 servers. The DHCPREQUEST message is sent in the form of a broadcast to inform this DHCPv4 server and any other DHCPv4 servers about the accepted offer.</p>
<p>DHCP Acknowledgment (DHCPACK)</p>
<p>On receiving the DHCPREQUEST message, the server verifies the lease information with an ICMP ping to that address to ensure it is not being used already, creates a new ARP entry for the client lease, and replies with a unicast DHCPACK message as shown in Figure 5. The DHCPACK message is a duplicate of the DHCPOFFER, except for a change in the message type field. When the client receives the DHCPACK message, it logs the configuration information and performs an ARP lookup for the assigned address. If there is no reply to the ARP, the client knows that the IPv4 address is valid and starts using it as its own.</p>
<img alt="../../../_images/Ch8_dhcp4_lease_renewal.png" src="../../../_images/Ch8_dhcp4_lease_renewal.png" />
<p>Lease Renewal</p>
<p>DHCP Request (DHCPREQUEST)</p>
<p>As shown in Figure 6, before the lease expires, the client sends a DHCPREQUEST message directly to the DHCPv4 server that originally offered the IPv4 address. If a DHCPACK is not received within a specified amount of time, the client broadcasts another DHCPREQUEST so that one of the other DHCPv4 servers can extend the lease.</p>
<p>DHCP Acknowledgment (DHCPACK)</p>
<p>On receiving the DHCPREQUEST message, the server verifies the lease information by returning a DHCPACK, as shown in Figure.</p>
<div class="section" id="dhcpv4-message-format">
<h2>DHCPv4 Message Format<a class="headerlink" href="#dhcpv4-message-format" title="Permalink to this headline">Â¶</a></h2>
<img alt="../../../_images/Ch8_dhcp4_message_format.png" src="../../../_images/Ch8_dhcp4_message_format.png" />
<ul class="simple">
<li>Operation (OP) Code - Specifies the general type of message. A value of 1 indicates a request message; a value of 2 is a reply message.</li>
<li>Hardware Type - Identifies the type of hardware used in the network. For example, 1 is Ethernet, 15 is Frame Relay, and 20 is a serial line. These are the same codes used in ARP messages.</li>
<li>Hardware Address Length - Specifies the length of the address.</li>
<li>Hops - Controls the forwarding of messages. Set to 0 by a client before transmitting a request.</li>
<li>Transaction Identifier - Used by the client to match the request with replies received from DHCPv4 servers.</li>
<li>Seconds - Identifies the number of seconds elapsed since a client began attempting to acquire or renew a lease. Used by DHCPv4 servers to prioritize replies when multiple client requests are outstanding.</li>
<li>Flags - Used by a client that does not know its IPv4 address when it sends a request. Only one of the 16 bits is used, which is the broadcast flag. A value of 1 in this field tells the DHCPv4 server or relay agent receiving the request that the reply should be sent as a broadcast.</li>
<li>Client IP Address - Used by a client during lease renewal when the address of the client is valid and usable, not during the process of acquiring an address. The client puts its own IPv4 address in this field if and only if it has a valid IPv4 address while in the bound state; otherwise, it sets the field to 0.</li>
<li>Your IP Address - Used by the server to assign an IPv4 address to the client.</li>
<li>Server IP Address - Used by the server to identify the address of the server that the client should use for the next step in the bootstrap process, which may or may not be the server sending this reply. The sending server always includes its own IPv4 address in a special field called the Server Identifier DHCPv4 option.</li>
<li>Gateway IP Address - Routes DHCPv4 messages when DHCPv4 relay agents are involved. The gateway address facilitates communications of DHCPv4 requests and replies between the client and a server that are on different subnets or networks.</li>
<li>Client Hardware Address - Specifies the physical layer of the client.</li>
<li>Server Name - Used by the server sending a DHCPOFFER or DHCPACK message. The server may optionally put its name in this field. This can be a simple text nickname or a DNS domain name, such as dhcpserver.netacad.net.</li>
<li>Boot Filename - Optionally used by a client to request a particular type of boot file in a DHCPDISCOVER message. Used by a server in a DHCPOFFER to fully specify a boot file directory and filename.</li>
<li>DHCP Options - Holds DHCP options, including several parameters required for basic DHCP operation. This field is variable in length. Both client and server may use this field.</li>
</ul>
</div>
<div class="section" id="dhcpv4-discover-message">
<h2>DHCPv4 Discover Message<a class="headerlink" href="#dhcpv4-discover-message" title="Permalink to this headline">Â¶</a></h2>
<img alt="../../../_images/Ch8_dhcp4_discover_message.png" src="../../../_images/Ch8_dhcp4_discover_message.png" />
<p>As shown in Figure 1, the client IPv4 address (CIADDR), default gateway address (GIADDR), and subnet mask are all marked to indicate that the address 0.0.0.0 is used.</p>
<p>Note: Unknown information is sent as 0.0.0.0.</p>
<p>When the DHCPv4 server receives the DHCPDISCOVER message, it responds with a DHCPOFFER message. This message contains initial configuration information for the client, including the IPv4 address that the server offers, the subnet mask, the lease duration, and the IPv4 address of the DHCPv4 server making the offer.</p>
<p>The DHCPOFFER message can be configured to include other information, such as the lease renewal time and DNS address.</p>
<img alt="../../../_images/Ch8_dhcp4_offer_message.png" src="../../../_images/Ch8_dhcp4_offer_message.png" />
<p>As shown now, the DHCP server responds to the DHCPDISCOVER by assigning values to the CIADDR and subnet mask. The frame is constructed using the client hardware address (CHADDR) and sent to the requesting client.</p>
<p>The client and server send acknowledgment messages, and the process is complete.</p>
</div>
<div class="section" id="dhcpv4-basic-server-configuration">
<h2>DHCPv4 basic server configuration<a class="headerlink" href="#dhcpv4-basic-server-configuration" title="Permalink to this headline">Â¶</a></h2>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">step</span> <span class="mi">1</span> <span class="n">excluding</span> <span class="n">addresses</span>
<span class="o">--------------------------</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#ip dhcp excluded-address 192.168.10.1 192.168.10.9</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#ip dhcp excluded-address 192.168.10.254</span>

<span class="n">step</span> <span class="mi">2</span> <span class="n">configuring</span> <span class="n">a</span> <span class="n">pool</span>
<span class="o">-------------------------</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#ip dhcp pool LAN-POOL-1</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#</span>

<span class="n">step</span> <span class="mi">3</span> <span class="n">configuring</span> <span class="n">specific</span> <span class="n">tasks</span>
<span class="o">---------------------------------</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># network network-number [mask | /prefix-length]</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># network 192.168.10.0 255.255.255.0</span>

<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># default-router address address2...address8</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># default-router 192.168.10.1</span>

<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># dns-server address address2...address8</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># dns-server 192.168.11.5</span>

<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># domain-name example.com</span>

<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># lease {days [hours] [minutes] | infinite}</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#</span>

<span class="n">optional</span>
<span class="o">--------</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># netbios-name-server 192.168.x.x addr2..addr8</span>
</pre></div>
</div>
<p>disable DHCPv4 with the <code class="docutils literal"><span class="pre">no</span> <span class="pre">service</span> <span class="pre">dhcp</span></code> global config mode command</p>
</div>
<div class="section" id="verifying-dhcpv4">
<h2>Verifying DHCPv4<a class="headerlink" href="#verifying-dhcpv4" title="Permalink to this headline">Â¶</a></h2>
<p><code class="docutils literal"><span class="pre">show</span> <span class="pre">running-config</span> <span class="pre">|</span> <span class="pre">section</span> <span class="pre">dhcp</span></code></p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">Router</span><span class="o">&gt;</span> <span class="n">show</span> <span class="n">ip</span> <span class="n">dhcp</span> <span class="n">server</span> <span class="n">statistics</span>
<span class="o">--------------------------------------</span>
<span class="n">Memory</span> <span class="n">usage</span>          <span class="mi">40392</span>
<span class="n">Address</span> <span class="n">pools</span>         <span class="mi">3</span>
<span class="n">Database</span> <span class="n">agents</span>       <span class="mi">1</span>
<span class="n">Automatic</span> <span class="n">bindings</span>    <span class="mi">190</span>
<span class="n">Manual</span> <span class="n">bindings</span>       <span class="mi">1</span>
<span class="n">Expired</span> <span class="n">bindings</span>      <span class="mi">3</span>
<span class="n">Malformed</span> <span class="n">messages</span>    <span class="mi">0</span>

<span class="n">Message</span>               <span class="n">Received</span>
<span class="n">BOOTREQUEST</span>           <span class="mi">12</span>
<span class="n">DHCPDISCOVER</span>          <span class="mi">200</span>
<span class="n">DHCPREQUEST</span>           <span class="mi">178</span>
<span class="n">DHCPDECLINE</span>           <span class="mi">0</span>
<span class="n">DHCPRELEASE</span>           <span class="mi">0</span>
<span class="n">DHCPINFORM</span>            <span class="mi">0</span>

<span class="n">Message</span>               <span class="n">Sent</span>
<span class="n">BOOTREPLY</span>             <span class="mi">12</span>
<span class="n">DHCPOFFER</span>             <span class="mi">190</span>
<span class="n">DHCPACK</span>               <span class="mi">172</span>
<span class="n">DHCPNAK</span>               <span class="mi">6</span>
<span class="n">Release</span>

<span class="n">Router</span><span class="c1">#show ip dhcp binding</span>
<span class="o">---------------------------</span>
<span class="n">Bindings</span> <span class="kn">from</span> <span class="nn">all</span> <span class="n">pools</span> <span class="ow">not</span> <span class="n">associated</span> <span class="k">with</span> <span class="n">VRF</span><span class="p">:</span>
<span class="n">IP</span> <span class="n">address</span>   <span class="n">Client</span><span class="o">-</span><span class="n">ID</span><span class="o">/</span>    <span class="n">Lease</span> <span class="n">expiration</span>     <span class="n">Type</span>
             <span class="n">Hardware</span> <span class="n">address</span><span class="o">/</span>
             <span class="n">User</span> <span class="n">name</span>
<span class="mf">10.0</span><span class="o">.</span><span class="mf">2.1</span> <span class="mf">0100.1e68</span><span class="o">.</span><span class="n">ffd3</span><span class="o">.</span><span class="mi">5</span><span class="n">f</span> <span class="n">Oct</span> <span class="mi">12</span> <span class="mi">2016</span> <span class="mi">10</span><span class="p">:</span><span class="mi">08</span> <span class="n">PM</span> <span class="n">Automatic</span>

<span class="n">Router</span><span class="c1">#show ip dhcp pool</span>
<span class="o">------------------------</span>
<span class="n">Pool</span> <span class="n">dmz</span> <span class="p">:</span>
<span class="n">Utilization</span> <span class="n">mark</span> <span class="p">(</span><span class="n">high</span><span class="o">/</span><span class="n">low</span><span class="p">)</span> <span class="p">:</span> <span class="mi">100</span> <span class="o">/</span> <span class="mi">0</span>
<span class="n">Subnet</span> <span class="n">size</span> <span class="p">(</span><span class="n">first</span><span class="o">/</span><span class="nb">next</span><span class="p">)</span> <span class="p">:</span> <span class="mi">0</span> <span class="o">/</span> <span class="mi">0</span>
<span class="n">Total</span> <span class="n">addresses</span> <span class="p">:</span> <span class="mi">254</span>
<span class="n">Leased</span> <span class="n">addresses</span> <span class="p">:</span> <span class="mi">1</span>
<span class="n">Pending</span> <span class="n">event</span> <span class="p">:</span> <span class="n">none</span>
<span class="mi">1</span> <span class="n">subnet</span> <span class="ow">is</span> <span class="n">currently</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">pool</span> <span class="p">:</span>
<span class="n">Current</span> <span class="n">index</span> <span class="n">IP</span> <span class="n">address</span> <span class="nb">range</span> <span class="n">Leased</span> <span class="n">addresses</span>
<span class="mf">10.0</span><span class="o">.</span><span class="mf">2.2</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">2.1</span> <span class="o">-</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">2.254</span> <span class="mi">1</span>
</pre></div>
</div>
<p>show dhcp lease information on debian</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span>patrick@debian:~[brunswyck:docu.git master|!?]$ cat /var/lib/dhcp/dhclient.leases
lease {
  interface &quot;eno2&quot;;
  fixed-address 192.168.111.116;
  option subnet-mask 255.255.255.0;
  option routers 192.168.110.1;
  option dhcp-lease-time 7200;
  option dhcp-message-type 5;
  option domain-name-servers 208.67.222.222,208.67.220.220,8.8.8.8;
  option dhcp-server-identifier 192.168.111.1;
  option domain-name &quot;home&quot;;
  renew 3 2017/09/13 08:33:03;
  rebind 3 2017/09/13 09:23:03;
  expire 3 2017/09/13 09:38:03;
}
</pre></div>
</div>
</div>
<div class="section" id="configure-dhcpv4-relay">
<h2>Configure DHCPv4 relay<a class="headerlink" href="#configure-dhcpv4-relay" title="Permalink to this headline">Â¶</a></h2>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># interface g0/0</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ip helper-address 192.168.11.6</span>
<span class="n">confirm</span> <span class="k">with</span>
<span class="n">R1</span><span class="c1"># show ip interface g0/0</span>
<span class="o">...</span><span class="n">Helper</span> <span class="n">address</span> <span class="ow">is</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">11.6</span><span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="dhcpv4-exercises">
<h2>DHCPv4 Exercises<a class="headerlink" href="#dhcpv4-exercises" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="lab-configuring-basic-dhcpv4">
<h3>8.1.2.3 lab - configuring basic dhcpv4<a class="headerlink" href="#lab-configuring-basic-dhcpv4" title="Permalink to this headline">Â¶</a></h3>
<img alt="../../../_images/Ch8_lab_8.1.2.3_cfg_dhcpv4.png" src="../../../_images/Ch8_lab_8.1.2.3_cfg_dhcpv4.png" />
<p>Required Resources
+ 3 Routers (Cisco 1941 with Cisco IOS Release 15.2(4)M3 universal image or comparable)
+ 2 Switches (Cisco 2960 with Cisco IOS Release 15.0(2) lanbasek9 image or comparable)</p>
<p>R1 = relay agent</p>
<p>R2 = DHCPv4 server</p>
<p>you will configure a DHCP address pool for each of the R1 LANs. Use the pool name R1G0for the G0/0 LAN and R1G1for the G0/1 LAN.</p>
<p>You will also configure the addresses to be excluded from the address pools. Best practice dictates that excluded addresses be configured first, to guarantee that they are not accidentally leased to other devices.</p>
<p>Exclude the first 9 addresses in each R1 LAN starting with .1. All other addresses should be available in the DHCP address pool. Make sure that each DHCP address pool includes a default gateway, the domain ccna-lab.com, a DNS server (209.165.200.225), and a lease time of 2 days.</p>
<p>On the lines below, write the commands necessary for configuring DHCP services on router R2, including the DHCP-excluded addresses and the DHCP address pools.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="19%" />
<col width="23%" />
<col width="23%" />
<col width="23%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Device</th>
<th class="head">Interface</th>
<th class="head">IP Address</th>
<th class="head">Subnet Mask</th>
<th class="head">Default Gateway</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>R1</td>
<td>G0/0</td>
<td>192.168.0.1</td>
<td>255.255.255.0</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>G0/1</td>
<td>192.168.1.1</td>
<td>255.255.255.0</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>S0/0/0 (DCE)</td>
<td>192.168.2.253</td>
<td>255.255.255.252</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>R2</td>
<td>S0/0/0</td>
<td>192.168.2.254</td>
<td>255.255.255.252</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>S0/0/1 (DCE)</td>
<td>209.165.200.226</td>
<td>255.255.255.224</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>ISP</td>
<td>S0/0/1</td>
<td>209.165.200.225</td>
<td>255.255.255.224</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>PC-A</td>
<td>NIC</td>
<td>DHCP</td>
<td>DHCP</td>
<td>DHCP</td>
</tr>
<tr class="row-odd"><td>PC-B</td>
<td>NIC</td>
<td>DHCP</td>
<td>DHCP</td>
<td>DHCP</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">basic</span> <span class="n">config</span>
<span class="o">------------</span>
<span class="n">no</span> <span class="n">ip</span> <span class="n">domain</span><span class="o">-</span><span class="n">lookup</span>
<span class="n">service</span> <span class="n">password</span><span class="o">-</span><span class="n">encryption</span>
<span class="n">enable</span> <span class="n">secret</span> <span class="k">class</span>
<span class="nc">banner</span> <span class="n">motd</span> <span class="c1">#</span>
<span class="n">Unauthorized</span> <span class="n">access</span> <span class="ow">is</span> <span class="n">strictly</span> <span class="n">prohibited</span><span class="o">.</span> <span class="c1">#</span>
<span class="n">line</span> <span class="n">con</span> <span class="mi">0</span>
<span class="n">password</span> <span class="n">cisco</span>
<span class="n">login</span>
<span class="n">logging</span> <span class="n">synchronous</span>
<span class="n">line</span> <span class="n">vty</span> <span class="mi">0</span> <span class="mi">4</span>
<span class="n">password</span> <span class="n">cisco</span>
<span class="n">login</span>
</pre></div>
</div>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">Configure</span> <span class="n">RIPv2</span> <span class="k">for</span> <span class="n">R1</span>
<span class="o">----------------------</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># router rip</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1"># version 2</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1"># network 192.168.0.0</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1"># network 192.168.1.0</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1"># network 192.168.2.252</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1"># no auto-summary</span>

<span class="n">Configure</span> <span class="n">RIPv2</span> <span class="ow">and</span> <span class="n">a</span> <span class="n">default</span> <span class="n">route</span> <span class="n">to</span> <span class="n">the</span> <span class="n">ISP</span> <span class="n">on</span> <span class="n">R2</span>
<span class="o">----------------------------------------------------</span>
<span class="n">R2</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># router rip</span>
<span class="n">R2</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1"># version 2</span>
<span class="n">R2</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1"># network 192.168.2.252</span>
<span class="n">R2</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1"># default-information originate</span>
<span class="n">R2</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">router</span><span class="p">)</span><span class="c1"># exit</span>
<span class="n">R2</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># ip route 0.0.0.0 0.0.0.0 209.165.200.225</span>

<span class="n">Configure</span>  <span class="n">a</span> <span class="n">summary</span> <span class="n">static</span> <span class="n">route</span> <span class="n">on</span> <span class="n">ISP</span> <span class="n">to</span> <span class="n">reach</span> <span class="n">the</span> <span class="n">networks</span> <span class="n">on</span> <span class="n">the</span> <span class="n">R1</span> <span class="ow">and</span> <span class="n">R2</span> <span class="n">routers</span>
<span class="o">---------------------------------------------------------------------------------------</span>
<span class="n">ISP</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># ip route 192.168.0.0 255.255.252.0 209.165.200.226</span>

<span class="n">Router</span> <span class="n">R1</span> <span class="k">as</span> <span class="n">a</span> <span class="n">DHCP</span> <span class="n">relay</span> <span class="n">agent</span>
<span class="o">-------------------------------</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># interface g0/0</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ip helper-address 192.168.2.254</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># exit</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># interface g0/1</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ip helper-address 192.168.2.254</span>

<span class="n">Router</span> <span class="n">R2</span>
<span class="o">---------</span>
<span class="n">R2</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># ip dhcp excluded-address 192.168.0.1 192.168.0.9</span>
<span class="n">R2</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># ip dhcp excluded-address 192.168.1.1 192.168.1.9</span>
<span class="n">R2</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># ip dhcp pool R1G1</span>
<span class="n">R2</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># network 192.168.1.0 255.255.255.0</span>
<span class="n">R2</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># default-router 192.168.1.1</span>
<span class="n">R2</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># dns-server 209.165.200.225</span>
<span class="n">R2</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># domain-name ccna-lab.com</span>
<span class="n">R2</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># lease 2</span>
<span class="n">R2</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># exit</span>
<span class="n">R2</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># ip dhcp pool R1G0</span>
<span class="n">R2</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># network 192.168.0.0 255.255.255.0</span>
<span class="n">R2</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># default-router 192.168.0.1</span>
<span class="n">R2</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># dns-server 209.165.200.225</span>
<span class="n">R2</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># domain-name ccna-lab.com</span>
<span class="n">R2</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># lease 2</span>
</pre></div>
</div>
<p>verify with <code class="docutils literal"><span class="pre">show</span> <span class="pre">ip</span> <span class="pre">dhcp</span> <span class="pre">binding</span></code> &amp; <code class="docutils literal"><span class="pre">show</span> <span class="pre">ip</span> <span class="pre">dhcp</span> <span class="pre">server</span> <span class="pre">statistics</span></code> &amp; <code class="docutils literal"><span class="pre">show</span> <span class="pre">run</span> <span class="pre">|</span> <span class="pre">section</span> <span class="pre">dhcp</span></code></p>
</div>
<div class="section" id="lab-basic-dhcpv4-on-a-switch">
<h3>8.1.2.5 lab - basic dhcpv4 on a switch<a class="headerlink" href="#lab-basic-dhcpv4-on-a-switch" title="Permalink to this headline">Â¶</a></h3>
<img alt="../../../_images/Ch8_lab_8.1.2.5_cfg_dhcpv4_on_switch.png" src="../../../_images/Ch8_lab_8.1.2.5_cfg_dhcpv4_on_switch.png" />
<p>Required Resources
+ Router (Cisco 1941 with Cisco IOS Release 15.2(4)M3 universal image or comparable)
+ 2 Switches (Cisco 2960 with Cisco IOS Release 15.0(2) lanbasek9 image or comparable)</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="21%" />
<col width="32%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Device</th>
<th class="head">Interface</th>
<th class="head">IP Address</th>
<th class="head">Subnet Mask</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>R1</td>
<td>G0/1</td>
<td>192.168.1.10</td>
<td>255.255.255.0</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>Lo0</td>
<td>209.165.200.225</td>
<td>255.255.255.224</td>
</tr>
<tr class="row-even"><td>S1</td>
<td>VLAN 1</td>
<td>192.168.1.1</td>
<td>255.255.255.0</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>VLAN 2</td>
<td>192.168.2.1</td>
<td>255.255.255.0</td>
</tr>
</tbody>
</table>
<p>display SDM preference on S1</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">S1</span><span class="c1">#show sdm prefer</span>
<span class="n">The</span> <span class="n">current</span> <span class="n">template</span> <span class="ow">is</span> <span class="s2">&quot;default&quot;</span> <span class="n">template</span><span class="o">.</span>
<span class="n">The</span> <span class="n">selected</span> <span class="n">template</span> <span class="n">optimizes</span> <span class="n">the</span> <span class="n">resources</span> <span class="ow">in</span>
<span class="n">the</span> <span class="n">switch</span> <span class="n">to</span> <span class="n">support</span> <span class="n">this</span> <span class="n">level</span> <span class="n">of</span> <span class="n">features</span> <span class="k">for</span>
<span class="mi">0</span> <span class="n">routed</span> <span class="n">interfaces</span> <span class="ow">and</span> <span class="mi">255</span> <span class="n">VLANs</span><span class="o">.</span>
  <span class="n">number</span> <span class="n">of</span> <span class="n">unicast</span> <span class="n">mac</span> <span class="n">addresses</span><span class="p">:</span>                  <span class="mi">8</span><span class="n">K</span>
  <span class="n">number</span> <span class="n">of</span> <span class="n">IPv4</span> <span class="n">IGMP</span> <span class="n">groups</span><span class="p">:</span>                       <span class="mf">0.25</span><span class="n">K</span>
  <span class="n">number</span> <span class="n">of</span> <span class="n">IPv4</span><span class="o">/</span><span class="n">MAC</span> <span class="n">qos</span> <span class="n">aces</span><span class="p">:</span>                      <span class="mf">0.125</span><span class="n">k</span>
  <span class="n">number</span> <span class="n">of</span> <span class="n">IPv4</span><span class="o">/</span><span class="n">MAC</span> <span class="n">security</span> <span class="n">aces</span><span class="p">:</span>                 <span class="mf">0.375</span><span class="n">k</span>
</pre></div>
</div>
<p>change SDM preference to lanbase-routing</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">S1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># sdm prefer lanbase-routing</span>
<span class="n">Changes</span> <span class="n">to</span> <span class="n">the</span> <span class="n">running</span> <span class="n">SDM</span> <span class="n">preferences</span> <span class="n">have</span> <span class="n">been</span> <span class="n">stored</span><span class="p">,</span> <span class="n">but</span> <span class="n">cannot</span> <span class="n">take</span> <span class="n">effect</span>
<span class="n">until</span> <span class="n">the</span> <span class="nb">next</span> <span class="n">reload</span><span class="o">.</span>
<span class="n">Use</span> <span class="s1">&#39;show sdm prefer&#39;</span> <span class="n">to</span> <span class="n">see</span> <span class="n">what</span> <span class="n">SDM</span> <span class="n">preference</span> <span class="ow">is</span> <span class="n">currently</span> <span class="n">active</span><span class="o">.</span>

<span class="n">S1</span><span class="c1"># reload</span>
<span class="n">S1</span><span class="c1"># show sdm prefer</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The new template will be used after reboot even if the running configuration has not been saved. To save the running configuration, answer yes after reload command.</p>
</div>
<div class="section" id="configure-dhcp-for-vlan-1">
<h4>Configure DHCP for VLAN 1<a class="headerlink" href="#configure-dhcp-for-vlan-1" title="Permalink to this headline">Â¶</a></h4>
<ol class="loweralpha simple">
<li>Exclude the first 10 valid host addresses from network 192.168.1.0/24</li>
<li>Create a DHCP pool named DHCP1</li>
<li>Assign the network 192.168.1.0/24 for available addresses</li>
<li>Assign the default gateway as 192.168.1.1</li>
<li>Assign the DNS server as 192.168.1.9</li>
<li>Assign a lease time of 3 day</li>
<li>Save the running configuration to the startup configuration file</li>
</ol>
</div>
<div class="section" id="configure-dhcpv4-for-multiple-vlans">
<h4>Configure DHCPv4 for Multiple VLANs<a class="headerlink" href="#configure-dhcpv4-for-multiple-vlans" title="Permalink to this headline">Â¶</a></h4>
<p>assign PC-A to a port accessing VLAN 2, configure DHCPv4 for VLAN 2, renew the IP configuration of PC-A to validate DHCPv4, and verify connectivity within the VLAN.</p>
<p>Assign a port to VLAN 2. Place port F0/6 into VLAN 2</p>
<ol class="loweralpha simple">
<li>Exclude the first 10 valid host addresses from network 192.168.2.0</li>
<li>Create a DHCP pool named DHCP2</li>
<li>Assign the network 192.168.2.0/24 for available addresses</li>
<li>Assign the default gateway as 192.168.2.1</li>
<li>Assign the DNS server as 192.168.2.9</li>
<li>Assign a lease time of 3 days</li>
<li>Save the running configuration to the startup configuration file</li>
</ol>
<p>Enable IP routing on S1 <code class="docutils literal"><span class="pre">S1(config)#</span> <span class="pre">ip</span> <span class="pre">routing</span></code>
Verify inter-VLAN connectivity</p>
</div>
<div class="section" id="assign-static-routes">
<h4>Assign static routes<a class="headerlink" href="#assign-static-routes" title="Permalink to this headline">Â¶</a></h4>
<ol class="loweralpha simple">
<li>On S1, create a default static route to R1</li>
<li>On R1, create a static route to VLAN 2</li>
<li>View the routing table information for S1.How is the default static route represented?</li>
<li>View the routing table information for R1.How is the default static route represented?</li>
<li>From PC-A, is it possible to ping R1? From PC-A, is it possible to ping Lo0?</li>
</ol>
<p>Configure DHCPv4</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">S1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># ip dhcp excluded-address 192.168.1.1 192.168.1.10</span>
<span class="n">S1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># ip dhcp pool DHCP1</span>
<span class="n">S1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># network 192.168.1.0 255.255.255.0</span>
<span class="n">S1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># default-router 192.168.1.1</span>
<span class="n">S1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># dns-server 192.168.1.9</span>
<span class="n">S1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># lease 3</span>
</pre></div>
</div>
<p>Configure DHCPv4 for Multiple VLANs</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">S1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># interface f0/6</span>
<span class="n">S1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># switchport access vlan 2</span>
<span class="n">S1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># ip dhcp excluded-address 192.168.2.1 192.168.2.10</span>
<span class="n">S1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># ip dhcp pool DHCP2</span>
<span class="n">S1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># network 192.168.2.0 255.255.255.0</span>
<span class="n">S1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># default-router 192.168.2.1</span>
<span class="n">S1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># dns-server 192.168.2.9</span>
<span class="n">S1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># lease 3</span>
</pre></div>
</div>
<p>Enable IP Routing</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">S1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># ip routing</span>
<span class="n">S1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># ip route 0.0.0.0 0.0.0.0 192.168.1.10</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># ip route 192.168.2.0 255.255.255.0 g0/1</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="lab-configuring-dhcp-ios-pt">
<h3>8.1.3.3 lab - configuring dhcp ios pt<a class="headerlink" href="#lab-configuring-dhcp-ios-pt" title="Permalink to this headline">Â¶</a></h3>
<img alt="../../../_images/Ch8_lab_8.1.3.3_cfg_dhcpv4_ios.png" src="../../../_images/Ch8_lab_8.1.3.3_cfg_dhcpv4_ios.png" />
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="15%" />
<col width="22%" />
<col width="23%" />
<col width="23%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Device</th>
<th class="head">Interface</th>
<th class="head">IPv4 Address</th>
<th class="head">Subnet Mask</th>
<th class="head">Default Gateway</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>R1</td>
<td>G0/0</td>
<td>192.168.10.1</td>
<td>255.255.255.0</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>S0/0/0</td>
<td>10.1.1.1</td>
<td>255.255.255.252</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>R2</td>
<td>G0/0</td>
<td>192.168.20.1</td>
<td>255.255.255.0</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>G0/1</td>
<td>DHCP Assigned</td>
<td>DHCP Assigned</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>S0/0/0</td>
<td>10.1.1.2</td>
<td>255.255.255.252</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>S0/0/1</td>
<td>10.2.2.2</td>
<td>255.255.255.252</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>R3</td>
<td>G0/0</td>
<td>192.168.30.1</td>
<td>255.255.255.0</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>S0/0/1</td>
<td>10.2.2.1</td>
<td>255.255.255.0</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>PC1</td>
<td>NIC</td>
<td>DHCP Assigned</td>
<td>DHCP Assigned</td>
<td>DHCP Assigned</td>
</tr>
<tr class="row-odd"><td>PC2</td>
<td>NIC</td>
<td>DHCP Assigned</td>
<td>DHCP Assigned</td>
<td>DHCP Assigned</td>
</tr>
<tr class="row-even"><td>DNS Server</td>
<td>NIC</td>
<td>192.168.20.254</td>
<td>255.255.255.0</td>
<td>192.168.20.1</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Configure R2 to exclude first 10 addresses from R1 and R3 LANs. All others should be available in the DHCP address pool</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R2</span><span class="o">&gt;</span><span class="n">enable</span>
<span class="n">R2</span><span class="c1">#conf t</span>
<span class="n">R2</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#ip dhcp ?</span>
 <span class="n">excluded</span><span class="o">-</span><span class="n">address</span>  <span class="n">Prevent</span> <span class="n">DHCP</span> <span class="kn">from</span> <span class="nn">assigning</span> <span class="n">certain</span> <span class="n">addresses</span>
 <span class="n">pool</span>              <span class="n">Configure</span> <span class="n">DHCP</span> <span class="n">address</span> <span class="n">pools</span>
 <span class="n">relay</span>             <span class="n">DHCP</span> <span class="n">relay</span> <span class="n">agent</span> <span class="n">parameters</span>
<span class="n">R2</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#ip dhcp excluded-address 192.168.10.1 192.168.10.10</span>
<span class="n">R2</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#ip dhcp excluded-address 192.168.30.1 192.168.30.10</span>
<span class="n">R2</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#ip dhcp pool R1-LAN</span>
<span class="n">R2</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#network 192.168.10.0 255.255.255.0</span>
<span class="n">R2</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#?</span>
 <span class="n">default</span><span class="o">-</span><span class="n">router</span>  <span class="n">Default</span> <span class="n">routers</span>
 <span class="n">dns</span><span class="o">-</span><span class="n">server</span>      <span class="n">Set</span> <span class="n">name</span> <span class="n">server</span>
 <span class="n">exit</span>            <span class="n">Exit</span> <span class="kn">from</span> <span class="nn">DHCP</span> <span class="n">pool</span> <span class="n">configuration</span> <span class="n">mode</span>
 <span class="n">network</span>         <span class="n">Network</span> <span class="n">number</span> <span class="ow">and</span> <span class="n">mask</span>
 <span class="n">no</span>              <span class="n">Negate</span> <span class="n">a</span> <span class="n">command</span> <span class="ow">or</span> <span class="nb">set</span> <span class="n">its</span> <span class="n">defaults</span>
 <span class="n">option</span>          <span class="n">Raw</span> <span class="n">DHCP</span> <span class="n">options</span>
<span class="n">R2</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#default-router 192.168.10.1</span>
<span class="n">R2</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#dns-server 192.168.20.254</span>
<span class="n">R2</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#ip dhcp pool R3-LAN</span>
<span class="n">R2</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#network 192.168.30.0 255.255.255.0</span>
<span class="n">R2</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#defautl</span>
<span class="n">R2</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#default-router 192.168.30.1</span>
<span class="n">R2</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#dns-server 192.168.20.254</span>
</pre></div>
</div>
</li>
<li><p class="first">Set PC1 and PC2 to receive IP addressing information from DHCP.</p>
</li>
<li><p class="first">Configure R1 and R3 as a DHCP relay agent.
Okay so lets check if R2 can reach these LANs first:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span>check interfaces
----------------
R2#show ip int brief
Interface              IP-Address      OK? Method Status                Protocol
GigabitEthernet0/0     192.168.20.1    YES manual up                    up
GigabitEthernet0/1     unassigned      YES unset  administratively down down
Serial0/0/0            10.1.1.2        YES manual up                    up
Serial0/0/1            10.2.2.2        YES manual up                    up
Serial0/1/0            unassigned      YES unset  down                  down
Serial0/1/1            unassigned      YES unset  down                  down
Vlan1                  unassigned      YES unset  administratively down down

G0/1 is down, lets give it a dhcp address from ISP
--------------------------------------------------
R2#conf t
R2(config)#interface gigabitEthernet 0/1
R2(config-if)#ip address dhcp
R2(config-if)#no shutdown
R2(config-if)#
%LINK-5-CHANGED: Interface GigabitEthernet0/1, changed state to up
%LINEPROTO-5-UPDOWN: Line protocol on Interface GigabitEthernet0/1, changed state to up
R2#
%DHCP-6-ADDRESS_ASSIGN: Interface GigabitEthernet0/1 assigned DHCP address 209.165.200.231, mask 255.255.255.224, hostname R2
%DUAL-5-NBRCHANGE: IP-EIGRP 1: Neighbor 209.165.200.225 (GigabitEthernet0/1) is up: new adjacency

Now lets check R1 and R2 routes to LAN are known to R2
------------------------------------------------------
R2#show ip route
Codes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP
       D - EIGRP, EX - EIGRP external, O - OSPF, IA - OSPF inter area
       N1 - OSPF NSSA external type 1, N2 - OSPF NSSA external type 2
       E1 - OSPF external type 1, E2 - OSPF external type 2, E - EGP
       i - IS-IS, L1 - IS-IS level-1, L2 - IS-IS level-2, ia - IS-IS inter area
       * - candidate default, U - per-user static route, o - ODR
       P - periodic downloaded static route

Gateway of last resort is not set

     10.0.0.0/8 is variably subnetted, 4 subnets, 2 masks
C       10.1.1.0/30 is directly connected, Serial0/0/0
L       10.1.1.2/32 is directly connected, Serial0/0/0
C       10.2.2.0/30 is directly connected, Serial0/0/1
L       10.2.2.2/32 is directly connected, Serial0/0/1
D    192.168.10.0/24 [90/2170112] via 10.1.1.1, 00:59:31, Serial0/0/0
     192.168.20.0/24 is variably subnetted, 2 subnets, 2 masks
C       192.168.20.0/24 is directly connected, GigabitEthernet0/0
L       192.168.20.1/32 is directly connected, GigabitEthernet0/0
D    192.168.30.0/24 [90/2170112] via 10.2.2.1, 00:59:32, Serial0/0/1
     209.165.200.0/24 is variably subnetted, 2 subnets, 2 masks
C       209.165.200.224/27 is directly connected, GigabitEthernet0/1
L       209.165.200.231/32 is directly connected, GigabitEthernet0/1
     209.165.202.0/27 is subnetted, 1 subnets
D       209.165.202.128/27 [90/3072] via 209.165.200.225, 00:01:10, GigabitEthernet0/1

Looking good, configure R1 and R3 as dhcpv4 relay agents
--------------------------------------------------------
R1(config)#interface gigabitEthernet 0/0
R1(config-if)#ip helper-address 10.1.1.2

R3(config)#do show ip int brief | include 192.168.30
GigabitEthernet0/0     192.168.30.1    YES manual up                    up
R3(config)#interface GigabitEthernet0/0
R3(config-if)#ip helper-address 10.2.2.2
</pre></div>
</div>
</li>
<li><p class="first">Verify DHCP</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R2</span><span class="c1">#show ip dhcp binding</span>
<span class="o">-----------------------</span>
<span class="n">IP</span> <span class="n">address</span>       <span class="n">Client</span><span class="o">-</span><span class="n">ID</span><span class="o">/</span>              <span class="n">Lease</span> <span class="n">expiration</span>        <span class="n">Type</span>
                 <span class="n">Hardware</span> <span class="n">address</span>
<span class="mf">192.168</span><span class="o">.</span><span class="mf">10.11</span>    <span class="mf">0002.4</span><span class="n">AA5</span><span class="o">.</span><span class="mi">1470</span>           <span class="o">--</span>                     <span class="n">Automatic</span>
<span class="mf">192.168</span><span class="o">.</span><span class="mf">30.11</span>    <span class="mf">0004.9</span><span class="n">A97</span><span class="o">.</span><span class="mi">2535</span>           <span class="o">--</span>                     <span class="n">Automatic</span>
<span class="n">R2</span><span class="c1">#</span>

<span class="n">R2</span><span class="c1">#show ip dhcp pool</span>
<span class="o">--------------------</span>
<span class="n">Pool</span> <span class="n">R1</span><span class="o">-</span><span class="n">LAN</span> <span class="p">:</span>
 <span class="n">Utilization</span> <span class="n">mark</span> <span class="p">(</span><span class="n">high</span><span class="o">/</span><span class="n">low</span><span class="p">)</span>    <span class="p">:</span> <span class="mi">100</span> <span class="o">/</span> <span class="mi">0</span>
 <span class="n">Subnet</span> <span class="n">size</span> <span class="p">(</span><span class="n">first</span><span class="o">/</span><span class="nb">next</span><span class="p">)</span>       <span class="p">:</span> <span class="mi">0</span> <span class="o">/</span> <span class="mi">0</span>
 <span class="n">Total</span> <span class="n">addresses</span>                <span class="p">:</span> <span class="mi">254</span>
 <span class="n">Leased</span> <span class="n">addresses</span>               <span class="p">:</span> <span class="mi">1</span>
 <span class="n">Excluded</span> <span class="n">addresses</span>             <span class="p">:</span> <span class="mi">2</span>
 <span class="n">Pending</span> <span class="n">event</span>                  <span class="p">:</span> <span class="n">none</span>

 <span class="mi">1</span> <span class="n">subnet</span> <span class="ow">is</span> <span class="n">currently</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">pool</span>
 <span class="n">Current</span> <span class="n">index</span>        <span class="n">IP</span> <span class="n">address</span> <span class="nb">range</span>                    <span class="n">Leased</span><span class="o">/</span><span class="n">Excluded</span><span class="o">/</span><span class="n">Total</span>
 <span class="mf">192.168</span><span class="o">.</span><span class="mf">10.1</span>         <span class="mf">192.168</span><span class="o">.</span><span class="mf">10.1</span>     <span class="o">-</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">10.254</span>    <span class="mi">1</span>    <span class="o">/</span> <span class="mi">2</span>     <span class="o">/</span> <span class="mi">254</span>

<span class="n">Pool</span> <span class="n">R3</span><span class="o">-</span><span class="n">LAN</span> <span class="p">:</span>
 <span class="n">Utilization</span> <span class="n">mark</span> <span class="p">(</span><span class="n">high</span><span class="o">/</span><span class="n">low</span><span class="p">)</span>    <span class="p">:</span> <span class="mi">100</span> <span class="o">/</span> <span class="mi">0</span>
 <span class="n">Subnet</span> <span class="n">size</span> <span class="p">(</span><span class="n">first</span><span class="o">/</span><span class="nb">next</span><span class="p">)</span>       <span class="p">:</span> <span class="mi">0</span> <span class="o">/</span> <span class="mi">0</span>
 <span class="n">Total</span> <span class="n">addresses</span>                <span class="p">:</span> <span class="mi">254</span>
 <span class="n">Leased</span> <span class="n">addresses</span>               <span class="p">:</span> <span class="mi">1</span>
 <span class="n">Excluded</span> <span class="n">addresses</span>             <span class="p">:</span> <span class="mi">2</span>
 <span class="n">Pending</span> <span class="n">event</span>                  <span class="p">:</span> <span class="n">none</span>

 <span class="mi">1</span> <span class="n">subnet</span> <span class="ow">is</span> <span class="n">currently</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">pool</span>
 <span class="n">Current</span> <span class="n">index</span>        <span class="n">IP</span> <span class="n">address</span> <span class="nb">range</span>                    <span class="n">Leased</span><span class="o">/</span><span class="n">Excluded</span><span class="o">/</span><span class="n">Total</span>
 <span class="mf">192.168</span><span class="o">.</span><span class="mf">30.1</span>         <span class="mf">192.168</span><span class="o">.</span><span class="mf">30.1</span>     <span class="o">-</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">30.254</span>    <span class="mi">1</span>    <span class="o">/</span> <span class="mi">2</span>     <span class="o">/</span> <span class="mi">254</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="configuring-a-router-as-dhcp-client">
<h2>Configuring a Router as DHCP Client<a class="headerlink" href="#configuring-a-router-as-dhcp-client" title="Permalink to this headline">Â¶</a></h2>
<p>To configure an Ethernet interface as a DHCP client, use the <code class="docutils literal"><span class="pre">ip</span> <span class="pre">address</span> <span class="pre">dhcp</span></code> interface configuration mode command.</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">SOHO</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># interface g0/1</span>
<span class="n">SOHO</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ip address dhcp</span>
<span class="n">SOHO</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># no shutdown</span>
<span class="n">SOHO</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1">#</span>
 <span class="o">%</span><span class="n">DHCP</span><span class="o">-</span><span class="mi">6</span><span class="o">-</span><span class="n">ADDRESS_ASSIGN</span><span class="p">:</span> <span class="n">Interface</span> <span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mi">1</span> <span class="n">assigned</span> <span class="n">DHCP</span> <span class="n">address</span> <span class="mf">209.165</span><span class="o">.</span><span class="mf">201.12</span><span class="p">,</span> <span class="n">mask</span> <span class="mf">255.255</span><span class="o">.</span><span class="mf">255.224</span><span class="p">,</span> <span class="n">hostname</span> <span class="n">SOHO</span>
<span class="n">SOHO</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># end</span>
<span class="n">SOHO</span><span class="c1"># show ip interface g0/1</span>
<span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mi">1</span> <span class="ow">is</span> <span class="n">up</span><span class="p">,</span> <span class="n">line</span> <span class="n">protocol</span> <span class="ow">is</span> <span class="n">up</span>
  <span class="n">Internet</span> <span class="n">address</span> <span class="ow">is</span> <span class="mf">209.165</span><span class="o">.</span><span class="mf">201.12</span><span class="o">/</span><span class="mi">27</span>
  <span class="n">Broadcast</span> <span class="n">address</span> <span class="ow">is</span> <span class="mf">255.255</span><span class="o">.</span><span class="mf">255.255</span>
  <span class="n">Address</span> <span class="n">determined</span> <span class="n">by</span> <span class="n">DHCP</span>
</pre></div>
</div>
</div>
<div class="section" id="troubleshooting-dhcp">
<h2>Troubleshooting DHCP<a class="headerlink" href="#troubleshooting-dhcp" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="dhcp-service">
<h3>DHCP Service<a class="headerlink" href="#dhcp-service" title="Permalink to this headline">Â¶</a></h3>
<img alt="../../../_images/dhcp-client-server-cisco-routers.png" src="../../../_images/dhcp-client-server-cisco-routers.png" />
<p>Letâs verify by checking if the interfaces are up and running:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span>DHCPClient#show ip interface brief
Interface                  IP-Address      OK? Method Status                Protocol
FastEthernet0/0            unassigned      YES DHCP   up                   up
</pre></div>
</div>
<p>First Iâll verify if the interface on the DHCP client is up/up and that it has been configured for DHCP, this is indeed the case. Letâs check the DHCP server:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span>DHCPServer#show ip interface brief
Interface                  IP-Address      OK? Method Status                Protocol
FastEthernet0/0            192.168.12.2    YES manual up                   up
</pre></div>
</div>
<p>I also want to make sure the interface on the DHCP server is up/up and that it has an IP address. This looks fine to me. Letâs start by looking at the DHCP client:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">DHCPClient</span><span class="c1">#debug dhcp detail</span>
<span class="n">DHCP</span> <span class="n">client</span> <span class="n">activity</span> <span class="n">debugging</span> <span class="ow">is</span> <span class="n">on</span> <span class="p">(</span><span class="n">detailed</span><span class="p">)</span>
</pre></div>
</div>
<p>I want to be absolutely sure that the client is not the issue I can enable debug dhcp detail to see if the DHCP client is sending DHCP discover messages. Hereâs what we see:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">DHCPClient</span><span class="c1"># Hostname: DHCPClient</span>
<span class="n">DHCP</span><span class="p">:</span> <span class="n">new</span> <span class="n">entry</span><span class="o">.</span> <span class="n">add</span> <span class="n">to</span> <span class="n">queue</span><span class="p">,</span> <span class="n">interface</span> <span class="n">FastEthernet0</span><span class="o">/</span><span class="mi">0</span>
<span class="s1">&#39;DHCP: SDiscover attempt # 1 for entry:&#39;</span>
<span class="n">Temp</span> <span class="n">IP</span> <span class="n">addr</span><span class="p">:</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span>  <span class="k">for</span> <span class="n">peer</span> <span class="n">on</span> <span class="n">Interface</span><span class="p">:</span> <span class="n">FastEthernet0</span><span class="o">/</span><span class="mi">0</span>
<span class="n">Temp</span>  <span class="n">sub</span> <span class="n">net</span> <span class="n">mask</span><span class="p">:</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span>
<span class="n">DHCP</span> <span class="n">Lease</span> <span class="n">server</span><span class="p">:</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="mi">1</span> <span class="n">Selecting</span>
<span class="n">DHCP</span> <span class="n">transaction</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">289</span>
<span class="n">Lease</span><span class="p">:</span> <span class="mi">0</span> <span class="n">secs</span><span class="p">,</span>  <span class="n">Renewal</span><span class="p">:</span> <span class="mi">0</span> <span class="n">secs</span><span class="p">,</span>  <span class="n">Rebind</span><span class="p">:</span> <span class="mi">0</span> <span class="n">secs</span>
<span class="n">Next</span> <span class="n">timer</span> <span class="n">fires</span> <span class="n">after</span><span class="p">:</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">04</span>
<span class="n">Retry</span> <span class="n">count</span><span class="p">:</span> <span class="mi">1</span>   <span class="n">Client</span><span class="o">-</span><span class="n">ID</span><span class="p">:</span> <span class="n">cisco</span><span class="o">-</span><span class="n">cc00</span><span class="o">.</span><span class="mi">1</span><span class="n">ab0</span><span class="o">.</span><span class="mi">0000</span><span class="o">-</span><span class="n">Fa0</span><span class="o">/</span><span class="mi">0</span>
<span class="n">Client</span><span class="o">-</span><span class="n">ID</span> <span class="nb">hex</span> <span class="n">dump</span><span class="p">:</span> <span class="mi">636973636</span><span class="n">F2D636330302E316162302E</span>
                    <span class="mi">303030302</span><span class="n">D4661302F30</span>
</pre></div>
</div>
<p>Youâll see some debug output like above. This proves that my DHCP client is sending DHCP Discover messages; the client doesnât seem to be the problem here. Letâs check the DHCP server:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">DHCPServer</span><span class="c1">#show ip dhcp pool</span>

<span class="n">Pool</span> <span class="n">MYPOOL</span> <span class="p">:</span>
 <span class="n">Utilization</span> <span class="n">mark</span> <span class="p">(</span><span class="n">high</span><span class="o">/</span><span class="n">low</span><span class="p">)</span>    <span class="p">:</span> <span class="mi">100</span> <span class="o">/</span> <span class="mi">0</span>
 <span class="n">Subnet</span> <span class="n">size</span> <span class="p">(</span><span class="n">first</span><span class="o">/</span><span class="nb">next</span><span class="p">)</span>       <span class="p">:</span> <span class="mi">0</span> <span class="o">/</span> <span class="mi">0</span>
 <span class="n">Total</span> <span class="n">addresses</span>                <span class="p">:</span> <span class="mi">254</span>
 <span class="n">Leased</span> <span class="n">addresses</span>               <span class="p">:</span> <span class="mi">0</span>
 <span class="n">Pending</span> <span class="n">event</span>                  <span class="p">:</span> <span class="n">none</span>
 <span class="mi">1</span> <span class="n">subnet</span> <span class="ow">is</span> <span class="n">currently</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">pool</span> <span class="p">:</span>
 <span class="n">Current</span> <span class="n">index</span>        <span class="n">IP</span> <span class="n">address</span> <span class="nb">range</span>                    <span class="n">Leased</span> <span class="n">addresses</span>
 <span class="mf">192.168</span><span class="o">.</span><span class="mf">12.1</span>         <span class="mf">192.168</span><span class="o">.</span><span class="mf">12.1</span>     <span class="o">-</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">12.254</span>    <span class="mi">0</span>
</pre></div>
</div>
<p>Weâll use the show ip dhcp pool command to check if there is a DHCP pool. You can see that we do have a DHCP pool called âMYPOOLâ and itâs configured for the 192.168.12.0 /24 subnet. This is looking fine to me. Letâs find out if the DHCP server is doing anything:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">DHCPServer</span><span class="c1">#show ip dhcp server statistics</span>
<span class="n">Memory</span> <span class="n">usage</span>         <span class="mi">8754</span>
<span class="n">Address</span> <span class="n">pools</span>        <span class="mi">1</span>
<span class="n">Database</span> <span class="n">agents</span>      <span class="mi">0</span>
<span class="n">Automatic</span> <span class="n">bindings</span>   <span class="mi">0</span>
<span class="n">Manual</span> <span class="n">bindings</span>      <span class="mi">0</span>
<span class="n">Expired</span> <span class="n">bindings</span>     <span class="mi">0</span>
<span class="n">Malformed</span> <span class="n">messages</span>   <span class="mi">0</span>
<span class="n">Secure</span> <span class="n">arp</span> <span class="n">entries</span>   <span class="mi">0</span>

<span class="n">Message</span>              <span class="n">Received</span>
<span class="n">BOOTREQUEST</span>          <span class="mi">0</span>
<span class="n">DHCPDISCOVER</span>         <span class="mi">0</span>
<span class="n">DHCPREQUEST</span>          <span class="mi">0</span>
<span class="n">DHCPDECLINE</span>          <span class="mi">0</span>
<span class="n">DHCPRELEASE</span>          <span class="mi">0</span>
<span class="n">DHCPINFORM</span>           <span class="mi">0</span>

<span class="n">Message</span>              <span class="n">Sent</span>
<span class="n">BOOTREPLY</span>            <span class="mi">0</span>
<span class="n">DHCPOFFER</span>            <span class="mi">0</span>
<span class="n">DHCPACK</span>              <span class="mi">0</span>
<span class="n">DHCPNAK</span>              <span class="mi">0</span>
</pre></div>
</div>
<p>We can use show ip dhcp server statistics to see if the DHCP server is doing anything. You can see that itâs not doing anythingâ¦what could this mean? Take a look below:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">DHCPServer</span><span class="c1">#show ip sockets</span>
<span class="n">Proto</span>    <span class="n">Remote</span>      <span class="n">Port</span>      <span class="n">Local</span>       <span class="n">Port</span>  <span class="n">In</span> <span class="n">Out</span> <span class="n">Stat</span> <span class="n">TTY</span> <span class="n">OutputIF</span>
</pre></div>
</div>
<p>This is a command you probably donât see every day. Show ip sockets shows us on which ports the router is listening. As you can see itâs not listening on any portsâ¦if I donât see port 67 here (DHCP) it means that the DHCP service has been disabled. Letâs enable it:</p>
<p><code class="docutils literal"><span class="pre">DHCPServer(config)#service</span> <span class="pre">dhcp</span></code></p>
<p>Letâs enable the service. Take a look at the sockets again:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">DHCPServer</span><span class="c1">#show ip sockets</span>
<span class="n">Proto</span>    <span class="n">Remote</span>      <span class="n">Port</span>      <span class="n">Local</span>       <span class="n">Port</span>  <span class="n">In</span> <span class="n">Out</span> <span class="n">Stat</span> <span class="n">TTY</span> <span class="n">OutputIF</span>
 <span class="mi">17</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span>             <span class="mi">0</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">12.2</span>       <span class="mi">67</span>   <span class="mi">0</span>   <span class="mi">0</span> <span class="mi">2211</span>   <span class="mi">0</span>
</pre></div>
</div>
<p>Thatâs better! Now we see the router is listening on port 67, this means the DHCP service is active. After a few seconds, the client will receive an IP address:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">DHCPClient</span><span class="c1"># %DHCP-6-ADDRESS_ASSIGN: Interface FastEthernet0/0 assigned DHCP address 192.168.12.1, mask 255.255.255.0, hostname DHCPClient</span>
</pre></div>
</div>
<p>As soon as the DHCP service is running you can see the client receives an IP address through DHCPâ¦problem solved!</p>
<p><strong>Lesson learned: If everything is OK, make sure the DHCP service is running.</strong></p>
</div>
</div>
<div class="section" id="dhcpv4-troubleshooting-tasks">
<h2>DHCPv4 Troubleshooting Tasks<a class="headerlink" href="#dhcpv4-troubleshooting-tasks" title="Permalink to this headline">Â¶</a></h2>
<ol class="arabic">
<li><dl class="first docutils">
<dt>Resolve address conflicts</dt>
<dd><p class="first">The <code class="docutils literal"><span class="pre">show</span> <span class="pre">ip</span> <span class="pre">dhcp</span> <span class="pre">conflict</span></code> command displays all address conflicts recorded by the DHCPv4 server, as shown in Figure 2. The server uses the ping command to detect clients. The client uses Address Resolution Protocol (ARP) to detect conflicts. If an address conflict is detected, the address is removed from the pool and not assigned until an administrator resolves the conflict.</p>
<p class="last">This output displays IP addresses that have conflicts with the DHCP server. It shows the detection method and detection time for conflicting IP addresses that the DHCP server has offered.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Verify physical connectivity</dt>
<dd><p class="first last">use the <code class="docutils literal"><span class="pre">show</span> <span class="pre">interfaces</span> <span class="pre">interface</span></code> command to confirm that the router interface acting as the default gateway for the client is operational. If the state of the interface is anything other than up, the port does not pass traffic, including DHCP client requests.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Test with a static IPv4 address</dt>
<dd><p class="first last">If the workstation is unable to reach network resources with a statically configured IPv4 address, the root cause of the problem is not DHCPv4. At this point, network connectivity troubleshooting is required.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Verify switch port configuration</dt>
<dd><p class="first">If the DHCPv4 client is unable to obtain an IPv4 address from the DHCPv4 server on startup, attempt to obtain an IPv4 address from the DHCPv4 server by manually forcing the client to send a DHCPv4 request. In linux that is <code class="docutils literal"><span class="pre">dhclient</span> <span class="pre">-4</span></code></p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">if there is a switch between the client and the DHCPv4 server, and the client is unable to obtain the DHCP configuration, switch port configuration issues may be the cause. These causes may include issues from trunking and channeling, STP, and RSTP. PortFast and edge port configurations resolve the most common DHCPv4 client issues that occur with an initial installation of a Cisco switch.</p>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Test from the same subnet or VLAN</dt>
<dd><p class="first last">It is important to distinguish whether DHCPv4 is functioning correctly when the client is on the same subnet or VLAN as the DHCPv4 server. If DHCPv4 is working correctly when the client is on the same subnet or VLAN, the problem may be the DHCP relay agent. If the problem persists even with testing DHCPv4 on the same subnet or VLAN as the DHCPv4 server, the problem may actually be with the DHCPv4 server.</p>
</dd>
</dl>
</li>
</ol>
<p>Verify Router DHCPv4 Configuration</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="c1"># show running-config | section interface GigabitEthernet0/0</span>
<span class="n">interface</span> <span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mi">0</span>
 <span class="n">ip</span> <span class="n">address</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">10.1</span> <span class="mf">255.255</span><span class="o">.</span><span class="mf">255.0</span>
 <span class="n">ip</span> <span class="n">helper</span><span class="o">-</span><span class="n">address</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">11.6</span>
 <span class="n">duplex</span> <span class="n">auto</span>
 <span class="n">speed</span> <span class="n">auto</span>
<span class="n">R1</span><span class="c1">#</span>
<span class="n">R1</span><span class="c1"># show running-config | include no service dhcp</span>
</pre></div>
</div>
<p>Debug DHCPv4 using router debug commands</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 100 permit udp any any eq 67</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># access-list 100 permit udp any any eq 68</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># end</span>
<span class="n">R1</span><span class="c1"># debug ip packet 100</span>
<span class="n">IP</span> <span class="n">packet</span> <span class="n">debugging</span> <span class="ow">is</span> <span class="n">on</span> <span class="k">for</span> <span class="n">access</span> <span class="nb">list</span> <span class="mi">100</span>
<span class="o">*</span><span class="n">IP</span><span class="p">:</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span> <span class="p">(</span><span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="o">=</span><span class="mf">255.255</span><span class="o">.</span><span class="mf">255.255</span><span class="p">,</span> <span class="nb">len</span> <span class="mi">333</span><span class="p">,</span> <span class="n">rcvd</span> <span class="mi">2</span>
<span class="o">*</span><span class="n">IP</span><span class="p">:</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span> <span class="p">(</span><span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="o">=</span><span class="mf">255.255</span><span class="o">.</span><span class="mf">255.255</span><span class="p">,</span> <span class="nb">len</span> <span class="mi">333</span><span class="p">,</span> <span class="n">stop</span> <span class="n">process</span> <span class="n">pak</span> <span class="k">for</span> <span class="n">forus</span> <span class="n">packet</span>
<span class="o">*</span><span class="n">IP</span><span class="p">:</span> <span class="n">s</span><span class="o">=</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">11.1</span> <span class="p">(</span><span class="n">local</span><span class="p">),</span> <span class="n">d</span><span class="o">=</span><span class="mf">255.255</span><span class="o">.</span><span class="mf">255.255</span> <span class="p">(</span><span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mi">1</span><span class="p">),</span> <span class="nb">len</span> <span class="mi">328</span><span class="p">,</span> <span class="n">sending</span> <span class="n">broad</span><span class="o">/</span><span class="n">multicast</span>
<span class="o">...</span>
<span class="n">R1</span><span class="c1"># debug ip dhcp server events</span>
<span class="n">DHCPD</span><span class="p">:</span> <span class="n">returned</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">10.11</span> <span class="n">to</span> <span class="n">address</span> <span class="n">pool</span> <span class="n">LAN</span><span class="o">-</span><span class="n">POOL</span><span class="o">-</span><span class="mi">1</span>
<span class="n">DHCPD</span><span class="p">:</span> <span class="n">assigned</span> <span class="n">IP</span> <span class="n">address</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">10.12</span> <span class="n">to</span> <span class="n">client</span> <span class="mf">0100.0103</span><span class="o">.</span><span class="mf">85e9</span><span class="o">.</span><span class="mf">87.</span>
<span class="n">DHCPD</span><span class="p">:</span> <span class="n">checking</span> <span class="k">for</span> <span class="n">expired</span> <span class="n">leases</span><span class="o">.</span>
<span class="n">DHCPD</span><span class="p">:</span> <span class="n">the</span> <span class="n">lease</span> <span class="k">for</span> <span class="n">address</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">10.10</span> <span class="n">has</span> <span class="n">expired</span><span class="o">.</span>
<span class="n">DHCPD</span><span class="p">:</span> <span class="n">returned</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">10.10</span> <span class="n">to</span> <span class="n">address</span> <span class="n">pool</span> <span class="n">LAN</span><span class="o">-</span><span class="n">POOL</span><span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
<p>The extended ACL is used with the <code class="docutils literal"><span class="pre">debug</span> <span class="pre">ip</span> <span class="pre">packet</span></code> command to display only DHCPv4 messages.</p>
<p>The output in the figure shows that the router is receiving DHCP requests from the client. The source IP address is 0.0.0.0 because the client does not yet have an IP address. The destination is 255.255.255.255 because the DHCP discovery message from the client is sent as a broadcast. This output only shows a summary of the packet and not the DHCPv4 message itself. Nevertheless, the router did receive a broadcast packet with the source and destination IP and UDP ports that are correct for DHCPv4. The complete debug output shows all the packets in the DHCPv4 communications between the DHCPv4 server and client.</p>
<p>Another useful command for troubleshooting DHCPv4 operation is the <code class="docutils literal"><span class="pre">debug</span> <span class="pre">ip</span> <span class="pre">dhcp</span> <span class="pre">server</span> <span class="pre">events</span></code> command. This command reports server events, like address assignments and database updates.</p>
<p>The DHCP assignment conflict indicates there may be an issue with the excluded-address statement on the DHCP server configuration on R2.</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">16.939</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">Sending</span> <span class="n">notification</span> <span class="n">of</span> <span class="n">DISCOVER</span><span class="p">:</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">16.939</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">htype</span> <span class="mi">1</span> <span class="n">chaddr</span> <span class="mf">0050.56</span><span class="n">be</span><span class="o">.</span><span class="mi">768</span><span class="n">c</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">16.939</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">circuit</span> <span class="nb">id</span> <span class="mi">00000000</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">16.939</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">Seeing</span> <span class="k">if</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">an</span> <span class="n">internally</span> <span class="n">specified</span> <span class="n">pool</span> <span class="n">class</span><span class="p">:</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">16.939</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">htype</span> <span class="mi">1</span> <span class="n">chaddr</span> <span class="mf">0050.56</span><span class="n">be</span><span class="o">.</span><span class="mi">768</span><span class="n">c</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">16.939</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">circuit</span> <span class="nb">id</span> <span class="mi">00000000</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">16.943</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">Allocated</span> <span class="n">binding</span> <span class="mi">2944</span><span class="n">C764</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">16.943</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">Adding</span> <span class="n">binding</span> <span class="n">to</span> <span class="n">radix</span> <span class="n">tree</span> <span class="p">(</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">1.1</span><span class="p">)</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">16.943</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">Adding</span> <span class="n">binding</span> <span class="n">to</span> <span class="nb">hash</span> <span class="n">tree</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">16.943</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">assigned</span> <span class="n">IP</span> <span class="n">address</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.1</span> <span class="n">to</span> <span class="n">client</span> <span class="mf">0100.5056</span><span class="o">.</span><span class="n">be76</span><span class="o">.</span><span class="mi">8</span><span class="n">c</span><span class="o">.</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">16.951</span><span class="p">:</span> <span class="o">%</span><span class="n">DHCPD</span><span class="o">-</span><span class="mi">4</span><span class="o">-</span><span class="n">PING_CONFLICT</span><span class="p">:</span> <span class="n">DHCP</span> <span class="n">address</span> <span class="n">conflict</span><span class="p">:</span> <span class="n">server</span> <span class="n">pinged</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.1</span><span class="o">.</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">16.951</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">returned</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.1</span> <span class="n">to</span> <span class="n">address</span> <span class="n">pool</span> <span class="n">R1G1</span><span class="o">.</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">16.951</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">Sending</span> <span class="n">notification</span> <span class="n">of</span> <span class="n">DISCOVER</span><span class="p">:</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">16.951</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">htype</span> <span class="mi">1</span> <span class="n">chaddr</span> <span class="mf">0050.56</span><span class="n">be</span><span class="o">.</span><span class="mi">768</span><span class="n">c</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">16.951</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">circuit</span> <span class="nb">id</span> <span class="mi">00000000</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">16.951</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">Seeing</span> <span class="k">if</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">an</span> <span class="n">internally</span> <span class="n">specified</span> <span class="n">pool</span> <span class="n">class</span><span class="p">:</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">16.951</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">htype</span> <span class="mi">1</span> <span class="n">chaddr</span> <span class="mf">0050.56</span><span class="n">be</span><span class="o">.</span><span class="mi">768</span><span class="n">c</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">16.951</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">circuit</span> <span class="nb">id</span> <span class="mi">00000000</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">16.951</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">Allocated</span> <span class="n">binding</span> <span class="mi">31</span><span class="n">DC93C8</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">16.951</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">Adding</span> <span class="n">binding</span> <span class="n">to</span> <span class="n">radix</span> <span class="n">tree</span> <span class="p">(</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">1.2</span><span class="p">)</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">16.951</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">Adding</span> <span class="n">binding</span> <span class="n">to</span> <span class="nb">hash</span> <span class="n">tree</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">16.951</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">assigned</span> <span class="n">IP</span> <span class="n">address</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.2</span> <span class="n">to</span> <span class="n">client</span> <span class="mf">0100.5056</span><span class="o">.</span><span class="n">be76</span><span class="o">.</span><span class="mi">8</span><span class="n">c</span><span class="o">.</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">18.383</span><span class="p">:</span> <span class="o">%</span><span class="n">DHCPD</span><span class="o">-</span><span class="mi">4</span><span class="o">-</span><span class="n">PING_CONFLICT</span><span class="p">:</span> <span class="n">DHCP</span> <span class="n">address</span> <span class="n">conflict</span><span class="p">:</span><span class="n">server</span> <span class="n">pinged</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.2</span><span class="o">.</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">18.383</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">returned</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.2</span> <span class="n">to</span> <span class="n">address</span> <span class="n">pool</span> <span class="n">R1G1</span><span class="o">.</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">18.383</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">Sending</span> <span class="n">notification</span> <span class="n">of</span> <span class="n">DISCOVER</span><span class="p">:</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">18.383</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">htype</span> <span class="mi">1</span> <span class="n">chaddr</span> <span class="mf">0050.56</span><span class="n">be</span><span class="o">.</span><span class="mi">6</span><span class="n">c89</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">18.383</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">circuit</span> <span class="nb">id</span> <span class="mi">00000000</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">18.383</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">Seeing</span> <span class="k">if</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">an</span> <span class="n">internally</span> <span class="n">specified</span> <span class="n">pool</span> <span class="n">class</span><span class="p">:</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">18.383</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">htype</span> <span class="mi">1</span> <span class="n">chaddr</span> <span class="mf">0050.56</span><span class="n">be</span><span class="o">.</span><span class="mi">6</span><span class="n">c89</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">18.383</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">circuit</span> <span class="nb">id</span> <span class="mi">00000000</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">18.383</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">Allocated</span> <span class="n">binding</span> <span class="mi">2</span><span class="n">A40E074</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">18.383</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">Adding</span> <span class="n">binding</span> <span class="n">to</span> <span class="n">radix</span> <span class="n">tree</span> <span class="p">(</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">1.3</span><span class="p">)</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">18.383</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">Adding</span> <span class="n">binding</span> <span class="n">to</span> <span class="nb">hash</span> <span class="n">tree</span>
<span class="o">*</span><span class="n">Mar</span>  <span class="mi">5</span> <span class="mi">06</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mf">18.383</span><span class="p">:</span> <span class="n">DHCPD</span><span class="p">:</span> <span class="n">assigned</span> <span class="n">IP</span> <span class="n">address</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.3</span> <span class="n">to</span> <span class="n">client</span> <span class="mf">0100.5056</span><span class="o">.</span><span class="n">be76</span><span class="o">.</span><span class="mi">8</span><span class="n">c</span>
<span class="o">.</span>
<span class="o">&lt;</span><span class="n">output</span> <span class="n">omitted</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R2</span><span class="c1">#</span>
<span class="n">show</span> <span class="n">run</span> <span class="o">|</span> <span class="n">section</span> <span class="n">dhcp</span>
<span class="n">ip</span> <span class="n">dhcp</span> <span class="n">excluded</span><span class="o">-</span><span class="n">address</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">11.1</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">11.9</span>
<span class="n">ip</span> <span class="n">dhcp</span> <span class="n">excluded</span><span class="o">-</span><span class="n">address</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.1</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.9</span>
<span class="n">ip</span> <span class="n">dhcp</span> <span class="n">pool</span> <span class="n">R1G1</span>
 <span class="n">network</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.0</span> <span class="mf">255.255</span><span class="o">.</span><span class="mf">255.0</span>
 <span class="n">default</span><span class="o">-</span><span class="n">router</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.1</span>
<span class="n">ip</span> <span class="n">dhcp</span> <span class="n">pool</span> <span class="n">R1G0</span>
 <span class="n">network</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.0</span> <span class="mf">255.255</span><span class="o">.</span><span class="mf">255.128</span>
 <span class="n">default</span><span class="o">-</span><span class="n">router</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.1</span>
</pre></div>
</div>
</div>
<div class="section" id="slaac">
<h2>SLAAC<a class="headerlink" href="#slaac" title="Permalink to this headline">Â¶</a></h2>
<p><strong>Stateless</strong> Address AutoConfiguration</p>
<dl class="docutils">
<dt>A Stateless service</dt>
<dd>no server that maintains network address information. Unlike DHCP there is no SLAAC server that knows what IPv6 addresses are being used and which ones are available</dd>
</dl>
<p>SLAAC is a method in which a device can obtain an IPv6 global unicast address without the services of a DHCPv6 server. <strong>At the core of SLAAC is ICMPv6</strong>. ICMPv6 is similar to ICMPv4 but includes additional functionality and is a much more robust protocol. <strong>SLAAC uses ICMPv6 Router Solicitation and Router Advertisement messages</strong> to provide addressing and other configuration information that would normally be provided by a DHCP server:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>Router Solicitation (RS) message</dt>
<dd>When a client is configured to obtain its addressing information automatically using SLAAC, the client sends an RS message to the router. The RS message is sent to the IPv6 all-routers multicast address <strong>FF02::2</strong></dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Router Advertisement (RA) message</dt>
<dd>RA messages are sent by routers to provide addressing information to clients configured to obtain their IPv6 addresses automatically. The RA message includes the prefix and prefix length of the local segment. A client uses this information to create its own IPv6 global unicast address. A router sends an RA message periodically, or in response to an RS message. By default, Cisco routers send RA messages every 200 seconds.</dd>
</dl>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">RA messages are always sent to the IPv6 all-nodes multicast address FF02::1</p>
</div>
<div class="section" id="slaac-operation">
<h3>SLAAC operation<a class="headerlink" href="#slaac-operation" title="Permalink to this headline">Â¶</a></h3>
<img alt="../../../_images/Ch8_SLAAC_operation.png" src="../../../_images/Ch8_SLAAC_operation.png" />
<ol class="arabic">
<li><dl class="first docutils">
<dt>Client sends Router Sollicitation message</dt>
<dd><p class="first last">Since booting, PC1 has not received an RA message, so it sends an RS message to the all-routers multicast address to inform the local IPv6 router that it needs an RA.</p>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">a router must have IPv6 routing enabled before it can send RA messages <code class="docutils literal"><span class="pre">Router(config)#</span> <span class="pre">ipv6</span> <span class="pre">unicast-routing</span></code></p>
</div>
</li>
<li><dl class="first docutils">
<dt>R1 receives the RS message and responds with an RA message</dt>
<dd><p class="first last">Included in the RA message are the prefix and prefix length of the network. The RA message is sent to the IPv6 all-nodes multicast address <strong>FF02::1</strong>, with the <strong>link-local address of the router as the IPv6 source address</strong>.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PC1 receives the RA message containing the prefix and prefix length for the local network</dt>
<dd><p class="first">PC1 will use this information to create its own IPv6 global unicast address. PC1 now has a 64-bit network prefix, but needs a 64-bit Interface ID (IID) to create a global unicast address.
There are 2 ways PC1 can create its own unique IID</p>
<ol class="arabic simple">
<li><dl class="first docutils">
<dt>EUI-64</dt>
<dd>Using the EUI-64 process, PC1 will create an IID using its 48-bit MAC address.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Randomly generated</dt>
<dd>The 64-bit IID can be a random number generated by the client operating system.</dd>
</dl>
</li>
</ol>
<p class="last">PC1 can create a 128-bit IPv6 global unicast address by combining the 64-bit prefix with the 64-bit IID. PC1 will use the link-local address of the router as its IPv6 default gateway address.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Because SLAAC is stateless, PC1 must verify that this newly created IPv6 address is unique</dt>
<dd><p class="first last">PC1 sends an <strong>ICMPv6 Neighbor Solicitation message with a specially constructed multicast address</strong>, called a solicited-node multicast address, which duplicates the last 24 bits of PC1âs IPv6 address. If no other devices respond with a Neighbor Advertisement message, then the address is virtually guaranteed to be unique and can be used by PC1. <strong>If a Neighbor Advertisement is received</strong> by PC1 <strong>then the address is not unique</strong> and the operating system has to determine a new Interface ID to use.</p>
</dd>
</dl>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This process is part of ICMPv6 Neighbor Discovery and is known as Duplicate Address Detection (DAD).</p>
</div>
<p>The decision of whether a client is configured to obtain its IPv6 address information automatically using SLAAC, DHCPv6, or a combination of both depends on the <strong>settings within the RA message</strong></p>
<dl class="docutils">
<dt>The two flags are the Managed Address Configuration flag (M flag) and the Other Configuration flag (O flag)</dt>
<dd><p class="first">Using different combinations of the M and O flags, RA messages have one of three addressing options for the IPv6 device:</p>
<ul class="last simple">
<li>SLAAC (Router Advertisement only) (Default)</li>
<li>Stateless DHCPv6 (Router Advertisement and DHCPv6)</li>
<li>Stateful DHCPv6 (DHCPv6 only)</li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Regardless of the option used, it is recommended by RFC 4861 that all IPv6 devices perform Duplicate Address Detection (DAD) on any unicast address, including addresses configured using SLAAC or DHCPv6. DAD is implemented using ICMPv6, which is specified by RFC 4443.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although the RA message specifies the process the client should use in obtaining an IPv6 address dynamically, the client operating system may choose to ignore the RA message and use the services of a DHCPv6 server exclusively.</p>
</div>
</div>
<div class="section" id="slaac-option">
<h3>SLAAC Option<a class="headerlink" href="#slaac-option" title="Permalink to this headline">Â¶</a></h3>
<dl class="docutils">
<dt>SLAAC Option (Router Advertisement only)</dt>
<dd>SLAAC is the default option on Cisco routers. Both the M flag and the O flag are set to 0 in the RA</dd>
</dl>
<p>This option instructs the client to use the information in the RA message exclusively. This includes <strong>prefix, prefix-length, DNS server, MTU, and default gateway information</strong>. There is no further information available from a DHCPv6 server. The IPv6 global unicast address is created by combining the prefix from RA and an Interface ID using either EUI-64 or a randomly generated value.</p>
<dl class="docutils">
<dt>RA messages are configured on an individual interface of a router</dt>
<dd><p class="first">To <strong>re-enable an interface for SLAAC</strong> that might have been set to another option, the M and O flags need to be reset to their initial values of 0. This is done using the following interface configuration mode commands:</p>
<div class="code last highlight-default"><div class="highlight"><pre><span></span><span class="n">Router</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># no ipv6 nd managed-config-flag</span>
<span class="n">Router</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># no ipv6 nd other-config-flag</span>
</pre></div>
</div>
</dd>
</dl>
<p>ipv6 <strong>N</strong> eighbor <strong>D</strong> iscovery <strong>M</strong> anaged/<strong>O</strong> ther <strong>-CONFIG-FLAG</strong></p>
<img alt="../../../_images/Ch8_stateful_dhcpv6_option.png" src="../../../_images/Ch8_stateful_dhcpv6_option.png" />
</div>
</div>
<div class="section" id="dhcpv6-operations">
<h2>DHCPv6 Operations<a class="headerlink" href="#dhcpv6-operations" title="Permalink to this headline">Â¶</a></h2>
<img alt="../../../_images/Ch8_DHCPv6_operations.png" src="../../../_images/Ch8_DHCPv6_operations.png" />
<p>When stateless DHCPv6 or stateful DHCPv6 is indicated by the RA, DHCPv6 operation is invoked. DHCPv6 messages are sent over UDP. DHCPv6 messages from the <strong>server to the client use UDP destination port 546</strong>. <strong>The client sends DHCPv6 messages to the server using UDP destination port 547</strong>.</p>
<ol class="arabic simple">
<li>Router Solicitation</li>
<li>Router Advertisement</li>
<li>the client sends a DHCPv6 <strong>SOLICIT</strong> message to the <strong>reserved IPv6 multicast all-DHCPv6-servers address FF02::1:2</strong>. This multicast address has <strong>link-local scope</strong>, which means routers do not forward the messages to other networks.</li>
<li>One or more DHCPv6 servers respond with a <strong>DHCPv6 ADVERTISE unicast message</strong> as shown in Figure 3. The ADVERTISE message informs the DHCPv6 client that the server is available for DHCPv6 service.</li>
<li>the client responds with a DHCPv6 <strong>REQUEST or INFORMATION-REQUEST</strong> unicast message to the server, <strong>depending on whether it is using stateful or stateless DHCPv6</strong>.<ul>
<li><dl class="first docutils">
<dt>Stateless DHCPv6 client</dt>
<dd>The client sends a DHCPv6 INFORMATION-REQUEST message to the DHCPv6 server requesting only configuration parameters, such as DNS server address. The <strong>client generated its own IPv6 address using the prefix from the RA message and a self-generated Interface ID</strong>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Stateful DHCPv6 client</dt>
<dd>The client sends a DHCPv6 REQUEST message to the server to obtain an IPv6 address and all other configuration parameters from the server</dd>
</dl>
</li>
</ul>
</li>
<li>server sends a DHCPv6 <strong>REPLY</strong> unicast message to the client containing the information requested in the REQUEST or INFORMATION-REQUEST message as shown in 5.</li>
</ol>
<p>mnemonic: RSRA SolARR (vd SARR)</p>
</div>
<div class="section" id="dhcpv6-stateless-config">
<h2>DHCPv6 Stateless Config<a class="headerlink" href="#dhcpv6-stateless-config" title="Permalink to this headline">Â¶</a></h2>
<ol class="arabic">
<li><p class="first">Enable IPv6 Routing</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># ipv6 unicast-routing</span>
</pre></div>
</div>
</li>
<li><p class="first">Configure a DHCPv6 Pool</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># ipv6 dhcp pool STUDENT-POOL</span>
<span class="n">R</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">dhcpv6</span><span class="p">)</span><span class="c1">#</span>
</pre></div>
</div>
</li>
<li><p class="first">Configure Pool Parameters</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">dhcpv6</span><span class="p">)</span><span class="c1"># dns-server dns-server-address</span>
<span class="n">R</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">dhcpv6</span><span class="p">)</span><span class="c1"># domain-name domain-name</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">During the SLAAC process, the client received the information it needed to create an IPv6 global unicast address. The client also received the default gateway information using the source IPv6 address from the RA message, which is the link-local address of the router. However, the stateless DHCPv6 server can be configured to provide other information that might not have been included in the RA message such as DNS server address and the domain name.</p>
</div>
</li>
<li><p class="first">Configure DHCPv6 Interface</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># interface Gi0/0</span>
<span class="n">R</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ipv6 dhcp server STUDENT-POOL</span>
<span class="n">R</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ipv6 nd other-config-flag</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">ipv6</span> <span class="pre">dhcp</span> <span class="pre">server</span> <span class="pre">STUDENT-POOL</span></code> binds the DHCPv6 pool to the interface. The router responds to stateless DHCPv6 requests on this interface with the information contained in the pool. The O flag needs to be changed from 0 to 1 using the interface command <code class="docutils literal"><span class="pre">ipv6</span> <span class="pre">nd</span> <span class="pre">other-config-flag</span></code>. RA messages sent on this interface indicate that additional information is available from a stateless DHCPv6 server.</p>
</li>
</ol>
<p>Example, R3 is configured as a client to help verify the stateless DHCPv6 operations.</p>
<img alt="../../../_images/Ch8_dhcpv6_stateless_server.png" src="../../../_images/Ch8_dhcpv6_stateless_server.png" />
</div>
<div class="section" id="dhcpv6-stateless-client">
<h2>DHCPv6 Stateless Client<a class="headerlink" href="#dhcpv6-stateless-client" title="Permalink to this headline">Â¶</a></h2>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R3</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># interface g0/1</span>
<span class="n">R3</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ipv6 enable</span>
<span class="n">R3</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ipv6 address autoconfig</span>
</pre></div>
</div>
<p>The client router needs an IPv6 link-local address on the interface to send and receive IPv6 messages, such as RS messages and DHCPv6 messages. The link-local address of a router is created automatically when IPv6 is enabled on the interface. This can happen when a global unicast address is configured on the interface or by using the ipv6 enable command. <code class="docutils literal"><span class="pre">After</span> <span class="pre">the</span> <span class="pre">router</span> <span class="pre">receives</span> <span class="pre">a</span> <span class="pre">link-local</span> <span class="pre">address,</span> <span class="pre">it</span> <span class="pre">can</span> <span class="pre">participate</span> <span class="pre">in</span> <span class="pre">IPv6</span> <span class="pre">neighbor</span> <span class="pre">discovery</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">the ipv6 enable command is used because the router does not yet have a global unicast address.</p>
</div>
<p>The <code class="docutils literal"><span class="pre">ipv6</span> <span class="pre">address</span> <span class="pre">autoconfig</span></code> command enables automatic configuration of IPv6 addressing using SLAAC. By assumption, the server router is configured for stateless DHCPv6 so it sends an RA message to inform the client router to use stateless DHCPv6 to obtain DNS information.</p>
</div>
<div class="section" id="verify-stateless-dhcpv6">
<h2>Verify Stateless dhcpv6<a class="headerlink" href="#verify-stateless-dhcpv6" title="Permalink to this headline">Â¶</a></h2>
<dl class="docutils">
<dt>server</dt>
<dd><code class="docutils literal"><span class="pre">R1#</span> <span class="pre">show</span> <span class="pre">ipv6</span> <span class="pre">dhcp</span> <span class="pre">pool</span></code></dd>
<dt>client</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal"><span class="pre">R3#</span> <span class="pre">show</span> <span class="pre">ipv6</span> <span class="pre">interface</span> <span class="pre">Gi0/1</span></code></li>
<li><code class="docutils literal"><span class="pre">debug</span> <span class="pre">ipv6</span> <span class="pre">dhcp</span> <span class="pre">detail</span></code>
The debug output displays all the DHCPv6 messages sent between the client and the server including the DNS server and domain name options that were configured on the server.</li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Notice that the client, router R3, is sending the DHCPv6 messages from its link-local address to the All_DHCPv6_Relay_Agents_and_Servers address FF02::1:2</p>
</div>
</div>
<div class="section" id="dhcpv6-stateful-config">
<h2>DHCPv6 Stateful Config<a class="headerlink" href="#dhcpv6-stateful-config" title="Permalink to this headline">Â¶</a></h2>
<ol class="arabic">
<li><p class="first">Enable IPv6 Routing</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># ipv6 unicast-routing</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This command is not necessary for the router to be a stateful DHCPv6 server, but it is required for the router to source ICMPv6 RA messages</p>
</div>
</li>
<li><p class="first">Configure a DHCPv6 Pool</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># ipv6 dhcp pool IPV6-STATEFUL</span>
<span class="n">R</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">dhcpv6</span><span class="p">)</span><span class="c1">#</span>
</pre></div>
</div>
</li>
<li><p class="first">Configure Pool Parameters</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">dhcpv6</span><span class="p">)</span><span class="c1"># address prefix prefix/length [lifetime {valid-lifetime preferred-lifetime | infinite}]</span>
<span class="n">R</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">dhcpv6</span><span class="p">)</span><span class="c1"># address prefix 2001:db8:cafe:1::/64 lifetime infinite</span>
<span class="n">R</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">dhcpv6</span><span class="p">)</span><span class="c1"># dns-server 2001:db8:cafe:aaaa::5</span>
<span class="n">R</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">dhcpv6</span><span class="p">)</span><span class="c1"># domain-name example.com</span>
<span class="n">R</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">dhcpv6</span><span class="p">)</span><span class="c1"># exit</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">During the SLAAC process, the client received the information it needed to create an IPv6 global unicast address. The client also received the default gateway information using the source IPv6 address from the RA message, which is the link-local address of the router. However, the stateless DHCPv6 server can be configured to provide other information that might not have been included in the RA message such as DNS server address and the domain name.</p>
</div>
</li>
<li><p class="first">Configure DHCPv6 Interface</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># interface Gi0/0</span>
<span class="n">R</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ipv6 dhcp server IPV6-STATEFUL</span>
<span class="n">R</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ipv6 nd MANAGED-config-flag</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">The</span> <span class="pre">M</span> <span class="pre">flag</span> <span class="pre">needs</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">changed</span> <span class="pre">from</span> <span class="pre">0</span> <span class="pre">to</span> <span class="pre">1</span> <span class="pre">using</span> <span class="pre">the</span> <span class="pre">interface</span> <span class="pre">command</span> <span class="pre">ipv6</span> <span class="pre">nd</span> <span class="pre">managed-config-flag.</span> <span class="pre">This</span> <span class="pre">informs</span> <span class="pre">the</span> <span class="pre">device</span> <span class="pre">not</span> <span class="pre">to</span> <span class="pre">use</span> <span class="pre">SLAAC</span> <span class="pre">but</span> <span class="pre">to</span> <span class="pre">obtain</span> <span class="pre">IPv6</span> <span class="pre">addressing</span> <span class="pre">and</span> <span class="pre">all</span> <span class="pre">configuration</span> <span class="pre">parameters</span> <span class="pre">from</span> <span class="pre">a</span> <span class="pre">stateful</span> <span class="pre">DHCPv6</span> <span class="pre">server</span></code></p>
</li>
</ol>
</div>
<div class="section" id="dhcpv6-stateful-client">
<h2>DHCPv6 Stateful Client<a class="headerlink" href="#dhcpv6-stateful-client" title="Permalink to this headline">Â¶</a></h2>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R3</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># interface g0/1</span>
<span class="n">R3</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ipv6 enable</span>
<span class="n">R3</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ipv6 address dhcp</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">ipv6</span> <span class="pre">enable</span></code> interface configuration mode command allows the client router to receive an IPv6 link-local address on the interface to send RS messages and participate in DHCPv6</p>
</div>
<div class="section" id="verify-stateful-dhcpv6">
<h2>Verify Stateful dhcpv6<a class="headerlink" href="#verify-stateful-dhcpv6" title="Permalink to this headline">Â¶</a></h2>
<dl class="docutils">
<dt>server</dt>
<dd><code class="docutils literal"><span class="pre">R1#</span> <span class="pre">show</span> <span class="pre">ipv6</span> <span class="pre">dhcp</span> <span class="pre">pool</span></code>
<code class="docutils literal"><span class="pre">R1#</span> <span class="pre">show</span> <span class="pre">ipv6</span> <span class="pre">dhcp</span> <span class="pre">binding</span></code>
displays the automatic binding between the link-local address of the client and the address assigned by the server. FE80::32F7:DFF:FE25:2DE1 is the link-local address of the client. In this example, this is the G0/1 interface of R3. This address is bound to the IPv6 global unicast address, 2001:DB8:CAFE:1:5844:47B2:2603:C171, which was assigned by R1, the DHCPv6 server. This information is maintained by a stateful DHCPv6 server and NOT by a stateless DHCPv6 server.</dd>
<dt>client</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal"><span class="pre">R3#</span> <span class="pre">show</span> <span class="pre">ipv6</span> <span class="pre">interface</span> <span class="pre">Gi0/1</span></code></li>
<li><code class="docutils literal"><span class="pre">debug</span> <span class="pre">ipv6</span> <span class="pre">dhcp</span> <span class="pre">detail</span></code>
The debug output displays all the DHCPv6 messages sent between the client and the server including the DNS server and domain name options that were configured on the server.</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="configure-dhcpv6-relay">
<h2>Configure DHCPv6 relay<a class="headerlink" href="#configure-dhcpv6-relay" title="Permalink to this headline">Â¶</a></h2>
<img alt="../../../_images/Ch8_dhcpv6_relay_agent.png" src="../../../_images/Ch8_dhcpv6_relay_agent.png" />
<p>DHCPv6 messages from clients are sent to the IPv6 multicast address <strong>FF02::1:2. All_DHCPv6_Relay_Agents_and_Servers address</strong>. This address has link-local scope which means routers do not forward these messages. The router must be configured as a DHCPv6 relay agent to enable the DHCPv6 client and server to communicate.</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># interface g0/0</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ipv6 dhcp relay destination 2001:db8:cafe:1::6</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># end</span>
<span class="n">R1</span><span class="c1"># show ipv6 interface g0/0</span>
<span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mi">0</span> <span class="ow">is</span> <span class="ow">in</span> <span class="n">relay</span> <span class="n">mode</span>
  <span class="n">Relay</span> <span class="n">destinations</span><span class="p">:</span>
    <span class="mi">2001</span><span class="p">:</span><span class="n">DB8</span><span class="p">:</span><span class="n">CAFE</span><span class="p">:</span><span class="mi">1</span><span class="p">::</span><span class="mi">6</span>
<span class="n">R1</span><span class="c1">#</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">DHCPv6 relay agent is configured using the <code class="docutils literal"><span class="pre">ipv6</span> <span class="pre">dhcp</span> <span class="pre">relay</span> <span class="pre">destination</span></code> command. This command is configured on the interface facing the DHCPv6 client using the address of the DHCPv6 server as the destination.</p>
</div>
<p>The <code class="docutils literal"><span class="pre">show</span> <span class="pre">ipv6</span> <span class="pre">dhcp</span> <span class="pre">interface</span></code> command verifies the G0/0 interface is in relay mode with 2001:DB8:CAFE:1::6 configured as the DHCPv6 server.</p>
<dl class="docutils">
<dt>The dynamic assignment of IPv6 global unicast addresses can be configured in three ways:</dt>
<dd><ul class="first last simple">
<li>Stateless Address Autoconfiguration (SLAAC) only</li>
<li>Stateless Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</li>
<li>Stateful DHCPv6</li>
</ul>
</dd>
</dl>
<p>With SLAAC (pronounced slack), a DHCPv6 server is not needed for hosts to acquire IPv6 addresses. It can be used to receive additional information that the host needs, such as the domain name and the domain name server (DNS) address. When SLAAC is used to assign the IPv6 host addresses and DHCPv6 is used to assign other network parameters, it is called Stateless DHCPv6.
With Stateful DHCPv6, the DHCP server assigns all information, including the host IPv6 address.
Determination of how hosts obtain their dynamic IPv6 addressing information is dependent on flag settings contained within the router advertisement (RA) messages.</p>
</div>
<div class="section" id="dhcpv6-labs">
<h2>DHCPv6 labs<a class="headerlink" href="#dhcpv6-labs" title="Permalink to this headline">Â¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The default bias template (used by the Switch Database Manager (SDM)) does not provide IPv6 address capabilities. Verify that SDM is using either the dual-ipv4-and-ipv6 template or the lanbase-routing template. The new template will be used after reboot even if the config is not saved</p>
</div>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">S1</span><span class="c1"># show sdm prefer</span>

<span class="n">assign</span> <span class="n">the</span> <span class="n">dual</span><span class="o">-</span><span class="n">ipv4</span><span class="o">-</span><span class="ow">and</span><span class="o">-</span><span class="n">ipv6</span> <span class="n">template</span> <span class="k">as</span> <span class="n">the</span> <span class="n">default</span> <span class="n">sdm</span> <span class="n">template</span><span class="p">:</span>

<span class="n">S1</span><span class="c1"># config t</span>
<span class="n">S1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># sdm prefer dual-ipv4-and-ipv6 default</span>
<span class="n">S1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># end</span>
<span class="n">S1</span><span class="c1"># reload</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">wireshark filter to see only ipv6 RA messages <code class="docutils literal"><span class="pre">ipv6.dst==ff02::1</span></code></p>
</div>
<p>Use the show ipv6 interface g0/1 command to verify that G0/1 is part of the All-router multicast group (FF02::2). RA messages are not sent out G0/1 without that group assignment.</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="c1"># show ipv6 interface g0/1</span>
<span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mi">1</span> <span class="ow">is</span> <span class="n">up</span><span class="p">,</span> <span class="n">line</span> <span class="n">protocol</span> <span class="ow">is</span> <span class="n">up</span>
  <span class="n">IPv6</span> <span class="ow">is</span> <span class="n">enabled</span><span class="p">,</span> <span class="n">link</span><span class="o">-</span><span class="n">local</span> <span class="n">address</span> <span class="ow">is</span> <span class="n">FE80</span><span class="p">::</span><span class="mi">1</span>
  <span class="n">No</span> <span class="n">Virtual</span> <span class="n">link</span><span class="o">-</span><span class="n">local</span> <span class="n">address</span><span class="p">(</span><span class="n">es</span><span class="p">):</span>
  <span class="n">Global</span> <span class="n">unicast</span> <span class="n">address</span><span class="p">(</span><span class="n">es</span><span class="p">):</span>
    <span class="mi">2001</span><span class="p">:</span><span class="n">DB8</span><span class="p">:</span><span class="n">ACAD</span><span class="p">:</span><span class="n">A</span><span class="p">::</span><span class="mi">1</span><span class="p">,</span> <span class="n">subnet</span> <span class="ow">is</span> <span class="mi">2001</span><span class="p">:</span><span class="n">DB8</span><span class="p">:</span><span class="n">ACAD</span><span class="p">:</span><span class="n">A</span><span class="p">::</span><span class="o">/</span><span class="mi">64</span>
  <span class="n">Joined</span> <span class="n">group</span> <span class="n">address</span><span class="p">(</span><span class="n">es</span><span class="p">):</span>
    <span class="n">FF02</span><span class="p">::</span><span class="mi">1</span>
    <span class="n">FF02</span><span class="p">::</span><span class="mi">2</span>
    <span class="n">FF02</span><span class="p">::</span><span class="mi">1</span><span class="p">:</span><span class="n">FF00</span><span class="p">:</span><span class="mi">1</span>
  <span class="n">MTU</span> <span class="ow">is</span> <span class="mi">1500</span> <span class="nb">bytes</span>
  <span class="n">ICMP</span> <span class="n">error</span> <span class="n">messages</span> <span class="n">limited</span> <span class="n">to</span> <span class="n">one</span> <span class="n">every</span> <span class="mi">100</span> <span class="n">milliseconds</span>
  <span class="n">ICMP</span> <span class="n">redirects</span> <span class="n">are</span> <span class="n">enabled</span>
  <span class="n">ICMP</span> <span class="n">unreachables</span> <span class="n">are</span> <span class="n">sent</span>
  <span class="n">ND</span> <span class="n">DAD</span> <span class="ow">is</span> <span class="n">enabled</span><span class="p">,</span> <span class="n">number</span> <span class="n">of</span> <span class="n">DAD</span> <span class="n">attempts</span><span class="p">:</span> <span class="mi">1</span>
  <span class="n">ND</span> <span class="n">reachable</span> <span class="n">time</span> <span class="ow">is</span> <span class="mi">30000</span> <span class="n">milliseconds</span> <span class="p">(</span><span class="n">using</span> <span class="mi">30000</span><span class="p">)</span>
  <span class="n">ND</span> <span class="n">advertised</span> <span class="n">reachable</span> <span class="n">time</span> <span class="ow">is</span> <span class="mi">0</span> <span class="p">(</span><span class="n">unspecified</span><span class="p">)</span>
  <span class="n">ND</span> <span class="n">advertised</span> <span class="n">retransmit</span> <span class="n">interval</span> <span class="ow">is</span> <span class="mi">0</span> <span class="p">(</span><span class="n">unspecified</span><span class="p">)</span>
  <span class="n">ND</span> <span class="n">router</span> <span class="n">advertisements</span> <span class="n">are</span> <span class="n">sent</span> <span class="n">every</span> <span class="mi">200</span> <span class="n">seconds</span>
  <span class="n">ND</span> <span class="n">router</span> <span class="n">advertisements</span> <span class="n">live</span> <span class="k">for</span> <span class="mi">1800</span> <span class="n">seconds</span>
  <span class="n">ND</span> <span class="n">advertised</span> <span class="n">default</span> <span class="n">router</span> <span class="n">preference</span> <span class="ow">is</span> <span class="n">Medium</span>
  <span class="n">Hosts</span> <span class="n">use</span> <span class="n">stateless</span> <span class="n">autoconfig</span> <span class="k">for</span> <span class="n">addresses</span><span class="o">.</span>
</pre></div>
</div>
<p>Use the ipv6 address autoconfig command on VLAN 1 to obtain an IPv6 address through SLAAC</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">S1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># interface vlan 1</span>
<span class="n">S1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ipv6 address autoconfig</span>
<span class="n">S1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># end</span>
</pre></div>
</div>
<p>Use the <code class="docutils literal"><span class="pre">show</span> <span class="pre">ipv6</span> <span class="pre">interface</span></code> command to verify that SLAAC provided a unicast address to VLAN1 on S1.</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">S1</span><span class="c1"># show ipv6 interface</span>
<span class="n">Vlan1</span> <span class="ow">is</span> <span class="n">up</span><span class="p">,</span> <span class="n">line</span> <span class="n">protocol</span> <span class="ow">is</span> <span class="n">up</span>
  <span class="n">IPv6</span> <span class="ow">is</span> <span class="n">enabled</span><span class="p">,</span> <span class="n">link</span><span class="o">-</span><span class="n">local</span> <span class="n">address</span> <span class="ow">is</span> <span class="n">FE80</span><span class="p">::</span><span class="n">ED9</span><span class="p">:</span><span class="mi">96</span><span class="n">FF</span><span class="p">:</span><span class="n">FEE8</span><span class="p">:</span><span class="mi">8</span><span class="n">A40</span>
  <span class="n">No</span> <span class="n">Virtual</span> <span class="n">link</span><span class="o">-</span><span class="n">local</span> <span class="n">address</span><span class="p">(</span><span class="n">es</span><span class="p">):</span>
  <span class="n">Stateless</span> <span class="n">address</span> <span class="n">autoconfig</span> <span class="n">enabled</span>
  <span class="n">Global</span> <span class="n">unicast</span> <span class="n">address</span><span class="p">(</span><span class="n">es</span><span class="p">):</span>
    <span class="mi">2001</span><span class="p">:</span><span class="n">DB8</span><span class="p">:</span><span class="n">ACAD</span><span class="p">:</span><span class="n">A</span><span class="p">:</span><span class="n">ED9</span><span class="p">:</span><span class="mi">96</span><span class="n">FF</span><span class="p">:</span><span class="n">FEE8</span><span class="p">:</span><span class="mi">8</span><span class="n">A40</span><span class="p">,</span> <span class="n">subnet</span> <span class="ow">is</span> <span class="mi">2001</span><span class="p">:</span><span class="n">DB8</span><span class="p">:</span><span class="n">ACAD</span><span class="p">:</span><span class="n">A</span><span class="p">::</span><span class="o">/</span><span class="mi">64</span> <span class="p">[</span><span class="n">EUI</span><span class="o">/</span><span class="n">CAL</span><span class="o">/</span><span class="n">PRE</span><span class="p">]</span>
      <span class="n">valid</span> <span class="n">lifetime</span> <span class="mi">2591988</span> <span class="n">preferred</span> <span class="n">lifetime</span> <span class="mi">604788</span>
  <span class="n">Joined</span> <span class="n">group</span> <span class="n">address</span><span class="p">(</span><span class="n">es</span><span class="p">):</span>
    <span class="n">FF02</span><span class="p">::</span><span class="mi">1</span>
    <span class="n">FF02</span><span class="p">::</span><span class="mi">1</span><span class="p">:</span><span class="n">FFE8</span><span class="p">:</span><span class="mi">8</span><span class="n">A40</span>
  <span class="n">MTU</span> <span class="ow">is</span> <span class="mi">1500</span> <span class="nb">bytes</span>
  <span class="n">ICMP</span> <span class="n">error</span> <span class="n">messages</span> <span class="n">limited</span> <span class="n">to</span> <span class="n">one</span> <span class="n">every</span> <span class="mi">100</span> <span class="n">milliseconds</span>
  <span class="n">ICMP</span> <span class="n">redirects</span> <span class="n">are</span> <span class="n">enabled</span>
  <span class="n">ICMP</span> <span class="n">unreachables</span> <span class="n">are</span> <span class="n">sent</span>
  <span class="n">Output</span> <span class="n">features</span><span class="p">:</span> <span class="n">Check</span> <span class="n">hwidb</span>
  <span class="n">ND</span> <span class="n">DAD</span> <span class="ow">is</span> <span class="n">enabled</span><span class="p">,</span> <span class="n">number</span> <span class="n">of</span> <span class="n">DAD</span> <span class="n">attempts</span><span class="p">:</span> <span class="mi">1</span>
  <span class="n">ND</span> <span class="n">reachable</span> <span class="n">time</span> <span class="ow">is</span> <span class="mi">30000</span> <span class="n">milliseconds</span> <span class="p">(</span><span class="n">using</span> <span class="mi">30000</span><span class="p">)</span>
  <span class="n">ND</span> <span class="n">NS</span> <span class="n">retransmit</span> <span class="n">interval</span> <span class="ow">is</span> <span class="mi">1000</span> <span class="n">milliseconds</span>
  <span class="n">Default</span> <span class="n">router</span> <span class="ow">is</span> <span class="n">FE80</span><span class="p">::</span><span class="mi">1</span> <span class="n">on</span> <span class="n">Vlan1</span>
</pre></div>
</div>
<p>Configure an IPv6 stateless DHCP server on R1.</p>
<ol class="loweralpha simple">
<li><dl class="first docutils">
<dt>Create an IPv6 DHCP pool.</dt>
<dd><code class="docutils literal"><span class="pre">R1(config)#</span> <span class="pre">ipv6</span> <span class="pre">dhcp</span> <span class="pre">pool</span> <span class="pre">IPV6POOL-A</span></code></dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Assign a domain name to the pool.</dt>
<dd><code class="docutils literal"><span class="pre">R1(config-dhcpv6)#</span> <span class="pre">domain-name</span> <span class="pre">ccna-statelessDHCPv6.com</span></code></dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Assign a DNS server address.</dt>
<dd><code class="docutils literal"><span class="pre">R1(config-dhcpv6)#</span> <span class="pre">dns-server</span> <span class="pre">2001:db8:acad:a::abcd</span></code>
<code class="docutils literal"><span class="pre">R1(config-dhcpv6)#</span> <span class="pre">exit</span></code></dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Assign the DHCPv6 pool to the interface.</dt>
<dd><code class="docutils literal"><span class="pre">R1(config)#</span> <span class="pre">interface</span> <span class="pre">g0/1</span></code>
<code class="docutils literal"><span class="pre">R1(config-if)#</span> <span class="pre">ipv6</span> <span class="pre">dhcp</span> <span class="pre">server</span> <span class="pre">IPV6POOL-A</span></code></dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Set the DHCPv6 network discovery (ND) other-config-flag.</dt>
<dd><code class="docutils literal"><span class="pre">R1(config-if)#</span> <span class="pre">ipv6</span> <span class="pre">nd</span> <span class="pre">other-config-flag</span></code>
<code class="docutils literal"><span class="pre">R1(config-if)#</span> <span class="pre">end</span></code></dd>
</dl>
</li>
</ol>
<p>Configure an IPv6 stateful DHCP server on R1.</p>
<ol class="loweralpha">
<li><dl class="first docutils">
<dt>Add the network prefix to the pool</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">R1(config)#</span> <span class="pre">ipv6</span> <span class="pre">dhcp</span> <span class="pre">pool</span> <span class="pre">IPV6POOL-A</span></code>
<code class="docutils literal"><span class="pre">R1(config-dhcpv6)#</span> <span class="pre">address</span> <span class="pre">prefix</span> <span class="pre">2001:db8:acad:a::/64</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Change domain name to ccna-statefulDHCPv6.com</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">R1(config-dhcpv6)#</span> <span class="pre">no</span> <span class="pre">domain-name</span> <span class="pre">ccna-statelessDHCPv6.com</span></code>
<code class="docutils literal"><span class="pre">R1(config-dhcpv6)#</span> <span class="pre">domain-name</span> <span class="pre">ccna-statefulDHCPv6.com</span></code>
<code class="docutils literal"><span class="pre">R1(config-dhcpv6)#</span> <span class="pre">end</span></code></p>
</dd>
</dl>
</li>
<li><p class="first">Verify DHCPv6 pool settings</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="c1"># show ipv6 dhcp pool</span>
<span class="n">DHCPv6</span> <span class="n">pool</span><span class="p">:</span> <span class="n">IPV6POOL</span><span class="o">-</span><span class="n">A</span>
  <span class="n">Address</span> <span class="n">allocation</span> <span class="n">prefix</span><span class="p">:</span> <span class="mi">2001</span><span class="p">:</span><span class="n">DB8</span><span class="p">:</span><span class="n">ACAD</span><span class="p">:</span><span class="n">A</span><span class="p">::</span><span class="o">/</span><span class="mi">64</span> <span class="n">valid</span> <span class="mi">172800</span> <span class="n">preferred</span> <span class="mi">86400</span> <span class="p">(</span><span class="mi">0</span> <span class="ow">in</span> <span class="n">use</span><span class="p">,</span> <span class="mi">0</span> <span class="n">conflicts</span><span class="p">)</span>
  <span class="n">DNS</span> <span class="n">server</span><span class="p">:</span> <span class="mi">2001</span><span class="p">:</span><span class="n">DB8</span><span class="p">:</span><span class="n">ACAD</span><span class="p">:</span><span class="n">A</span><span class="p">::</span><span class="n">ABCD</span>
  <span class="n">Domain</span> <span class="n">name</span><span class="p">:</span> <span class="n">ccna</span><span class="o">-</span><span class="n">StatefulDHCPv6</span><span class="o">.</span><span class="n">com</span>
  <span class="n">Active</span> <span class="n">clients</span><span class="p">:</span> <span class="mi">0</span>
</pre></div>
</div>
</li>
<li><dl class="first docutils">
<dt>Enter debug mode to verify the stateful DHCPv6 address assignment</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">R1#</span> <span class="pre">debug</span> <span class="pre">ipv6</span> <span class="pre">dhcp</span> <span class="pre">detail</span></code>
``  IPv6 DHCP debugging is on (detailed)``</p>
</dd>
</dl>
</li>
</ol>
<p>Set the flag on G0/1 for stateful DHCPv6</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Shutting down the G0/1 interface before making changes ensures that an RA message is sent when the interface is activated.</p>
</div>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># interface g0/1</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># shutdown</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ipv6 nd managed-config-flag</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># no shutdown</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># end</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Enable interface F0/6 on S1</dt>
<dd><p class="first">Now that R1 is configured for stateful dhcpv6 you can reconnect PC-A to the nw by activating f0/6 on s1</p>
<div class="code last highlight-default"><div class="highlight"><pre><span></span><span class="n">S1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># interface f0/6</span>
<span class="n">S1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># no shutdown</span>
<span class="n">S1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># end</span>
</pre></div>
</div>
</dd>
</dl>
<p>verify</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="c1"># show ipv6 dhcp pool</span>
<span class="n">DHCPv6</span> <span class="n">pool</span><span class="p">:</span> <span class="n">IPV6POOL</span><span class="o">-</span><span class="n">A</span>
  <span class="n">Address</span> <span class="n">allocation</span> <span class="n">prefix</span><span class="p">:</span> <span class="mi">2001</span><span class="p">:</span><span class="n">DB8</span><span class="p">:</span><span class="n">ACAD</span><span class="p">:</span><span class="n">A</span><span class="p">::</span><span class="o">/</span><span class="mi">64</span> <span class="n">valid</span> <span class="mi">172800</span> <span class="n">preferred</span> <span class="mi">86400</span> <span class="p">(</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">use</span><span class="p">,</span> <span class="mi">0</span> <span class="n">conflicts</span><span class="p">)</span>
  <span class="n">DNS</span> <span class="n">server</span><span class="p">:</span> <span class="mi">2001</span><span class="p">:</span><span class="n">DB8</span><span class="p">:</span><span class="n">ACAD</span><span class="p">:</span><span class="n">A</span><span class="p">::</span><span class="n">ABCD</span>
  <span class="n">Domain</span> <span class="n">name</span><span class="p">:</span> <span class="n">ccna</span><span class="o">-</span><span class="n">StatefulDHCPv6</span><span class="o">.</span><span class="n">com</span>
  <span class="n">Active</span> <span class="n">clients</span><span class="p">:</span> <span class="mi">1</span>


<span class="n">R1</span><span class="c1"># show ipv6 dhcp binding</span>
<span class="n">Client</span><span class="p">:</span> <span class="n">FE80</span><span class="p">::</span><span class="n">D428</span><span class="p">:</span><span class="mi">7</span><span class="n">DE2</span><span class="p">:</span><span class="mi">997</span><span class="n">C</span><span class="p">:</span><span class="n">B05A</span>
  <span class="n">DUID</span><span class="p">:</span> <span class="mi">0001000117</span><span class="n">F6723D000C298D5444</span>
  <span class="n">Username</span> <span class="p">:</span> <span class="n">unassigned</span>
  <span class="n">IA</span> <span class="n">NA</span><span class="p">:</span> <span class="n">IA</span> <span class="n">ID</span> <span class="mh">0x0E000C29</span><span class="p">,</span> <span class="n">T1</span> <span class="mi">43200</span><span class="p">,</span> <span class="n">T2</span> <span class="mi">69120</span>
    <span class="n">Address</span><span class="p">:</span> <span class="mi">2001</span><span class="p">:</span><span class="n">DB8</span><span class="p">:</span><span class="n">ACAD</span><span class="p">:</span><span class="n">A</span><span class="p">:</span><span class="n">B55C</span><span class="p">:</span><span class="mi">8519</span><span class="p">:</span><span class="mi">8915</span><span class="p">:</span><span class="mi">57</span><span class="n">CE</span>
            <span class="n">preferred</span> <span class="n">lifetime</span> <span class="mi">86400</span><span class="p">,</span> <span class="n">valid</span> <span class="n">lifetime</span> <span class="mi">172800</span>
            <span class="n">expires</span> <span class="n">at</span> <span class="n">Mar</span> <span class="mi">07</span> <span class="mi">2013</span> <span class="mi">04</span><span class="p">:</span><span class="mi">09</span> <span class="n">PM</span> <span class="p">(</span><span class="mi">171595</span> <span class="n">seconds</span><span class="p">)</span>
<span class="n">R1</span><span class="c1"># u all</span>
<span class="n">All</span> <span class="n">possible</span> <span class="n">debugging</span> <span class="n">has</span> <span class="n">been</span> <span class="n">turned</span> <span class="n">off</span>
</pre></div>
</div>
<p>Stateful DHCPv6 uses more memory resources. Stateful DHCPv6 requires the router to store dynamic state information about the DHCPv6 clients. Stateless DHCPv6 clients do not use the DHCP server to obtain address information, so this information does not need to be stored.</p>
<p>Which type of dynamic IPv6 address assignment is recommended by Cisco, Stateless DHCPv6 or Stateful DHCPv6?
Cisco recommends Stateless DHCPv6 when implementing and deploying IPv6 networks without a Cisco Network Registar (CNR)</p>
</div>
<div class="section" id="dhcpv6-troubleshooting-tasks">
<h2>DHCPv6 Troubleshooting Tasks<a class="headerlink" href="#dhcpv6-troubleshooting-tasks" title="Permalink to this headline">Â¶</a></h2>
<ol class="arabic">
<li><dl class="first docutils">
<dt>Resolve address conflicts</dt>
<dd><p class="first last">The <code class="docutils literal"><span class="pre">show</span> <span class="pre">ipv6</span> <span class="pre">dhcp</span> <span class="pre">conflict</span></code> command displays all address conflicts recorded by the stateful DHCPv6 server. If an address conflict is detected, the client typically removes the address and generates a new address using either SLAAC or stateful DHCPv6.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Verify allocation method</dt>
<dd><p class="first last">the <code class="docutils literal"><span class="pre">show</span> <span class="pre">ipv6</span> <span class="pre">interface</span> <span class="pre">g0/0</span></code> command can be used to verify the method of address allocation indicated in the RA message as indicated by the settings of the M and O flags. This information is displayed in the last lines of the output. If a client is not receiving its IPv6 address information from a stateful DHCPv6 server, it could be due to incorrect M and O flags in the RA message.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Test with a static IPv6 address</dt>
<dd><p class="first last">In the case of IPv6, if the workstation is unable to reach network resources with a statically configured IPv6 address, the root cause of the problem is not SLAAC or DHCPv6. At this point, network connectivity troubleshooting is required.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Verify switch port configuration</dt>
<dd><p class="first">If the DHCPv6 client is unable to obtain information from a DHCPv6 server, verify that the switch port is enabled and is operating correctly.
In linux do a manual <code class="docutils literal"><span class="pre">sudo</span> <span class="pre">dhclient</span> <span class="pre">-6</span></code></p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If there is a switch between the client and the DHCPv6 server, and the client is unable to obtain the DHCP configuration, switch port configuration issues may be the cause. These causes may include issues related to trunking, channeling, or spanning tree. <strong>PortFast and edge port</strong> configurations resolve the most common DHCPv6 client issues that occur with an initial installation of a Cisco switch.</p>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Test DHCPv6 Operation on the same subnet or VLAN</dt>
<dd><p class="first last">If the stateless or stateful DHCPv6 server is functioning correctly, but is on a different IPv6 network or VLAN than the client, the problem may be with the DHCPv6 relay agent. The <strong>client facing interface</strong> on the router must be configured with the <code class="docutils literal"><span class="pre">ipv6</span> <span class="pre">dhcp</span> <span class="pre">relay</span> <span class="pre">destination</span></code> command.</p>
</dd>
</dl>
</li>
</ol>
<img alt="../../../_images/verify_router_dhcpv6_config1.png" src="../../../_images/verify_router_dhcpv6_config1.png" />
<img alt="../../../_images/verify_router_dhcpv6_config2.png" src="../../../_images/verify_router_dhcpv6_config2.png" />
<p><code class="docutils literal"><span class="pre">R1#</span> <span class="pre">debug</span> <span class="pre">ipv6</span> <span class="pre">dhcp</span> <span class="pre">detail</span></code></p>
</div>
<div class="section" id="ch8-lab-troubleshooting-dhcpv6">
<h2>Ch8 Lab Troubleshooting DHCPv6<a class="headerlink" href="#ch8-lab-troubleshooting-dhcpv6" title="Permalink to this headline">Â¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="13%" />
<col width="36%" />
<col width="18%" />
<col width="23%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Device</th>
<th class="head">Interface</th>
<th class="head">IPv6 Address</th>
<th class="head">Prefix Length</th>
<th class="head">Default Gateway</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>R1</td>
<td>G0/1</td>
<td>2001:DB8:ACAD:A::1</td>
<td>64</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>S1</td>
<td>VLAN 1</td>
<td>Assigned by SLAAC</td>
<td>64</td>
<td>Assigned by SLAAC</td>
</tr>
<tr class="row-even"><td>PC-A</td>
<td>NIC</td>
<td>Assigned by SLAAC and DHCPv6</td>
<td>64</td>
<td>Assigned by SLAAC</td>
</tr>
</tbody>
</table>
<img alt="../../../_images/Ch8_8.2.4.4_TB_DHCPv6.png" src="../../../_images/Ch8_8.2.4.4_TB_DHCPv6.png" />
<div class="section" id="part-1-build-nw-and-configure-basic-settings">
<h3>Part 1 Build NW and configure basic settings<a class="headerlink" href="#part-1-build-nw-and-configure-basic-settings" title="Permalink to this headline">Â¶</a></h3>
<p>cable as show in topology, intitialize and reload the router n switch
.. code:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="c1"># show sdm prefer</span>
</pre></div>
</div>
<p>Follow this configuration to assign the dual-ipv4-and-ipv6 template as the default SDM template:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">S1</span><span class="c1"># config t</span>
<span class="n">S1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># sdm prefer dual-ipv4-and-ipv6 default</span>
<span class="n">S1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># end</span>
<span class="n">S1</span><span class="c1"># reload</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Required Resources</dt>
<dd><ul class="first last simple">
<li>1 Router (Cisco 1941 with Cisco IOS Release 15.2(4)M3 universal image or comparable)</li>
<li>1 Switch (Cisco 2960 with Cisco IOS Release 15.0(2) lanbasek9 image or comparable)</li>
<li>PC (Linux, donât bother with Windows)</li>
<li>Console cables to configure the Cisco IOS devices via the console ports</li>
<li>Ethernet cables as shown in the topology</li>
</ul>
</dd>
</dl>
<ol class="loweralpha simple">
<li>Disable DNS lookup.</li>
<li>Configure device names as shown in the topology.</li>
<li>Encrypt plain text passwords.</li>
<li>Create a MOTD banner warning users that unauthorized access is prohibited.</li>
<li>Assign class as the encrypted privileged EXEC mode password.</li>
<li>Assign cisco as the console and vty passwords and enable login.</li>
<li>Configure logging synchronous to prevent console messages from interrupting command entry.</li>
</ol>
<p>Load the IPv6 configuration to R1</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">ip</span> <span class="n">domain</span> <span class="n">name</span> <span class="n">ccna</span><span class="o">-</span><span class="n">lab</span><span class="o">.</span><span class="n">com</span>
<span class="n">ipv6</span> <span class="n">dhcp</span> <span class="n">pool</span> <span class="n">IPV6POOL</span><span class="o">-</span><span class="n">A</span>
 <span class="n">dns</span><span class="o">-</span><span class="n">server</span> <span class="mi">2001</span><span class="p">:</span><span class="n">DB8</span><span class="p">:</span><span class="n">ACAD</span><span class="p">:</span><span class="n">CAFE</span><span class="p">::</span><span class="n">A</span>
 <span class="n">domain</span><span class="o">-</span><span class="n">name</span> <span class="n">ccna</span><span class="o">-</span><span class="n">lab</span><span class="o">.</span><span class="n">com</span>
<span class="n">interface</span> <span class="n">g0</span><span class="o">/</span><span class="mi">0</span>
 <span class="n">no</span> <span class="n">ip</span> <span class="n">address</span>
 <span class="n">shutdown</span>
 <span class="n">duplex</span> <span class="n">auto</span>
 <span class="n">speed</span> <span class="n">auto</span>
<span class="n">interface</span> <span class="n">g0</span><span class="o">/</span><span class="mi">1</span>
 <span class="n">no</span> <span class="n">ip</span> <span class="n">address</span>
 <span class="n">duplex</span> <span class="n">auto</span>
 <span class="n">speed</span> <span class="n">auto</span>
 <span class="n">ipv6</span> <span class="n">address</span> <span class="n">FE80</span><span class="p">::</span><span class="mi">1</span> <span class="n">link</span><span class="o">-</span><span class="n">local</span>
 <span class="n">ipv6</span> <span class="n">address</span> <span class="mi">2001</span><span class="p">:</span><span class="n">DB8</span><span class="p">:</span><span class="n">ACAD</span><span class="p">:</span><span class="n">A</span><span class="p">::</span><span class="mi">11</span><span class="o">/</span><span class="mi">64</span>
<span class="n">end</span>
</pre></div>
</div>
<p>Load the IPv6 configuration to S1.</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">interface</span> <span class="nb">range</span> <span class="n">f0</span><span class="o">/</span><span class="mi">1</span><span class="o">-</span><span class="mi">24</span>
 <span class="n">shutdown</span>
<span class="n">interface</span> <span class="nb">range</span> <span class="n">g0</span><span class="o">/</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span>
 <span class="n">shutdown</span>
<span class="n">interface</span> <span class="n">Vlan1</span>
 <span class="n">shutdown</span>
<span class="n">end</span>
</pre></div>
</div>
<p>Save the running configurations on R1 and S1
Verify that IPv6 is enabled on PC-A
Verify that IPv6 has been enabled in the Local Area Connection Properties window on PC-A</p>
</div>
<div class="section" id="part-2-troubleshoot-ipv6-connectivity">
<h3>Part 2 Troubleshoot IPv6 connectivity<a class="headerlink" href="#part-2-troubleshoot-ipv6-connectivity" title="Permalink to this headline">Â¶</a></h3>
<p>you will test and verify Layer 3 IPv6 connectivity on the network</p>
<p>Continue troubleshooting the network until Layer 3 connectivity has been established on all devices. Do not continue to Part 3
until you have succe ssfully completed Part 2</p>
<dl class="docutils">
<dt>Troubleshoot IPv6 interfaces on R1</dt>
<dd><ol class="first last loweralpha simple">
<li>According to the topology, which interface must be active on R1 for network connectivity to be established?  Record any commands used to identify which interfaces are active.</li>
<li>If necessary, take the steps required to bring up the interface. Record the commands used to correct the configuration errors and verify that the interface is active.</li>
<li>Identify the IPv6 addresses configured on R1. Record the address es found and the commands used to view the IPv6 addresses.</li>
<li>Determine if a configuration error has been made. If any errors are identified, record all the commands used to correct the configuration.</li>
<li>On R1, what multicast group is needed for SLAAC to function?</li>
<li>What command is used to verify that R1 is a member of that group?</li>
<li>If R1 is not a member of the multicast group that is needed for SLAAC to function correctly, make the necessary changes to the configuration so that it joins the group. Record any commands necessary to correct the configurations errors.</li>
<li>Re-issue the command to verify that interface G0/1 has joined the all-routers multicast group (FF02::2).</li>
</ol>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you are unable to join the all-routers multicast group, you may need to save your current configuration and reload the router.</p>
</div>
<dl class="docutils">
<dt>Troubleshoot S1</dt>
<dd><ol class="first last loweralpha simple">
<li>Are the interfaces needed for network connectivity active on S1?  Record any commands that are used to activate necessary interfaces on S1</li>
<li>What command could you use to determine if an IPv6 unicast address has been assigned to S1?</li>
<li>Does S1 have an IPv6 unicast address configured? If so, what is it?</li>
<li>If S1 is not receiving a SLAAC address, make the necessary configuration changes to allow it to receive one. Record the commands used.</li>
<li>Re-issue the command that verifies that the interface now receives a SLAAC address.</li>
<li>Can S1 ping the IPv6 unicast address assigned to the G0/1 interface assigned to R1?</li>
</ol>
</dd>
<dt>Troubleshoot PC-A</dt>
<dd><ol class="first loweralpha simple">
<li>Issue the command used on PC-A to verify the IPv6 address assigned. Record the command</li>
<li>What is the IPv6 unicast address SLAAC is providing to PC-A?</li>
<li>Can PC-A ping th e default gateway address that was assigned by SLAAC?</li>
<li>Can PC-A ping the management interface on S1?</li>
</ol>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Continue troubleshooting until you can ping R1 and S1 from PC-A</p>
</div>
</dd>
</dl>
</div>
<div class="section" id="part-3-troubleshoot-stateless-dhcpv6">
<h3>Part 3 Troubleshoot Stateless DHCPv6<a class="headerlink" href="#part-3-troubleshoot-stateless-dhcpv6" title="Permalink to this headline">Â¶</a></h3>
<p>You will test and verify that Stateless DHCPv6 is working correctly on the network. You will need to use the correct IPv6 CLI commands on the router to determine if Stateless DHCPv6 is working. You may want to use <strong>debug</strong> to help determine if the DHCP server is being solicited.</p>
<dl class="docutils">
<dt>Determine if Stateless DHCPv6 is functioning correctly.</dt>
<dd><ol class="first last loweralpha simple">
<li>What is the name of the IPv6 DHCP pool? How did you determine this?</li>
<li>What network information is listed in the DHCPv6 pool?</li>
<li>Was the DHCPv6 information assigned to PC-A?  How did you determine this?</li>
</ol>
</dd>
<dt>Troubleshoot R1</dt>
<dd><ol class="first last loweralpha simple">
<li>What commands can be used to determine if R1 is configured for Stateless DHCPv6?</li>
<li>Is the G0/1 interface on R1 in Stateless DHCPv6 mode?</li>
<li>What command can be used to have R1 join the all-DHCPv6 server group?</li>
<li>Verify that the all-DHCPv6 server group is configured for interface G0/1.</li>
<li>Will PC-A receive the DHCP information now? Explain?</li>
<li>What is missing from the configuration of G0/1 that causes hosts to use the DCHP server to retrieve other network information?</li>
<li>Reset the IPv6 settings on PC-A
1) Open the Local Area Connection Properties window, deselect the Internet Protocol Version 6 (TCP/IPv6) check box, and then click OK to accept the change.
2) Open the Local Area Connection Properties window again, click the Internet Protocol Version 6 (TCP/IPv6) check box, and then click OK to accept the change.</li>
<li>Issue the command to verify changes have been made on PC-A.
Continue troubleshooting until PC-A receives the additional DHCP information from R1</li>
</ol>
</dd>
<dt>Reflection</dt>
<dd><ol class="first last arabic simple">
<li>What command is needed in the DHCPv6 pool for Stateful DHCPv6 that is not needed for Stateless DHCPv6? Why?</li>
<li>What command is needed on the interface to change the network to use Stateful DHCPv6 instead of Stateless DHCPv6?</li>
</ol>
</dd>
</dl>
</div>
</div>
<div class="section" id="ch8-8-3-1-2-skills-integration-challenge-dhcpv4">
<h2>Ch8 8.3.1.2 Skills Integration Challenge DHCPv4<a class="headerlink" href="#ch8-8-3-1-2-skills-integration-challenge-dhcpv4" title="Permalink to this headline">Â¶</a></h2>
<img alt="../../../_images/ch8_skills_integration_challenge.png" src="../../../_images/ch8_skills_integration_challenge.png" />
<div class="section" id="addressing-table">
<h3>Addressing Table<a class="headerlink" href="#addressing-table" title="Permalink to this headline">Â¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="16%" />
<col width="22%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Device</th>
<th class="head">Interface</th>
<th class="head">IP Address</th>
<th class="head">Subnet Mask</th>
<th class="head">Default Gateway</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>&#160;</td>
<td>G0/0.10</td>
<td>172.31.10.1</td>
<td>255.255.255.224</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>G0/0.20</td>
<td>172.31.20.1</td>
<td>255.255.255.240</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>R1</td>
<td>G0/0.30</td>
<td>172.31.30.1</td>
<td>255.255.255.128</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>G0/0.40</td>
<td>172.31.40.1</td>
<td>255.255.255.192</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>G0/1</td>
<td>DHCP Assigned</td>
<td>DHCP Assigned</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>PC1</td>
<td>NIC</td>
<td>DHCP Assigned</td>
<td>DHCP Assigned</td>
<td>DHCP Assigned</td>
</tr>
<tr class="row-even"><td>PC2</td>
<td>NIC</td>
<td>DHCP Assigned</td>
<td>DHCP Assigned</td>
<td>DHCP Assigned</td>
</tr>
<tr class="row-odd"><td>PC3</td>
<td>NIC</td>
<td>DHCP Assigned</td>
<td>DHCP Assigned</td>
<td>DHCP Assigned</td>
</tr>
<tr class="row-even"><td>PC4</td>
<td>NIC</td>
<td>DHCP Assigned</td>
<td>DHCP Assigned</td>
<td>DHCP Assigned</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="vlan-port-assignments-and-dhcp-information">
<h3>VLAN Port Assignments and DHCP Information<a class="headerlink" href="#vlan-port-assignments-and-dhcp-information" title="Permalink to this headline">Â¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="31%" />
<col width="23%" />
<col width="23%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Ports</th>
<th class="head">VLAN Number - Name</th>
<th class="head">DHCP Pool Name</th>
<th class="head">Network</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Fa0/5 â 0/9</td>
<td>VLAN 10 - Sales</td>
<td>VLAN_10</td>
<td>172.31.10.0/27</td>
</tr>
<tr class="row-odd"><td>Fa0/10 â Fa0/14</td>
<td>VLAN 20 - Production</td>
<td>VLAN_20</td>
<td>172.31.20.0/28</td>
</tr>
<tr class="row-even"><td>Fa0/15 â Fa0/19</td>
<td>VLAN 30 - Marketing</td>
<td>VLAN_30</td>
<td>172.31.30.0/25</td>
</tr>
<tr class="row-odd"><td>Fa0/20 â Fa0/24</td>
<td>VLAN 40 - HR</td>
<td>VLAN_40</td>
<td>172.31.40.0/26</td>
</tr>
</tbody>
</table>
<p>Configure VLANs, trunks, DHCP Server, DHCP relay agents, and configure a router as a DHCP client</p>
<ul class="simple">
<li>Create VLANs on S2 and assign VLANs to appropriate ports. Names are case-sensitive</li>
<li>Configure S2 ports for trunking.</li>
<li>Configure all non-trunk ports on S2 as access ports.</li>
<li>Configure R1 to route between VLANs. Subinterface names should match the VLAN number.</li>
<li>Configure R1 to act as a DHCP server for the VLANs attached to S2.<ul>
<li>Create a DHCP pool for each VLAN. Names are case-sensitive.</li>
<li>Assign the appropriate addresses to each pool.</li>
<li>Configure DHCP to provide the default gateway address</li>
<li>Configure the DNS server 209.165.201.14 for each pool.</li>
<li>Prevent the first 10 addresses from each pool from being distributed to end devices.</li>
</ul>
</li>
<li>Verify that each PC has an address assigned from the correct DHCP pool.
Note: DHCP address assignments may take some time. Click Fast Forward Time to speed up the process.</li>
<li>Configure R1 as a DHCP client so that it receives an IP address from the ISP network.</li>
<li>Verify all devices can now ping each other and www.cisco.pka</li>
</ul>
<p>Solution</p>
<p>R1</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="o">&gt;</span><span class="n">en</span>
<span class="n">R1</span><span class="c1">#conf t</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#interface G0/0</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1">#no shutdown</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1">#</span>
<span class="o">%</span><span class="n">LINK</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="n">CHANGED</span><span class="p">:</span> <span class="n">Interface</span> <span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span> <span class="n">changed</span> <span class="n">state</span> <span class="n">to</span> <span class="n">up</span>
<span class="o">%</span><span class="n">LINEPROTO</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="n">UPDOWN</span><span class="p">:</span> <span class="n">Line</span> <span class="n">protocol</span> <span class="n">on</span> <span class="n">Interface</span> <span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span> <span class="n">changed</span> <span class="n">state</span> <span class="n">to</span> <span class="n">up</span>

<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1">#interface G0/0.10</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">subif</span><span class="p">)</span><span class="c1">#</span>
<span class="o">%</span><span class="n">LINK</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="n">CHANGED</span><span class="p">:</span> <span class="n">Interface</span> <span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mf">0.10</span><span class="p">,</span> <span class="n">changed</span> <span class="n">state</span> <span class="n">to</span> <span class="n">up</span>
<span class="o">%</span><span class="n">LINEPROTO</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="n">UPDOWN</span><span class="p">:</span> <span class="n">Line</span> <span class="n">protocol</span> <span class="n">on</span> <span class="n">Interface</span> <span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mf">0.10</span><span class="p">,</span> <span class="n">changed</span> <span class="n">state</span> <span class="n">to</span> <span class="n">up</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">subif</span><span class="p">)</span><span class="c1">#encapsulation dot1Q 10</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">subif</span><span class="p">)</span><span class="c1">#ip address 172.31.10.1 255.255.255.224</span>

<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">subif</span><span class="p">)</span><span class="c1">#interface G0/0.20</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">subif</span><span class="p">)</span><span class="c1">#</span>
<span class="o">%</span><span class="n">LINK</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="n">CHANGED</span><span class="p">:</span> <span class="n">Interface</span> <span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mf">0.20</span><span class="p">,</span> <span class="n">changed</span> <span class="n">state</span> <span class="n">to</span> <span class="n">up</span>
<span class="o">%</span><span class="n">LINEPROTO</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="n">UPDOWN</span><span class="p">:</span> <span class="n">Line</span> <span class="n">protocol</span> <span class="n">on</span> <span class="n">Interface</span> <span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mf">0.20</span><span class="p">,</span> <span class="n">changed</span> <span class="n">state</span> <span class="n">to</span> <span class="n">up</span>
<span class="n">encapsulation</span> <span class="n">dot1Q</span> <span class="mi">20</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">subif</span><span class="p">)</span><span class="c1">#encapsulation dot1Q 20</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">subif</span><span class="p">)</span><span class="c1">#ip address 172.31.20.1 255.255.255.240</span>

<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">subif</span><span class="p">)</span><span class="c1">#interface G0/0.30</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">subif</span><span class="p">)</span><span class="c1">#</span>
<span class="o">%</span><span class="n">LINK</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="n">CHANGED</span><span class="p">:</span> <span class="n">Interface</span> <span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mf">0.30</span><span class="p">,</span> <span class="n">changed</span> <span class="n">state</span> <span class="n">to</span> <span class="n">up</span>
<span class="o">%</span><span class="n">LINEPROTO</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="n">UPDOWN</span><span class="p">:</span> <span class="n">Line</span> <span class="n">protocol</span> <span class="n">on</span> <span class="n">Interface</span> <span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mf">0.30</span><span class="p">,</span> <span class="n">changed</span> <span class="n">state</span> <span class="n">to</span> <span class="n">up</span>
<span class="n">encapsulation</span> <span class="n">dot1Q</span> <span class="mi">30</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">subif</span><span class="p">)</span><span class="c1">#ip address 172.31.30.1 255.255.255.128</span>

<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">subif</span><span class="p">)</span><span class="c1">#interface G0/0.40</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">subif</span><span class="p">)</span><span class="c1">#</span>
<span class="o">%</span><span class="n">LINK</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="n">CHANGED</span><span class="p">:</span> <span class="n">Interface</span> <span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mf">0.40</span><span class="p">,</span> <span class="n">changed</span> <span class="n">state</span> <span class="n">to</span> <span class="n">up</span>
<span class="o">%</span><span class="n">LINEPROTO</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="n">UPDOWN</span><span class="p">:</span> <span class="n">Line</span> <span class="n">protocol</span> <span class="n">on</span> <span class="n">Interface</span> <span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mf">0.40</span><span class="p">,</span> <span class="n">changed</span> <span class="n">state</span> <span class="n">to</span> <span class="n">up</span>
<span class="n">encapsulation</span> <span class="n">dot1Q</span> <span class="mi">40</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">subif</span><span class="p">)</span><span class="c1">#ip address 172.31.40.1 255.255.255.192</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">subif</span><span class="p">)</span><span class="c1">#exit</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#</span>
</pre></div>
</div>
<p>Configure R1 G0/1 as DHCP client</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#interface G0/1</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1">#ip address dhcp</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1">#no shutdown</span>
<span class="o">%</span><span class="n">LINK</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="n">CHANGED</span><span class="p">:</span> <span class="n">Interface</span> <span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span> <span class="n">changed</span> <span class="n">state</span> <span class="n">to</span> <span class="n">up</span>
<span class="o">%</span><span class="n">LINEPROTO</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="n">UPDOWN</span><span class="p">:</span> <span class="n">Line</span> <span class="n">protocol</span> <span class="n">on</span> <span class="n">Interface</span> <span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span> <span class="n">changed</span> <span class="n">state</span> <span class="n">to</span> <span class="n">up</span>
<span class="o">%</span><span class="n">DHCP</span><span class="o">-</span><span class="mi">6</span><span class="o">-</span><span class="n">ADDRESS_ASSIGN</span><span class="p">:</span> <span class="n">Interface</span> <span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mi">1</span> <span class="n">assigned</span> <span class="n">DHCP</span> <span class="n">address</span> <span class="mf">209.165</span><span class="o">.</span><span class="mf">200.227</span><span class="p">,</span> <span class="n">mask</span> <span class="mf">255.255</span><span class="o">.</span><span class="mf">255.224</span><span class="p">,</span> <span class="n">hostname</span> <span class="n">R1</span>
</pre></div>
</div>
<p>Configure R1 as DHCPv4 server for each vlan</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#ip dhcp excluded-address 172.31.10.1 172.31.10.10</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#ip dhcp pool VLAN_10</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#network 172.31.10.0 255.255.255.224</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#dns-server 209.165.201.14</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#default-router 172.31.10.1</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#option ?</span>
  <span class="o">&lt;</span><span class="mi">0</span><span class="o">-</span><span class="mi">254</span><span class="o">&gt;</span>  <span class="n">DHCP</span> <span class="n">option</span> <span class="n">code</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#exit</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#ip dhcp excluded-address 172.31.20.1 172.31.20.10</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#ip dhcp pool VLAN_20</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#network 172.31.20.0 255.255.255.240</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#default-router 172.31.20.1</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#dns-server 209.165.201.14</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#exit</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#ip dhcp excluded-address 172.31.30.1 172.31.30.10</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#ip dhcp pool VLAN_30</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#default-router 172.31.30.1</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#dns-server 209.165.201.14</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#network 172.31.30.0 255.255.255.128</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#exit</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#ip dhcp excluded-address 172.31.40.1 172.31.40.10</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#ip dhcp pool VLAN_40</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#network 172.31.40.0 255.255.255.192</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#default-router 172.31.40.1</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#dns-server 209.165.201.14</span>
<span class="n">R1</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1">#exit</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#</span>
</pre></div>
</div>
<p>Create VLANs on S2 and assign VLANs to respective ports</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">S2</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#interface range fastEthernet 0/1 - 4</span>
<span class="n">S2</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="o">-</span><span class="nb">range</span><span class="p">)</span><span class="c1">#switchport mode trunk</span>
<span class="o">%</span><span class="n">LINEPROTO</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="n">UPDOWN</span><span class="p">:</span> <span class="n">Line</span> <span class="n">protocol</span> <span class="n">on</span> <span class="n">Interface</span> <span class="n">FastEthernet0</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">changed</span> <span class="n">state</span> <span class="n">to</span> <span class="n">down</span>
<span class="o">%</span><span class="n">LINEPROTO</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="n">UPDOWN</span><span class="p">:</span> <span class="n">Line</span> <span class="n">protocol</span> <span class="n">on</span> <span class="n">Interface</span> <span class="n">FastEthernet0</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">changed</span> <span class="n">state</span> <span class="n">to</span> <span class="n">up</span>
<span class="o">%</span><span class="n">LINEPROTO</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="n">UPDOWN</span><span class="p">:</span> <span class="n">Line</span> <span class="n">protocol</span> <span class="n">on</span> <span class="n">Interface</span> <span class="n">FastEthernet0</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">changed</span> <span class="n">state</span> <span class="n">to</span> <span class="n">down</span>
<span class="o">%</span><span class="n">LINEPROTO</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="n">UPDOWN</span><span class="p">:</span> <span class="n">Line</span> <span class="n">protocol</span> <span class="n">on</span> <span class="n">Interface</span> <span class="n">FastEthernet0</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">changed</span> <span class="n">state</span> <span class="n">to</span> <span class="n">up</span>
<span class="n">S2</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="o">-</span><span class="nb">range</span><span class="p">)</span><span class="c1">#switchport trunk allowed vlan 10,20,30,40</span>
<span class="n">S2</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#interface range fastEthernet 0/5 - 24</span>
<span class="n">S2</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="o">-</span><span class="nb">range</span><span class="p">)</span><span class="c1">#switchport mode access</span>
<span class="n">S2</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="o">-</span><span class="nb">range</span><span class="p">)</span><span class="c1">#switchport ?</span>
  <span class="n">access</span>         <span class="n">Set</span> <span class="n">access</span> <span class="n">mode</span> <span class="n">characteristics</span> <span class="n">of</span> <span class="n">the</span> <span class="n">interface</span>
  <span class="n">mode</span>           <span class="n">Set</span> <span class="n">trunking</span> <span class="n">mode</span> <span class="n">of</span> <span class="n">the</span> <span class="n">interface</span>
  <span class="n">native</span>         <span class="n">Set</span> <span class="n">trunking</span> <span class="n">native</span> <span class="n">characteristics</span> <span class="n">when</span> <span class="n">interface</span> <span class="ow">is</span> <span class="ow">in</span>
                 <span class="n">trunking</span> <span class="n">mode</span>
  <span class="n">nonegotiate</span>    <span class="n">Device</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">engage</span> <span class="ow">in</span> <span class="n">negotiation</span> <span class="n">protocol</span> <span class="n">on</span> <span class="n">this</span>
                 <span class="n">interface</span>
  <span class="n">port</span><span class="o">-</span><span class="n">security</span>  <span class="n">Security</span> <span class="n">related</span> <span class="n">command</span>
  <span class="n">priority</span>       <span class="n">Set</span> <span class="n">appliance</span> <span class="mf">802.1</span><span class="n">p</span> <span class="n">priority</span>
  <span class="n">trunk</span>          <span class="n">Set</span> <span class="n">trunking</span> <span class="n">characteristics</span> <span class="n">of</span> <span class="n">the</span> <span class="n">interface</span>
  <span class="n">voice</span>          <span class="n">Voice</span> <span class="n">appliance</span> <span class="n">attributes</span>
<span class="n">S2</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="o">-</span><span class="nb">range</span><span class="p">)</span><span class="c1">#interface range fastEthernet 0/5 - 9</span>
<span class="n">S2</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="o">-</span><span class="nb">range</span><span class="p">)</span><span class="c1">#switchport access vlan 10</span>
<span class="n">S2</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="o">-</span><span class="nb">range</span><span class="p">)</span><span class="c1">#interface range fastEthernet 0/10 - 14</span>
<span class="n">S2</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="o">-</span><span class="nb">range</span><span class="p">)</span><span class="c1">#switchport access vlan 20</span>
<span class="n">S2</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="o">-</span><span class="nb">range</span><span class="p">)</span><span class="c1">#interface range fastEthernet 0/15 - 19</span>
<span class="n">S2</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="o">-</span><span class="nb">range</span><span class="p">)</span><span class="c1">#switchport access vlan 30</span>
<span class="n">S2</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="o">-</span><span class="nb">range</span><span class="p">)</span><span class="c1">#interface range fastEthernet 0/20 - 24</span>
<span class="n">S2</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="o">-</span><span class="nb">range</span><span class="p">)</span><span class="c1">#switchport access vlan 40</span>
<span class="n">S2</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="o">-</span><span class="nb">range</span><span class="p">)</span><span class="c1">#</span>
</pre></div>
</div>
<p>running config R1</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span>R1&gt;en
R1#show run
Building configuration...

Current configuration : 1786 bytes
!
version 15.1
no service timestamps log datetime msec
no service timestamps debug datetime msec
no service password-encryption
!
hostname R1
!
!
!
!
ip dhcp excluded-address 172.31.10.1 172.31.10.10
ip dhcp excluded-address 172.31.20.1 172.31.20.10
ip dhcp excluded-address 172.31.30.1 172.31.30.10
ip dhcp excluded-address 172.31.40.1 172.31.40.10
!
ip dhcp pool VLAN_10
 network 172.31.10.0 255.255.255.224
 default-router 172.31.10.1
 dns-server 209.165.201.14
ip dhcp pool VLAN_20
 network 172.31.20.0 255.255.255.240
 default-router 172.31.20.1
 dns-server 209.165.201.14
ip dhcp pool VLAN_30
 network 172.31.30.0 255.255.255.128
 default-router 172.31.30.1
 dns-server 209.165.201.14
ip dhcp pool VLAN_40
 network 172.31.40.0 255.255.255.192
 default-router 172.31.40.1
 dns-server 209.165.201.14
!
!
!
ip cef
no ipv6 cef
!
!
!
!
license udi pid CISCO2911/K9 sn FTX1524A6QI
!
!
!
!
!
!
!
!
!
!
!
spanning-tree mode pvst
!
!
!
!
!
!
interface GigabitEthernet0/0
 no ip address
 duplex auto
 speed auto
!
interface GigabitEthernet0/0.10
 encapsulation dot1Q 10
 ip address 172.31.10.1 255.255.255.224
!
interface GigabitEthernet0/0.20
 encapsulation dot1Q 20
 ip address 172.31.20.1 255.255.255.240
!
interface GigabitEthernet0/0.30
 encapsulation dot1Q 30
 ip address 172.31.30.1 255.255.255.128
!
interface GigabitEthernet0/0.40
 encapsulation dot1Q 40
 ip address 172.31.40.1 255.255.255.192
!
interface GigabitEthernet0/1
 description Connection to ISP
 ip address dhcp
 duplex auto
 speed auto
!
interface GigabitEthernet0/2
 no ip address
 duplex auto
 speed auto
 shutdown
!
interface Vlan1
 no ip address
 shutdown
!
ip classless
ip route 0.0.0.0 0.0.0.0 GigabitEthernet0/1
!
ip flow-export version 9
!
!
!
!
!
!
!
line con 0
!
line aux 0
!
line vty 0 4
 login
!
!
!
end
</pre></div>
</div>
<p>switch2</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">S2</span><span class="c1">#show vlan brief</span>

<span class="n">VLAN</span> <span class="n">Name</span>                             <span class="n">Status</span>    <span class="n">Ports</span>
<span class="o">----</span> <span class="o">--------------------------------</span> <span class="o">---------</span> <span class="o">-------------------------------</span>
<span class="mi">1</span>    <span class="n">default</span>                          <span class="n">active</span>    <span class="n">Gig0</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span> <span class="n">Gig0</span><span class="o">/</span><span class="mi">2</span>
<span class="mi">10</span>   <span class="n">Sales</span>                            <span class="n">active</span>    <span class="n">Fa0</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">Fa0</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span> <span class="n">Fa0</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="n">Fa0</span><span class="o">/</span><span class="mi">8</span>
                                                <span class="n">Fa0</span><span class="o">/</span><span class="mi">9</span>
<span class="mi">20</span>   <span class="n">Production</span>                       <span class="n">active</span>    <span class="n">Fa0</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="n">Fa0</span><span class="o">/</span><span class="mi">11</span><span class="p">,</span> <span class="n">Fa0</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="n">Fa0</span><span class="o">/</span><span class="mi">13</span>
                                                <span class="n">Fa0</span><span class="o">/</span><span class="mi">14</span>
<span class="mi">30</span>   <span class="n">Marketing</span>                        <span class="n">active</span>    <span class="n">Fa0</span><span class="o">/</span><span class="mi">15</span><span class="p">,</span> <span class="n">Fa0</span><span class="o">/</span><span class="mi">16</span><span class="p">,</span> <span class="n">Fa0</span><span class="o">/</span><span class="mi">17</span><span class="p">,</span> <span class="n">Fa0</span><span class="o">/</span><span class="mi">18</span>
                                                <span class="n">Fa0</span><span class="o">/</span><span class="mi">19</span>
<span class="mi">40</span>   <span class="n">HR</span>                               <span class="n">active</span>    <span class="n">Fa0</span><span class="o">/</span><span class="mi">20</span><span class="p">,</span> <span class="n">Fa0</span><span class="o">/</span><span class="mi">21</span><span class="p">,</span> <span class="n">Fa0</span><span class="o">/</span><span class="mi">22</span><span class="p">,</span> <span class="n">Fa0</span><span class="o">/</span><span class="mi">23</span>
                                                <span class="n">Fa0</span><span class="o">/</span><span class="mi">24</span>
<span class="mi">1002</span> <span class="n">fddi</span><span class="o">-</span><span class="n">default</span>                     <span class="n">active</span>
<span class="mi">1003</span> <span class="n">token</span><span class="o">-</span><span class="n">ring</span><span class="o">-</span><span class="n">default</span>               <span class="n">active</span>
<span class="mi">1004</span> <span class="n">fddinet</span><span class="o">-</span><span class="n">default</span>                  <span class="n">active</span>
<span class="mi">1005</span> <span class="n">trnet</span><span class="o">-</span><span class="n">default</span>                    <span class="n">active</span>
</pre></div>
</div>
<div class="code highlight-default"><div class="highlight"><pre><span></span>S2#show running-config
Building configuration...

Current configuration : 2356 bytes
!
version 12.2
no service timestamps log datetime msec
no service timestamps debug datetime msec
no service password-encryption
!
hostname S2
!
!
!
!
!
spanning-tree mode pvst
spanning-tree extend system-id
!
interface FastEthernet0/1
 switchport trunk allowed vlan 10,20,30,40
 switchport mode trunk
!
interface FastEthernet0/2
 switchport trunk allowed vlan 10,20,30,40
 switchport mode trunk
!
interface FastEthernet0/3
 switchport trunk allowed vlan 10,20,30,40
 switchport mode trunk
!
interface FastEthernet0/4
 switchport trunk allowed vlan 10,20,30,40
 switchport mode trunk
!
interface FastEthernet0/5
 switchport access vlan 10
 switchport mode access
!
interface FastEthernet0/6
 switchport access vlan 10
 switchport mode access
!
interface FastEthernet0/7
 switchport access vlan 10
 switchport mode access
!
interface FastEthernet0/8
 switchport access vlan 10
 switchport mode access
!
interface FastEthernet0/9
 switchport access vlan 10
 switchport mode access
!
interface FastEthernet0/10
 switchport access vlan 20
 switchport mode access
!
interface FastEthernet0/11
 switchport access vlan 20
 switchport mode access
!
interface FastEthernet0/12
 switchport access vlan 20
 switchport mode access
!
interface FastEthernet0/13
 switchport access vlan 20
 switchport mode access
!
interface FastEthernet0/14
 switchport access vlan 20
 switchport mode access
!
interface FastEthernet0/15
 switchport access vlan 30
 switchport mode access
!
interface FastEthernet0/16
 switchport access vlan 30
 switchport mode access
!
interface FastEthernet0/17
 switchport access vlan 30
 switchport mode access
!
interface FastEthernet0/18
 switchport access vlan 30
 switchport mode access
!
interface FastEthernet0/19
 switchport access vlan 30
 switchport mode access
!
interface FastEthernet0/20
 switchport access vlan 40
 switchport mode access
!
interface FastEthernet0/21
 switchport access vlan 40
 switchport mode access
!
interface FastEthernet0/22
 switchport access vlan 40
 switchport mode access
!
interface FastEthernet0/23
 switchport access vlan 40
 switchport mode access
!
interface FastEthernet0/24
 switchport access vlan 40
 switchport mode access
!
interface GigabitEthernet0/1
!
interface GigabitEthernet0/2
!
interface Vlan1
 no ip address
 shutdown
!
!
!
!
line con 0
!
line vty 0 4
 login
line vty 5 15
 login
!
</pre></div>
</div>
<p>Router1 DHCP show commands</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="c1">#show ip dhcp ?</span>
  <span class="n">binding</span>   <span class="n">DHCP</span> <span class="n">address</span> <span class="n">bindings</span>
  <span class="n">conflict</span>  <span class="n">DHCP</span> <span class="n">address</span> <span class="n">conflicts</span>
  <span class="n">pool</span>      <span class="n">DHCP</span> <span class="n">pools</span> <span class="n">information</span>
  <span class="n">relay</span>     <span class="n">Miscellaneous</span> <span class="n">DHCP</span> <span class="n">relay</span> <span class="n">information</span>
<span class="n">R1</span><span class="c1">#show ip dhcp binding</span>
<span class="n">IP</span> <span class="n">address</span>       <span class="n">Client</span><span class="o">-</span><span class="n">ID</span><span class="o">/</span>              <span class="n">Lease</span> <span class="n">expiration</span>        <span class="n">Type</span>
                 <span class="n">Hardware</span> <span class="n">address</span>
<span class="mf">172.31</span><span class="o">.</span><span class="mf">10.11</span>     <span class="mf">0000.0</span><span class="n">C92</span><span class="o">.</span><span class="n">D758</span>           <span class="o">--</span>                     <span class="n">Automatic</span>
<span class="mf">172.31</span><span class="o">.</span><span class="mf">20.11</span>     <span class="mf">0060.706</span><span class="n">D</span><span class="o">.</span><span class="mi">2129</span>           <span class="o">--</span>                     <span class="n">Automatic</span>
<span class="mf">172.31</span><span class="o">.</span><span class="mf">30.11</span>     <span class="mf">0030.</span><span class="n">F21A</span><span class="o">.</span><span class="mi">5348</span>           <span class="o">--</span>                     <span class="n">Automatic</span>
<span class="mf">172.31</span><span class="o">.</span><span class="mf">40.11</span>     <span class="mf">0002.1730</span><span class="o">.</span><span class="mi">4277</span>           <span class="o">--</span>                     <span class="n">Automatic</span>
<span class="n">R1</span><span class="c1">#show ip dhcp conflict</span>
<span class="n">IP</span> <span class="n">address</span>        <span class="n">Detection</span> <span class="n">method</span>   <span class="n">Detection</span> <span class="n">time</span>          <span class="n">VRF</span>
<span class="n">R1</span><span class="c1">#show ip dhcp pool</span>

<span class="n">Pool</span> <span class="n">VLAN_10</span> <span class="p">:</span>
 <span class="n">Utilization</span> <span class="n">mark</span> <span class="p">(</span><span class="n">high</span><span class="o">/</span><span class="n">low</span><span class="p">)</span>    <span class="p">:</span> <span class="mi">100</span> <span class="o">/</span> <span class="mi">0</span>
 <span class="n">Subnet</span> <span class="n">size</span> <span class="p">(</span><span class="n">first</span><span class="o">/</span><span class="nb">next</span><span class="p">)</span>       <span class="p">:</span> <span class="mi">0</span> <span class="o">/</span> <span class="mi">0</span>
 <span class="n">Total</span> <span class="n">addresses</span>                <span class="p">:</span> <span class="mi">30</span>
 <span class="n">Leased</span> <span class="n">addresses</span>               <span class="p">:</span> <span class="mi">1</span>
 <span class="n">Excluded</span> <span class="n">addresses</span>             <span class="p">:</span> <span class="mi">4</span>
 <span class="n">Pending</span> <span class="n">event</span>                  <span class="p">:</span> <span class="n">none</span>

 <span class="mi">1</span> <span class="n">subnet</span> <span class="ow">is</span> <span class="n">currently</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">pool</span>
 <span class="n">Current</span> <span class="n">index</span>        <span class="n">IP</span> <span class="n">address</span> <span class="nb">range</span>                    <span class="n">Leased</span><span class="o">/</span><span class="n">Excluded</span><span class="o">/</span><span class="n">Total</span>
 <span class="mf">172.31</span><span class="o">.</span><span class="mf">10.1</span>          <span class="mf">172.31</span><span class="o">.</span><span class="mf">10.1</span>      <span class="o">-</span> <span class="mf">172.31</span><span class="o">.</span><span class="mf">10.30</span>      <span class="mi">1</span>    <span class="o">/</span> <span class="mi">4</span>     <span class="o">/</span> <span class="mi">30</span>

<span class="n">Pool</span> <span class="n">VLAN_20</span> <span class="p">:</span>
 <span class="n">Utilization</span> <span class="n">mark</span> <span class="p">(</span><span class="n">high</span><span class="o">/</span><span class="n">low</span><span class="p">)</span>    <span class="p">:</span> <span class="mi">100</span> <span class="o">/</span> <span class="mi">0</span>
 <span class="n">Subnet</span> <span class="n">size</span> <span class="p">(</span><span class="n">first</span><span class="o">/</span><span class="nb">next</span><span class="p">)</span>       <span class="p">:</span> <span class="mi">0</span> <span class="o">/</span> <span class="mi">0</span>
 <span class="n">Total</span> <span class="n">addresses</span>                <span class="p">:</span> <span class="mi">14</span>
 <span class="n">Leased</span> <span class="n">addresses</span>               <span class="p">:</span> <span class="mi">1</span>
 <span class="n">Excluded</span> <span class="n">addresses</span>             <span class="p">:</span> <span class="mi">4</span>
 <span class="n">Pending</span> <span class="n">event</span>                  <span class="p">:</span> <span class="n">none</span>

 <span class="mi">1</span> <span class="n">subnet</span> <span class="ow">is</span> <span class="n">currently</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">pool</span>
 <span class="n">Current</span> <span class="n">index</span>        <span class="n">IP</span> <span class="n">address</span> <span class="nb">range</span>                    <span class="n">Leased</span><span class="o">/</span><span class="n">Excluded</span><span class="o">/</span><span class="n">Total</span>
 <span class="mf">172.31</span><span class="o">.</span><span class="mf">20.1</span>          <span class="mf">172.31</span><span class="o">.</span><span class="mf">20.1</span>      <span class="o">-</span> <span class="mf">172.31</span><span class="o">.</span><span class="mf">20.14</span>      <span class="mi">1</span>    <span class="o">/</span> <span class="mi">4</span>     <span class="o">/</span> <span class="mi">14</span>

<span class="n">Pool</span> <span class="n">VLAN_30</span> <span class="p">:</span>
 <span class="n">Utilization</span> <span class="n">mark</span> <span class="p">(</span><span class="n">high</span><span class="o">/</span><span class="n">low</span><span class="p">)</span>    <span class="p">:</span> <span class="mi">100</span> <span class="o">/</span> <span class="mi">0</span>
 <span class="n">Subnet</span> <span class="n">size</span> <span class="p">(</span><span class="n">first</span><span class="o">/</span><span class="nb">next</span><span class="p">)</span>       <span class="p">:</span> <span class="mi">0</span> <span class="o">/</span> <span class="mi">0</span>
 <span class="n">Total</span> <span class="n">addresses</span>                <span class="p">:</span> <span class="mi">126</span>
 <span class="n">Leased</span> <span class="n">addresses</span>               <span class="p">:</span> <span class="mi">1</span>
 <span class="n">Excluded</span> <span class="n">addresses</span>             <span class="p">:</span> <span class="mi">4</span>
 <span class="n">Pending</span> <span class="n">event</span>                  <span class="p">:</span> <span class="n">none</span>

 <span class="mi">1</span> <span class="n">subnet</span> <span class="ow">is</span> <span class="n">currently</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">pool</span>
 <span class="n">Current</span> <span class="n">index</span>        <span class="n">IP</span> <span class="n">address</span> <span class="nb">range</span>                    <span class="n">Leased</span><span class="o">/</span><span class="n">Excluded</span><span class="o">/</span><span class="n">Total</span>
 <span class="mf">172.31</span><span class="o">.</span><span class="mf">30.1</span>          <span class="mf">172.31</span><span class="o">.</span><span class="mf">30.1</span>      <span class="o">-</span> <span class="mf">172.31</span><span class="o">.</span><span class="mf">30.126</span>     <span class="mi">1</span>    <span class="o">/</span> <span class="mi">4</span>     <span class="o">/</span> <span class="mi">126</span>

<span class="n">Pool</span> <span class="n">VLAN_40</span> <span class="p">:</span>
 <span class="n">Utilization</span> <span class="n">mark</span> <span class="p">(</span><span class="n">high</span><span class="o">/</span><span class="n">low</span><span class="p">)</span>    <span class="p">:</span> <span class="mi">100</span> <span class="o">/</span> <span class="mi">0</span>
 <span class="n">Subnet</span> <span class="n">size</span> <span class="p">(</span><span class="n">first</span><span class="o">/</span><span class="nb">next</span><span class="p">)</span>       <span class="p">:</span> <span class="mi">0</span> <span class="o">/</span> <span class="mi">0</span>
 <span class="n">Total</span> <span class="n">addresses</span>                <span class="p">:</span> <span class="mi">62</span>
 <span class="n">Leased</span> <span class="n">addresses</span>               <span class="p">:</span> <span class="mi">1</span>
 <span class="n">Excluded</span> <span class="n">addresses</span>             <span class="p">:</span> <span class="mi">4</span>
 <span class="n">Pending</span> <span class="n">event</span>                  <span class="p">:</span> <span class="n">none</span>

 <span class="mi">1</span> <span class="n">subnet</span> <span class="ow">is</span> <span class="n">currently</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">pool</span>
 <span class="n">Current</span> <span class="n">index</span>        <span class="n">IP</span> <span class="n">address</span> <span class="nb">range</span>                    <span class="n">Leased</span><span class="o">/</span><span class="n">Excluded</span><span class="o">/</span><span class="n">Total</span>
 <span class="mf">172.31</span><span class="o">.</span><span class="mf">40.1</span>          <span class="mf">172.31</span><span class="o">.</span><span class="mf">40.1</span>      <span class="o">-</span> <span class="mf">172.31</span><span class="o">.</span><span class="mf">40.62</span>      <span class="mi">1</span>    <span class="o">/</span> <span class="mi">4</span>     <span class="o">/</span> <span class="mi">62</span>
<span class="n">R1</span><span class="c1">#show ip dhcp relay ?</span>
  <span class="n">information</span>  <span class="n">DHCP</span> <span class="n">relay</span> <span class="n">information</span> <span class="n">option</span>
<span class="n">R1</span><span class="c1">#show ip dhcp relay information trusted-sources</span>
<span class="n">List</span> <span class="n">of</span> <span class="n">trusted</span> <span class="n">sources</span> <span class="n">of</span> <span class="n">relay</span> <span class="n">agent</span> <span class="n">information</span> <span class="n">option</span><span class="p">:</span>

<span class="n">R1</span><span class="c1">#show dhcp lease</span>
<span class="n">Temp</span> <span class="n">IP</span> <span class="n">addr</span><span class="p">:</span> <span class="mf">209.165</span><span class="o">.</span><span class="mf">200.227</span> <span class="k">for</span> <span class="n">peer</span> <span class="n">on</span> <span class="n">Interface</span><span class="p">:</span> <span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mi">1</span>
<span class="n">Temp</span> <span class="n">sub</span> <span class="n">net</span> <span class="n">mask</span><span class="p">:</span> <span class="mf">255.255</span><span class="o">.</span><span class="mf">255.224</span>
   <span class="n">DHCP</span> <span class="n">Lease</span> <span class="n">server</span><span class="p">:</span> <span class="mf">209.165</span><span class="o">.</span><span class="mf">200.225</span> <span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">Bound</span>
   <span class="n">DHCP</span> <span class="n">Transaction</span> <span class="nb">id</span><span class="p">:</span> <span class="mf">0E98472</span><span class="n">C</span>
   <span class="n">Lease</span><span class="p">:</span> <span class="mi">86400</span> <span class="n">secs</span><span class="p">,</span>  <span class="n">Renewal</span><span class="p">:</span> <span class="mi">43200</span> <span class="n">secs</span><span class="p">,</span>  <span class="n">Rebind</span><span class="p">:</span> <span class="mi">75600</span> <span class="n">secs</span>
<span class="n">Temp</span> <span class="n">default</span><span class="o">-</span><span class="n">gateway</span> <span class="n">addr</span><span class="p">:</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span>
   <span class="n">Next</span> <span class="n">timer</span> <span class="n">fires</span> <span class="n">after</span><span class="p">:</span> <span class="mi">09</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mi">51</span>
   <span class="n">Retry</span> <span class="n">count</span><span class="p">:</span> <span class="mi">0</span>  <span class="n">Client</span><span class="o">-</span><span class="n">ID</span><span class="p">:</span><span class="n">cisco</span><span class="o">-</span><span class="mf">0002.1638</span><span class="o">.</span><span class="n">B602</span><span class="o">-</span><span class="n">Gig0</span><span class="o">/</span><span class="mi">1</span>
   <span class="n">Client</span><span class="o">-</span><span class="n">ID</span> <span class="nb">hex</span> <span class="n">dump</span><span class="p">:</span> <span class="mi">636973636</span><span class="n">F2D303030322E313633382E</span>
                       <span class="mi">23630322</span><span class="n">D476967302F31</span>
   <span class="n">Hostname</span><span class="p">:</span> <span class="n">R1</span>

<span class="n">R1</span><span class="c1">#show ip interface GigabitEthernet 0/1</span>
<span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mi">1</span> <span class="ow">is</span> <span class="n">up</span><span class="p">,</span> <span class="n">line</span> <span class="n">protocol</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="n">connected</span><span class="p">)</span>
  <span class="n">Internet</span> <span class="n">address</span> <span class="ow">is</span> <span class="mf">209.165</span><span class="o">.</span><span class="mf">200.227</span><span class="o">/</span><span class="mi">27</span>
  <span class="n">Broadcast</span> <span class="n">address</span> <span class="ow">is</span> <span class="mf">255.255</span><span class="o">.</span><span class="mf">255.255</span>
  <span class="n">Address</span> <span class="n">determined</span> <span class="n">by</span> <span class="n">DHCP</span>
  <span class="n">MTU</span> <span class="ow">is</span> <span class="mi">1500</span> <span class="nb">bytes</span>
  <span class="n">Helper</span> <span class="n">address</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">set</span>
  <span class="n">Directed</span> <span class="n">broadcast</span> <span class="n">forwarding</span> <span class="ow">is</span> <span class="n">disabled</span>
  <span class="n">Outgoing</span> <span class="n">access</span> <span class="nb">list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">set</span>
  <span class="n">Inbound</span>  <span class="n">access</span> <span class="nb">list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">set</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="dhcpv6-conclusion">
<h2>DHCPv6 conclusion<a class="headerlink" href="#dhcpv6-conclusion" title="Permalink to this headline">Â¶</a></h2>
<p>There are two methods available for the dynamic configuration of IPv6 global unicast addresses.</p>
<ul class="simple">
<li>Stateless Address Autoconfiguration (SLAAC)</li>
<li>Dynamic Host Configuration Protocol for IPv6 (Stateful DHCPv6)</li>
</ul>
<p>With stateless autoconfiguration, the client uses information provided by the IPv6 RA message to automatically select and configure a unique IPv6 address. The stateless DHCPv6 option informs the client to use the information in the RA message for addressing, but additional configuration parameters are available from a DHCPv6 server.</p>
<p>Stateful DHCPv6 is similar to DHCPv4. In this case, the RA message informs the client not to use the information in the RA message. All addressing information and DNS configuration information is obtained from a stateful DHCPv6 server. The DHCPv6 server maintains IPv6 state information similar to a DHCPv4 server allocating addresses for IPv4.</p>
</div>
<div class="section" id="ch8-qna">
<h2>Ch8 QnA<a class="headerlink" href="#ch8-qna" title="Permalink to this headline">Â¶</a></h2>
<dl class="docutils">
<dt>SLAAC</dt>
<dd>stateless address autoconfiguation. A method of automatic IPv6 address configuration on a client</dd>
<dt>Stateless DHCPv6</dt>
<dd>method of automatic IPv6 address configuration on a client with additional information provided by aDHCPv6 server</dd>
<dt>Stateful DHCPv6</dt>
<dd>a method of obtaining an IPv6 address and other configuration values from a DHCPv6 server</dd>
<dt>EUI-64</dt>
<dd>extended unique identifier. a process to configure the client ID based on the interface MAC address</dd>
<dt>DAD</dt>
<dd>Duplicate Address Detection. a process by a SLAAC client to verify that no duplication exists for its self-configured IPv6 address</dd>
<dt>FF02::1:2</dt>
<dd>Which destination IP address is used when an IPv6 host sends a DHCPv6 SOLICIT message to locate a DHCPv6 server?
.. note:: DHCPv6 hosts will send a DHCP SOLICIT message to the all DHCP routers multicast address of FF02::1:2</dd>
<dt>client rcvs RA msg with M flag 0 and O flag 1</dt>
<dd>The client should automatically configure an IPv6 address without contacting a DHCPv6 server.</dd>
<dt>Why is DHCPREQUEST sent as broadcast?</dt>
<dd>The client may have received offers from multiple servers, and the broadcast serves to implicitly decline those other offers</dd>
<dt>ipv6 address dhcp</dt>
<dd>set the router as a stateful DHCPv6 client</dd>
<dt>255.255.255.255</dt>
<dd>the destination IP address when an IPv4 host sends a DHCPDISCOVER message
.. note:: Because a DHCP client does not have a valid IPv4 address, it must use a broadcast IP address of 255.255.255.255 as the destination address to communicate with the DHCP server. The DHCPDISCOVER message sent by the client is the first message sent in order to make initial contact with a DHCP server.</dd>
</dl>
<p>An administrator has configured a DHCPv4 relay router and issued these commands</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">Router</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># interface g0/0</span>
<span class="n">Router</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ip address 10.0.1.1 255.255.255.0</span>
<span class="n">Router</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># no shutdown</span>
<span class="n">Router</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># exit</span>
<span class="n">Router</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># ip dhcp pool RELAY</span>
<span class="n">Router</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">config</span><span class="p">)</span><span class="c1"># end</span>
</pre></div>
</div>
<p>The clients are not receiving IP parameters from the DHCPv4 server. What is a possible cause?
The <code class="docutils literal"><span class="pre">ip</span> <span class="pre">helper-address</span> <span class="pre">server-ip</span></code> command is missing</p>
<dl class="docutils">
<dt>DHCPREQUEST</dt>
<dd>What message does an IPv4 host use to reply when it receives a DHCPOFFER message from a DHCP server?
.. note:: When the client receives the DHCPOFFER from the server, it sends back a DHCPREQUEST broadcast message. On receiving the DHCPREQUEST message, the server replies with a unicast DHCPACK message.</dd>
<dt>SLAAC</dt>
<dd>In which alternative to DHCPv6 does a router dynamically provide IPv6 configuration information to hosts?
.. note:: Stateless Address Autoconfiguration (SLAAC) can be used as an alternative to DHCPv6. In this approach, a router provides global routing prefix, prefix length, default gateway, and DNS server information to a host. The host is not provided with a global unicast address by SLAAC. Instead, SLAAC suggests that the host create its own global unicast address based on the supplied global routing prefix. ARP is not used in IPv6. ICMPv6 messages are used by SLAAC to provide addressing and other configuration information. EUI-64 is a process in which a host will create an Interface ID from its 48-bit MAC address.</dd>
<dt>DAD</dt>
<dd>What process is used in ICMPv6 for a host to verify that an IPv6 address is unique before configuring it on an interface?
.. note:: Before an IPv6 host can enable and use an assigned IPv6 address, the host must verify that the address is unique on the network. To verify that no other hosts are using the IPv6 address, the host performs the duplicate address detection (DAD) process by sending a <strong>Neighbor Solicitation (NS) message</strong> to the IPv6 address.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">clients in stateless DHCPv6 operation will configure their interface IDs either by EUI-64 or a random number</p>
</div>
<dl class="docutils">
<dt>Router# show ip dhcp binding</dt>
<dd>Which command will allow a network administrator to check the IP address that is assigned to a particular MAC address?</dd>
<dt>After booting, a client receives an ICMPv6 RA message with the M flag set to 0 and the O flag set to 1. What does this indicate?</dt>
<dd><span class="strike">The client should automatically configure an IPv6 address without contacting a DHCPv6 server</span>
The client should automatically configure an IPv6 address and then contact a DHCPv6 server for more information</dd>
<dt>When a client is requesting an initial address lease from a DHCP server, why is the DHCPREQUEST message sent as a broadcast?</dt>
<dd>The client may have received offers from multiple servers, and the broadcast serves to implicitly decline those other offers
.. note:: During the initial DHCP exchange between a client and server, the client broadcasts a DHCPDISCOVER message looking for DHCP servers. Multiple servers may be configured to respond to this request with DHCPOFFER messages. The client will choose the lease from one of the servers by sending a DHCPREQUEST message. It sends this message as a broadcast so that the other DHCP servers that sent offers will know that their offers were declined and the corresponding address can go back into the pool</dd>
<dt>An administrator is troubleshooting a DHCPv4 issue on a router. By issuing the debug ip dhcp â¦â¦.. command, the administrator can watch, in real time, the IP address assignments that are performed by the router.</dt>
<dd><code class="docutils literal"><span class="pre">debug</span> <span class="pre">ip</span> <span class="pre">dhcp</span> <span class="pre">server</span> <span class="pre">events</span></code></dd>
</dl>
</div>
<div class="section" id="ch8-practice-exam">
<h2>Ch8 practice exam<a class="headerlink" href="#ch8-practice-exam" title="Permalink to this headline">Â¶</a></h2>
<ol class="arabic">
<li><p class="first">Which DHCPv4 message will a client send to accept an IPv4 address that is offered by a DHCP server?</p>
<ul class="simple">
<li>unicast DHCPACK</li>
<li>broadcast DHCPACK</li>
<li>unicast DHCPREQUEST</li>
<li>broadcast DHCPREQUEST</li>
<li>Answer -&gt; <span class="transparent">broadcast DHCPREQUEST</span></li>
</ul>
</li>
<li><p class="first">A company uses DHCP servers to dynamically assign IPv4 addresses to employee workstations. The address lease duration is set as 5 days. An employee returns to the office after an absence of one week. When the employee boots the workstation, it sends a message to obtain an IP address. Which Layer 2 and Layer 3 destination addresses will the message contain?</p>
<ul class="simple">
<li>FF-FF-FF-FF-FF-FF and 255.255.255.255</li>
<li>both MAC and IPv4 addresses of the DHCP server</li>
<li>MAC address of the DHCP server and 255.255.255.255</li>
<li>FF-FF-FF-FF-FF-FF and IPv4 address of the DHCP server</li>
<li>Answer -&gt; <span class="transparent">FF-FF-FF-FF-FF-FF and 255.255.255.255</span></li>
</ul>
</li>
<li><p class="first">Which is a DHCPv4 address allocation method that assigns IPv4 addresses for a limited lease period?</p>
<ul class="simple">
<li>manual allocation</li>
<li>pre-allocation</li>
<li>automatic allocation</li>
<li>dynamic allocation</li>
<li>Answer -&gt; <span class="transparent">dynamic allocation</span></li>
</ul>
</li>
<li><p class="first">Which address does a DHCPv4 server target when sending a DHCPOFFER message to a client that makes an address request?</p>
<ul class="simple">
<li>client IP address</li>
<li>client hardware address</li>
<li>gateway IP address</li>
<li>broadcast MAC address</li>
<li>Answer -&gt; <span class="transparent">client hardware address</span></li>
</ul>
</li>
<li><p class="first">As a DHCPv4 client lease is about to expire, what is the message that the client sends the DHCP server?</p>
<ul class="simple">
<li>DHCPDISCOVER</li>
<li>DHCPOFFER</li>
<li>DHCPREQUEST</li>
<li>DHCPACK</li>
<li>Answer -&gt; <span class="transparent">DHCPREQUEST</span></li>
</ul>
</li>
<li><p class="first">What is an advantage of configuring a Cisco router as a relay agent?</p>
<ul class="simple">
<li>It will allow DHCPDISCOVER messages to pass without alteration</li>
<li>It can forward both broadcast and multicast messages on behalf of clients</li>
<li>It can provide relay services for multiple UDP services</li>
<li>It reduces the response time from a DHCP server.</li>
<li>Answer -&gt; <span class="transparent">It can provide relay services for multiple UDP services</span></li>
</ul>
</li>
<li><p class="first">An administrator issues the commands</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">Router</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># interface g0/1</span>
<span class="n">Router</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ip address dhcp</span>
</pre></div>
</div>
<p>What is the administrator trying to achieve?</p>
<ul class="simple">
<li>configuring the router to act as a DHCPv4 server</li>
<li>configuring the router to obtain IP parameters from a DHCPv4 server</li>
<li>configuring the router to act as a relay agent</li>
<li>configuring the router to resolve IP address conflicts</li>
<li>Answer -&gt; <span class="transparent">configuring the router to obtain IP parameters from a DHCPv4 server</span></li>
</ul>
</li>
<li><p class="first">Under which two circumstances would a router usually be configured as a DHCPv4 client? (Choose two.)</p>
<ul class="simple">
<li>The router is intended to be used as a SOHO gateway</li>
<li>The administrator needs the router to act as a relay agent</li>
<li>The router is meant to provide IP addresses to the hosts</li>
<li>This is an ISP requirement</li>
<li>The router has a fixed IP address</li>
<li>Answer -&gt; <span class="transparent">The router is intended to be used as a SOHO gateway &amp;&amp; This is an ISP requirement</span></li>
</ul>
</li>
<li><p class="first">A company uses the SLAAC method to configure IPv6 addresses for the employee workstations. Which address will a client use as its default gateway?</p>
<ul class="simple">
<li>the all-routers multicast address</li>
<li>the link-local address of the router interface that is attached to the network</li>
<li>the unique local address of the router interface that is attached to the network</li>
<li>the global unicast address of the router interface that is attached to the network</li>
<li>Answer -&gt; <span class="transparent">the link-local address of the router interface that is attached to the network</span></li>
</ul>
</li>
<li><p class="first">A network administrator configures a router to send RA messages with M flag as 0 and O flag as 1. Which statement describes the effect of this configuration when a PC tries to configure its IPv6 address?</p>
<ul class="simple">
<li>It should contact a DHCPv6 server for all the information that it needs</li>
<li>It should use the information that is contained in the RA message exclusively</li>
<li>It should use the information that is contained in the RA message and contact a DHCPv6 server for additional information</li>
<li>It should contact a DHCPv6 server for the prefix, the prefix-length information, and an interface ID that is both random and unique</li>
<li>Answer -&gt; <span class="transparent">It should use the information that is contained in the RA message and contact a DHCPv6 server for additional information</span></li>
</ul>
</li>
<li><p class="first">A company implements the stateless DHCPv6 method for configuring IPv6 addresses on employee workstations. After a workstation receives messages from multiple DHCPv6 servers to indicate their availability for DHCPv6 service, which message does it send to a server for configuration information?</p>
<ul class="simple">
<li>DHCPv6 SOLICIT</li>
<li>DHCPv6 REQUEST</li>
<li>DHCPv6 ADVERTISE</li>
<li>DHCPv6 INFORMATION-REQUEST</li>
<li>Answer -&gt; <span class="transparent">DHCPv6 INFORMATION-REQUEST</span></li>
</ul>
</li>
<li><p class="first">An administrator wants to configure hosts to automatically assign IPv6 addresses to themselves by the use of Router Advertisement messages, but also to obtain the DNS server address from a DHCPv6 server. Which address assignment method should be configured?</p>
<ul class="simple">
<li>SLAAC</li>
<li>stateless DHCPv6</li>
<li>stateful DHCPv6</li>
<li>RA and EUI-64</li>
<li>Answer -&gt; <span class="transparent">stateless DHCPv6</span></li>
</ul>
</li>
<li><p class="first">How does an IPv6 client ensure that it has a unique address after it configures its IPv6 address using the SLAAC allocation method?</p>
<ul class="simple">
<li>It sends an ARP message with the IPv6 address as the destination IPv6 address</li>
<li>It checks with the IPv6 address database that is hosted by the SLAAC server</li>
<li>It contacts the DHCPv6 server via a special formed ICMPv6 message</li>
<li>It sends an ICMPv6 Neighbor Solicitation message with the IPv6 address as the target IPv6 address</li>
<li>Answer -&gt; <span class="transparent">It sends an ICMPv6 Neighbor Solicitation message with the IPv6 address as the target IPv6 address</span></li>
</ul>
</li>
<li><p class="first">What is used in the EUI-64 process to create an IPv6 interface ID on an IPv6 enabled interface?</p>
<ul class="simple">
<li>the MAC address of the IPv6 enabled interface</li>
<li>a randomly generated 64-bit hexadecimal address</li>
<li>an IPv6 address that is provided by a DHCPv6 server</li>
<li>an IPv4 address that is configured on the interface</li>
<li>Answer -&gt; <span class="transparent">the MAC address of the IPv6 enabled interface</span></li>
</ul>
</li>
<li><p class="first">What two methods can be used to generate an interface ID by an IPv6 host that is using SLAAC? (Choose two.)</p>
<ul class="simple">
<li>EUI-64</li>
<li>random generation</li>
<li>stateful DHCPv6</li>
<li>DAD</li>
<li>ARP</li>
<li>Answer -&gt; <span class="transparent">EUI-64 &amp;&amp; random generation</span></li>
</ul>
</li>
<li><p class="first">Refer to the exhibit. Based on the output that is shown, what kind of IPv6 addressing is being configured?</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span>R1# show running-config
&lt;output omitted&gt;
!
ipv6 dhcp pool IPV6
 dns-server 2001:DB8:1234:5678::100
 domain-name netacad.com
!
interface FastEthernet0/0
 &lt;output omitted&gt;
!
 ipv6 nd other-config-flag
 ipv6 dhcp server IPV6
!
&lt;output omitted&gt;
</pre></div>
</div>
<ul class="simple">
<li>SLAAC</li>
<li>stateful DHCPv6</li>
<li>stateless DHCPv6</li>
<li>static link-local</li>
<li>Answer -&gt; <span class="transparent">stateless DHCPv6</span></li>
</ul>
</li>
<li><p class="first">Refer to the exhibit. What should be done to allow PC-A to receive an IPv6 address from the DHCPv6 server?</p>
<img alt="../../../_images/Ch8_exam_practice_1.png" src="../../../_images/Ch8_exam_practice_1.png" />
<ul class="simple">
<li>Add the ipv6 dhcp relay command to interface Fa0/0</li>
<li>Configure the ipv6 nd managed-config-flag command on interface Fa0/1</li>
<li>Change the ipv6 nd managed-config-flag command to ipv6 nd other-config-flag</li>
<li>Add the IPv6 address 2001:DB8:1234:5678::10/64 to the interface configuration of the DHCPv6 server</li>
<li>Answer -&gt; <span class="transparent">Add the ipv6 dhcp relay command to interface Fa0/0</span></li>
</ul>
</li>
<li><p class="first">Refer to the exhibit. A network administrator is implementing stateful DHCPv6 operation for the company. However, the clients are not using the prefix and prefix-length information that is configured in the DHCP pool. The administrator issues a show ipv6 interface command. What could be the cause of the problem?</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="c1"># show ipv6 interface gigabitBthernet 0/0</span>
<span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mi">0</span> <span class="ow">is</span> <span class="n">up</span><span class="p">,</span> <span class="n">line</span> <span class="n">protocol</span> <span class="ow">is</span> <span class="n">up</span>
  <span class="n">IPv6</span> <span class="ow">is</span> <span class="n">enabled</span><span class="p">,</span> <span class="n">link</span><span class="o">-</span><span class="n">local</span> <span class="n">address</span> <span class="ow">is</span> <span class="n">FE80</span><span class="p">::</span><span class="mi">523</span><span class="n">D</span><span class="p">:</span><span class="n">E5FF</span><span class="p">:</span><span class="n">FEAA</span><span class="p">:</span><span class="n">COAO</span>
  <span class="n">No</span> <span class="n">Virtual</span> <span class="n">link</span><span class="o">-</span><span class="n">local</span> <span class="n">address</span><span class="p">(</span><span class="n">es</span><span class="p">):</span>
  <span class="n">Global</span> <span class="n">unicast</span> <span class="n">address</span><span class="p">(</span><span class="n">es</span><span class="p">):</span>
  <span class="mi">2001</span><span class="p">:</span><span class="n">DB8</span><span class="p">:</span><span class="n">ACAD</span><span class="p">:</span><span class="mi">1</span><span class="p">::</span><span class="mi">1</span><span class="p">,</span> <span class="n">subnet</span> <span class="ow">is</span> <span class="mi">2001</span><span class="p">:</span><span class="n">DB8</span><span class="p">:</span><span class="n">ACAD</span><span class="p">:</span><span class="mi">1</span><span class="p">::</span><span class="o">/</span><span class="mi">64</span>

<span class="o">&lt;</span><span class="n">output</span> <span class="n">omitted</span><span class="o">&gt;</span>
<span class="n">ICMP</span> <span class="n">error</span> <span class="n">messages</span> <span class="n">limited</span> <span class="n">to</span> <span class="n">one</span> <span class="n">every</span> <span class="mi">100</span> <span class="n">milliseconds</span>
<span class="n">ICMP</span> <span class="n">redirects</span> <span class="n">are</span> <span class="n">enabled</span>
<span class="n">ICMP</span> <span class="n">unreachables</span> <span class="n">are</span> <span class="n">sent</span> <span class="n">ND</span> <span class="n">DAD</span> <span class="ow">is</span> <span class="n">enabled</span><span class="p">,</span> <span class="n">number</span> <span class="n">of</span> <span class="n">DAD</span> <span class="n">attempts</span><span class="p">:</span><span class="mi">1</span>
<span class="n">ND</span> <span class="n">reachable</span> <span class="n">time</span> <span class="ow">is</span> <span class="mi">30000</span> <span class="n">milliseconds</span> <span class="p">(</span><span class="n">using</span> <span class="mi">30000</span><span class="p">)</span>
<span class="n">ND</span> <span class="n">advertised</span> <span class="n">reachable</span> <span class="n">time</span> <span class="ow">is</span> <span class="mi">0</span> <span class="p">(</span><span class="n">unspecified</span><span class="p">)</span>
<span class="n">ND</span> <span class="n">advertised</span> <span class="n">retransmit</span> <span class="n">interval</span> <span class="ow">is</span> <span class="mi">0</span> <span class="p">(</span><span class="n">unspecified</span><span class="p">)</span>
<span class="n">ND</span> <span class="n">router</span> <span class="n">advertisements</span> <span class="n">are</span> <span class="n">sent</span> <span class="n">every</span> <span class="mi">200</span> <span class="n">seconds</span>
<span class="n">ND</span> <span class="n">router</span> <span class="n">advertisements</span> <span class="n">live</span> <span class="k">for</span> <span class="mi">1800</span> <span class="n">seconds</span>
<span class="n">ND</span> <span class="n">advertised</span> <span class="n">default</span> <span class="n">router</span> <span class="n">preference</span> <span class="ow">is</span> <span class="n">Medium</span>
<span class="n">Hosts</span> <span class="n">use</span> <span class="n">stateless</span> <span class="n">autoconfig</span> <span class="k">for</span> <span class="n">addresses</span><span class="o">.</span>
<span class="n">Hosts</span> <span class="n">use</span> <span class="n">DHCP</span> <span class="n">to</span> <span class="n">obtain</span> <span class="n">other</span> <span class="n">configuration</span><span class="o">.</span>
<span class="n">R1</span><span class="c1">#</span>
</pre></div>
</div>
<ul class="simple">
<li>No virtual link-local address is configured</li>
<li>The Duplicate Address Detection feature is disabled</li>
<li>The router is configured for SLAAC DHCPv6 operation</li>
<li>The router is configured for stateless DHCPv6 operation</li>
<li>Answer -&gt; <span class="transparent">The router is configured for stateless DHCPv6 operation</span></li>
<li>more info on answer -&gt; <span class="transparent">The router is configured for stateless DHCPv6 operation, which is shown by the last two lines of the show command output. Hosts will configure their IPv6 addresses by using the prefix information that is provided by RA messages. They will also obtain additional configuration information from a DHCPv6 server. The âNo virtual link-local addressâ option and the âDuplicate Address Detectionâ option are irrelevant to DHCP configuration. Option âSLAAC configurationâ is incorrect because by definition SLAAC will use only the information that is provided by RA messages to configure IPv6 settings.</span></li>
</ul>
</li>
<li><p class="first">Refer to the exhibit. A network administrator is implementing the stateless DHCPv6 operation for the company. Clients are configuring IPv6 addresses as expected. However, the clients are not getting the DNS server address and the domain name information configured in the DHCP pool. What could be the cause of the problem?</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="c1"># configure terminal</span>
<span class="n">Enter</span> <span class="n">configuration</span> <span class="n">commands</span><span class="p">,</span> <span class="n">one</span> <span class="n">per</span> <span class="n">line</span><span class="o">.</span> <span class="n">End</span> <span class="k">with</span> <span class="n">CNTL</span><span class="o">/</span><span class="n">Z</span><span class="o">.</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># ipv6 unicast-routing</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># ipv6 dhcp pool ACAD_NET</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">dhcp</span><span class="p">)</span><span class="c1"># dns-server 2001:db8:acad:a1::10</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">dhcp</span><span class="p">)</span><span class="c1"># domain-name netacad.net</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="n">dhcp</span><span class="p">)</span><span class="c1"># exit</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1"># interface gigabitEthernet 0/0</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ipv6 address 2001:db8:acad:1::1/64</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># ipv6 dhcp server ACAD_NET</span>
<span class="n">R1</span><span class="p">(</span><span class="n">config</span><span class="o">-</span><span class="k">if</span><span class="p">)</span><span class="c1"># end</span>
<span class="n">R1</span><span class="c1">#</span>
<span class="n">R1</span><span class="c1"># show ipv6 dhcp pool</span>
<span class="n">DHCPv6</span> <span class="n">pool</span><span class="p">:</span> <span class="n">ACAD_NET</span>
<span class="n">DNS</span> <span class="n">server</span><span class="p">:</span> <span class="mi">2001</span><span class="p">:</span><span class="n">DE8</span><span class="p">:</span><span class="n">ACAD</span><span class="p">:</span><span class="n">A1</span><span class="p">::</span><span class="mi">10</span>
<span class="n">Domain</span> <span class="n">name</span><span class="p">:</span> <span class="n">netacad</span><span class="o">.</span><span class="n">net</span>
<span class="n">Active</span> <span class="n">clients</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">R1</span><span class="c1">#</span>
</pre></div>
</div>
<ul class="simple">
<li>The GigabitEthernet interface is not activated</li>
<li>The router is configured for SLAAC operation</li>
<li>The DNS server address is not on the same network as the clients are on</li>
<li>The clients cannot communicate with the DHCPv6 server, evidenced by the number of active clients being 0</li>
<li>Answer -&gt; <span class="transparent">The router is configured for SLAAC operation</span></li>
</ul>
</li>
<li><p class="first">Fill in the blank. Do not abbreviate.
Type a command to exclude the first fifteen useable IP addresses from a DHCPv4 address pool of the network 10.0.15.0/24</p>
<ul class="simple">
<li>Router(config)# ip dhcp <span class="transparent">excluded-address 10.0.15.1 10.0.15.15</span></li>
</ul>
</li>
<li><p class="first">Order the steps of configuring a router as a DHCPv4 Server. (Not all options are used.)</p>
<ul class="simple">
<li>Step 1</li>
<li>Step 2</li>
<li>Step 3</li>
<li>Configure a DHCP pool.</li>
<li>Exclude IP addresses.</li>
<li>Configure the routing protocol.</li>
<li>Define the default gateway router.</li>
<li>Configure a secret password.</li>
<li>Answer -&gt; <span class="transparent">Step1=Exclude IP addresses - Step2=Configure a DHCP pool - Step3=Define the default gateway router</span></li>
</ul>
</li>
<li><p class="first">Match the descriptions to the corresponding DHCPv6 server type. (Not all options are used)</p>
<ul class="simple">
<li>enabled in RA messages with the ipv6 nd other-config-flag command</li>
<li>clients communicate with the DHCPv6 server by the use of RA messages</li>
<li>the M flag is set to 1 in RA messages</li>
<li>uses the address command to create a pool of addresses for clients</li>
<li>clients send only DHCPv6 INFORMATION-REQUEST messages to the server</li>
<li>enabled on the client with the ipv6 address dhcp command</li>
<li>enabled on the client with the ipv6 address autoconfig command</li>
<li>Stateless DHCPv6<ul>
<li><span class="transparent">enabled in RA messages with the ipv6 nd other-config-flag command</span></li>
<li><span class="transparent">clients send only DHCPv6 INFORMATION-REQUEST messages to the server</span></li>
<li><span class="transparent">enabled on the client with the ipv6 address autoconfig command</span></li>
</ul>
</li>
<li>Stateful DHCPv6<ul>
<li><span class="transparent">the M flag is set to 1 in RA messages</span></li>
<li><span class="transparent">uses the address command to create a pool of addresses for clients</span></li>
<li><span class="transparent">enabled on the client with the ipv6 address dhcp command</span></li>
</ul>
</li>
</ul>
</li>
<li><p class="first">Refer to the exhibit. What should be done to allow PC-A to receive an IPv6 address from the DHCPv6 server?</p>
<img alt="../../../_images/Ch10_practice_exam_q1.png" src="../../../_images/Ch10_practice_exam_q1.png" />
<div class="code highlight-default"><div class="highlight"><pre><span></span>RTR1# show running-config
hostname RTR1
!
&lt;output omitted&gt;
interface FastEthernet0/0
 ip address dhcp
 duplex auto
 speed auto
 ipv6 address 2001:DB8:1234:5678::1/64
 ipv6 nd managed-config-flag
!
interface FastEthernet0/1
 no ip address
 duplex auto
 speed auto
 ipv6 address 2001:DB8:1234:ABCD::1/64
!
&lt;output omitted&gt;
</pre></div>
</div>
<ul class="simple">
<li>Add the IPv6 address 2001:DB8:1234:5678::10/64 to the interface configuration of the DHCPv6 server</li>
<li>Configure the ipv6 nd managed-config-flag command on interface Fa0/1</li>
<li>Change the ipv6 nd managed-config-flag command to ipv6 nd other-config-flag</li>
<li>Add the ipv6 dhcp relay command to interface Fa0/0</li>
<li>Answer -&gt; <span class="transparent">Add the ipv6 dhcp relay command to interface Fa0/0</span></li>
</ul>
</li>
<li><p class="first">What is the reason why the DHCPREQUEST message is sent as a broadcast during the DHCPv4 process?</p>
<ul class="simple">
<li>for routers to fill their routing tables with this new information</li>
<li>to notify other hosts not to request the same IP address</li>
<li>to notify other DHCP servers on the subnet that the IP address was leased*</li>
<li>for hosts on other subnets to receive the information</li>
<li>answer -&gt; <span class="transparent">to notify other DHCP servers on the subnet that the IP address was leased</span></li>
</ul>
</li>
<li><p class="first">A company uses DHCP servers to dynamically assign IPv4 addresses to employee workstations. The address lease duration is set as 5 days. An employee returns to the office after an absence of one week. When the employee boots the workstation, it sends a message to obtain an IP address. Which Layer 2 and Layer 3 destination addresses will the message contain?</p>
<ul class="simple">
<li>FF-FF-FF-FF-FF-FF and 255.255.255.255*</li>
<li>MAC address of the DHCP server and 255.255.255.255</li>
<li>FF-FF-FF-FF-FF-FF and IPv4 address of the DHCP server</li>
<li>both MAC and IPv4 addresses of the DHCP server</li>
<li>answer -&gt; <span class="transparent">to notify other DHCP servers on the subnet that the IP address was leased</span></li>
</ul>
</li>
</ol>
<p>#. Fill in the blank. Do not abbreviate.
Type a command to exclude the first fifteen useable IP addresses from a DHCPv4 address pool of the network 10.0.15.0/24.</p>
<blockquote>
<div><ul class="simple">
<li>Router(config)# ip dhcp <span class="transparent">excluded-address 10.0.15.1 10.0.15.15</span></li>
</ul>
</div></blockquote>
<ol class="arabic">
<li><p class="first">Match the descriptions to the corresponding DHCPV6 servertype. (Not all options are used)</p>
<ul class="simple">
<li><span class="transparent">0</span> enabled in RA messages with the <code class="docutils literal"><span class="pre">ipv6</span> <span class="pre">nd</span> <span class="pre">other-config-flag</span></code> command</li>
<li><span class="transparent">x</span> clients communicate with the DHCPV6 server by the use of RA messages</li>
<li><span class="transparent">1</span> the M flag is set to 1 in RA messages</li>
<li><span class="transparent">1</span> uses the <code class="docutils literal"><span class="pre">address</span></code> command to create a pool of addresses for clients</li>
<li><span class="transparent">0</span> clients send only DHCPV6 INFORMATlON-REQUEST messages to the server</li>
<li><span class="transparent">1</span> enabled on the client with the <code class="docutils literal"><span class="pre">ipv6</span> <span class="pre">address</span> <span class="pre">dhcp</span></code> command</li>
<li><span class="transparent">0</span> enabled on the client with the <code class="docutils literal"><span class="pre">ipv6</span> <span class="pre">address</span> <span class="pre">autoconfig</span></code> command</li>
<li>Stateless DHCPV6 = 0</li>
<li>Stateful DHCPV6 = 1</li>
<li>Neither = x</li>
</ul>
</li>
<li><p class="first">Refer to the exhibit. A network administrator is implementing stateful DHCPv6 operation for the company. However, the clients are not using the prefix and prefix-length information that is configured in the DHCP pool. The administrator issues a show ipv6 interface command. What could be the cause of the problem?</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="c1"># show ipv6 interface gigabitEthernet 0/0</span>
<span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mi">0</span> <span class="ow">is</span> <span class="n">up</span><span class="p">,</span> <span class="n">line</span> <span class="n">protocol</span> <span class="ow">is</span> <span class="n">up</span>
  <span class="n">IPv6</span> <span class="ow">is</span> <span class="n">enabled</span><span class="p">,</span> <span class="n">link</span><span class="o">-</span><span class="n">local</span> <span class="n">address</span> <span class="ow">is</span> <span class="n">FE80</span><span class="p">::</span><span class="mi">523</span><span class="n">D</span><span class="p">:</span><span class="n">E5FF</span><span class="p">:</span><span class="n">FEAA</span><span class="p">:</span><span class="n">C0A0</span>
  <span class="n">No</span> <span class="n">Virtual</span> <span class="n">link</span><span class="o">-</span><span class="n">local</span> <span class="n">address</span><span class="p">(</span><span class="n">es</span><span class="p">):</span>
  <span class="n">Global</span> <span class="n">unicast</span> <span class="n">address</span><span class="p">(</span><span class="n">es</span><span class="p">):</span>  <span class="mi">2001</span><span class="p">:</span><span class="n">DB8</span><span class="p">:</span><span class="n">ACAD</span><span class="p">:</span><span class="mi">1</span><span class="p">::</span><span class="mi">1</span><span class="p">,</span> <span class="n">subnet</span> <span class="ow">is</span> <span class="mi">2001</span><span class="p">:</span><span class="n">DB8</span><span class="p">:</span><span class="n">ACAD</span><span class="p">:</span><span class="mi">1</span><span class="p">::</span><span class="o">/</span><span class="mi">64</span>

<span class="o">&lt;</span><span class="n">output</span> <span class="n">omitted</span><span class="o">&gt;</span>

  <span class="n">ICMP</span> <span class="n">error</span> <span class="n">messages</span> <span class="n">limited</span> <span class="n">to</span> <span class="n">one</span> <span class="n">every</span> <span class="mi">100</span> <span class="n">milliseconds</span>
  <span class="n">ICMP</span> <span class="n">redirects</span> <span class="n">are</span> <span class="n">enabled</span>
  <span class="n">ICMP</span> <span class="n">unreachables</span> <span class="n">are</span> <span class="n">sent</span>
  <span class="n">ND</span> <span class="n">DAD</span> <span class="ow">is</span> <span class="n">enabled</span><span class="p">,</span> <span class="n">number</span> <span class="n">of</span> <span class="n">DAD</span> <span class="n">attempts</span><span class="p">:</span> <span class="mi">1</span>
  <span class="n">ND</span> <span class="n">reachable</span> <span class="n">time</span> <span class="ow">is</span> <span class="mi">30000</span> <span class="n">milliseconds</span> <span class="p">(</span><span class="n">using</span> <span class="mi">30000</span><span class="p">)</span>
  <span class="n">ND</span> <span class="n">advertised</span> <span class="n">reachable</span> <span class="n">time</span> <span class="ow">is</span> <span class="mi">0</span> <span class="p">(</span><span class="n">unspecified</span><span class="p">)</span>
  <span class="n">ND</span> <span class="n">advertised</span> <span class="n">retransmit</span> <span class="n">interval</span> <span class="ow">is</span> <span class="mi">0</span> <span class="p">(</span><span class="n">unspecified</span><span class="p">)</span>
  <span class="n">ND</span> <span class="n">router</span> <span class="n">advertisements</span> <span class="n">are</span> <span class="n">sent</span> <span class="n">every</span> <span class="mi">200</span> <span class="n">seconds</span>
  <span class="n">ND</span> <span class="n">router</span> <span class="n">advertisements</span> <span class="n">live</span> <span class="k">for</span> <span class="mi">1800</span> <span class="n">seconds</span>
  <span class="n">ND</span> <span class="n">advertised</span> <span class="n">default</span> <span class="n">router</span> <span class="n">preference</span> <span class="ow">is</span> <span class="n">Medium</span>
  <span class="n">Hosts</span> <span class="n">use</span> <span class="n">stateless</span> <span class="n">autoconfig</span> <span class="k">for</span> <span class="n">addresses</span><span class="o">.</span>
  <span class="n">Hosts</span> <span class="n">use</span> <span class="n">DHCP</span> <span class="n">to</span> <span class="n">obtain</span> <span class="n">other</span> <span class="n">configuration</span><span class="o">.</span>
<span class="n">R1</span><span class="c1">#</span>
</pre></div>
</div>
<ul class="simple">
<li>The router is configured for stateless DHCPv6 operation</li>
<li>No virtual link-local address is configured</li>
<li>The router is configured for SLAAC DHCPv6 operation</li>
<li>The Duplicate Address Detection feature is disabled</li>
<li>Answer -&gt; <span class="transparent">The router is configured for stateless DHCPv6 operation</span></li>
</ul>
</li>
<li><p class="first">A network engineer is troubleshooting hosts on a LAN that are not being assigned an IPv4 address from a DHCP server after a new Ethernet switch has been installed on the LAN. The configuration of the DHCP server has been confirmed as correct and the clients have network connectivity to other networks if a static IP address is configured on each one. What step should the engineer take next to solve the issue?</p>
<ul class="simple">
<li>Issue the ipconfig/release command on each client</li>
<li>Issue the show ip dhcp binding command on the switch</li>
<li>Issue the show interface command on the router to confirm that the LAN gateway is operational</li>
<li>Confirm that ports on the Layer 2 LAN switch are configured as edge ports</li>
<li>Answer -&gt; <span class="transparent">Confirm that ports on the Layer 2 LAN switch are configured as edge ports</span></li>
</ul>
</li>
<li><p class="first">A network administrator configures a router to send RA messages with M flag as 0 and O flag as 1. Which statement describes the effect of this configuration when a PC tries to configure its IPv6 address?</p>
<ul class="simple">
<li>It should use the information that is contained in the RA message exclusively</li>
<li>It should contact a DHCPv6 server for the prefix, the prefix-length information, and an interface ID that is both random and unique</li>
<li>It should use the information that is contained in the RA message and contact a DHCPv6 server for additional information</li>
<li>It should contact a DHCPv6 server for all the information that it needs</li>
<li>Answer -&gt; <span class="transparent">It should use the information that is contained in the RA message and contact a DHCPv6 server for additional information</span></li>
</ul>
</li>
<li><p class="first">Which protocol supports Stateless Address Autoconfiguration (SLAAC) for dynamic assignment of IPv6 addresses to a host?</p>
<ul class="simple">
<li>UDP</li>
<li>ICMPv6</li>
<li>ARPv6</li>
<li>DHCPv6</li>
<li>Answer -&gt; <span class="transparent">ICMPv6</span></li>
</ul>
</li>
<li><p class="first">A company uses the SLAAC method to configure IPv6 addresses for the employee workstations. Which address will a client use as its default gateway?</p>
<ul class="simple">
<li>the unique local address of the router interface that is attached to the network</li>
<li>the global unicast address of the router interface that is attached to the network</li>
<li>the link-local address of the router interface that is attached to the network</li>
<li>the all-routers multicast address</li>
<li>Answer -&gt; <span class="transparent">the link-local address of the router interface that is attached to the network</span></li>
</ul>
</li>
<li><p class="first">Which set of commands will configure a router as a DHCP server that will assign IPv4 addresses to the 192.168.100.0/23 LAN while reserving the first 10 and the last addresses for static assignment?</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="o">--</span> <span class="mi">1</span> <span class="o">--</span>
<span class="n">dhcp</span> <span class="n">pool</span> <span class="n">LAN</span><span class="o">-</span><span class="n">POOL</span><span class="o">-</span><span class="mi">100</span>
<span class="n">ip</span> <span class="n">dhcp</span> <span class="n">excluded</span><span class="o">-</span><span class="n">address</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">100.1</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">100.9</span>
<span class="n">ip</span> <span class="n">dhcp</span> <span class="n">excluded</span><span class="o">-</span><span class="n">address</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">100.254</span>
<span class="n">network</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">100.0</span> <span class="mf">255.255</span><span class="o">.</span><span class="mf">254.0</span>
<span class="n">default</span><span class="o">-</span><span class="n">router</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">101.1</span>

<span class="o">--</span> <span class="mi">2</span> <span class="o">--</span>
<span class="n">ip</span> <span class="n">dhcp</span> <span class="n">excluded</span><span class="o">-</span><span class="n">address</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">100.1</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">100.9</span>
<span class="n">ip</span> <span class="n">dhcp</span> <span class="n">excluded</span><span class="o">-</span><span class="n">address</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">101.254</span>
<span class="n">ip</span> <span class="n">dhcp</span> <span class="n">pool</span> <span class="n">LAN</span><span class="o">-</span><span class="n">POOL</span><span class="o">-</span><span class="mi">100</span>
<span class="n">ip</span> <span class="n">network</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">100.0</span> <span class="mf">255.255</span><span class="o">.</span><span class="mf">254.0</span>
<span class="n">ip</span> <span class="n">default</span><span class="o">-</span><span class="n">gateway</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">100.1</span>

<span class="o">--</span> <span class="mi">3</span> <span class="o">--</span>
<span class="n">ip</span> <span class="n">dhcp</span> <span class="n">excluded</span><span class="o">-</span><span class="n">address</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">100.1</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">100.10</span>
<span class="n">ip</span> <span class="n">dhcp</span> <span class="n">excluded</span><span class="o">-</span><span class="n">address</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">101.254</span>
<span class="n">ip</span> <span class="n">dhcp</span> <span class="n">pool</span> <span class="n">LAN</span><span class="o">-</span><span class="n">POOL</span><span class="o">-</span><span class="mi">100</span>
<span class="n">network</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">100.0</span> <span class="mf">255.255</span><span class="o">.</span><span class="mf">254.0</span>
<span class="n">default</span><span class="o">-</span><span class="n">router</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">100.1</span> <span class="o">************************</span>

<span class="o">--</span> <span class="mi">4</span> <span class="o">--</span>
<span class="n">ip</span> <span class="n">dhcp</span> <span class="n">excluded</span><span class="o">-</span><span class="n">address</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">100.1</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">100.10</span>
<span class="n">ip</span> <span class="n">dhcp</span> <span class="n">excluded</span><span class="o">-</span><span class="n">address</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">100.254</span>
<span class="n">ip</span> <span class="n">dhcp</span> <span class="n">pool</span> <span class="n">LAN</span><span class="o">-</span><span class="n">POOL</span><span class="o">-</span><span class="mi">100</span>
<span class="n">network</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">100.0</span> <span class="mf">255.255</span><span class="o">.</span><span class="mf">255.0</span>
<span class="n">ip</span> <span class="n">default</span><span class="o">-</span><span class="n">gateway</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">100.1</span>
</pre></div>
</div>
<ul class="simple">
<li>The answer is: <span class="transparent">â 3 â</span></li>
</ul>
</li>
</ol>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="nat.html" class="btn btn-neutral float-right" title="NAT" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="acl.html" class="btn btn-neutral" title="ACLs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Patrick Brunswyck.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'20170824',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>