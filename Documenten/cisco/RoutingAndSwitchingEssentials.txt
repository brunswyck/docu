

Suppose that the network link between R1 and R2 is an Ethernet link and that the GigabitEthernet 0/1 interface of R1 is connected to that network,
as shown in Figure 1. CEF is not enabled.
To eliminate the recursive lookup,(map a next hop ip to what interface that is = if CEF not enabled)
a directly connected static route can be implemented using the following command:

R1(config)# ip route 192.168.2.0 255.255.255.0 GigabitEthernet 0/1

However, this may cause unexpected or inconsistent results.
The difference between an Ethernet multi-access network and a point-to-point serial network is that a point-to-point serial network has only
one other device on that network, the router at the other end of the link. With Ethernet networks,
there may be many different devices sharing the same multi-access network, including hosts and even multiple routers.
By only designating the Ethernet exit interface in the static route, the router will not have sufficient information to determine which device
is the next-hop device.

R1 knows that the packet needs to be encapsulated in an Ethernet frame and sent out the GigabitEthernet 0/1 interface.
However, R1 does not know the next-hop IPv4 address; therefore, it cannot determine the destination MAC address for the Ethernet frame.

Depending upon the topology and the configurations on other routers, this static route may or may not work.
It is recommended that when the exit interface is an Ethernet network, that a fully specified static route is used,
including both the exit interface and the next-hop address.
R3(config)# ip route 172.16.1.0 255.255.255.0 s0/0/1 192.168.1.2

As shown in Figure 2, when forwarding packets to R2, the exit interface is GigabitEthernet 0/1 and the next-hop IPv4 address is 172.16.2.2.

Note: With the use of CEF, a fully specified static route is no longer necessary. A static route using a next-hop address should be used.

Use the Syntax Checker in Figure 3 and 4 to configure and verify fully specified static routes on R2 and R3.

Default Static Route
--------------------
Routers commonly use default routes that are either configured locally or learned from another router, using a dynamic routing protocol. A default route does not require any left-most bits to match between the default route and the destination IPv4 address. A default route is used when no other routes in the routing table match the destination IP address of the packet. In other words, if a more specific match does not exist, then the default route is used as the Gateway of Last Resort.

Default static routes are commonly used when connecting:

    An edge router to a service provider network

    A stub router (a router with only one upstream neighbor router)

R1(config)# ip route 0.0.0.0 0.0.0.0 172.16.2.2

R1#show ip route static


R1(config)#do show ip route static
     172.31.0.0/16 is variably subnetted, 7 subnets, 5 masks
S       172.31.0.0/24 [1/0] via 172.31.1.193
S       172.31.1.128/26 [1/0] via 172.31.1.193
S       172.31.1.196/30 [1/0] via 172.31.1.193

R2(config)#ip route 172.31.1.0 255.255.255.128 S0/0/0
%Default route without gateway, if not a point-to-point interface, may impact performance

R2#show ip route ?
  WORD       Network to display information about or hostname
  bgp        Border Gateway Protocol (BGP)
  connected  Connected
  eigrp      Enhanced Interior Routing Protocol (EIGRP)
  ospf       Open Shortest Path First (OSPF)
  rip        Routing Information Protocol (RIP)
  static     Static routes
  summary    Summary of all routes
  |          Output Modifiers
  <cr>

R2#show ip route connected
 C   172.31.0.0/24  is directly connected, GigabitEthernet0/0
 C   172.31.1.192/30  is directly connected, Serial0/0/0
 C   172.31.1.196/30  is directly connected, Serial0/0/1


R3(config)#ip route 0.0.0.0 0.0.0.0 Serial 0/0/1
%Default route without gateway, if not a point-to-point interface, may impact performance
R3(config)#


ipv6 static routing
===================
R1(config)# ipv6 unicast-routing
R1(config)# show ipv6 route
R1#ping ipv6 2001.DB8:ACAD:4::2
R1(config)# ipv6 route 2001.DB8:ACAD:2::/64 2001.DB8:ACAD:4::2

R1(config)# show ipv6 route


As with IPv4, before any packet is forwarded by the router, the routing table process must resolve the route to determine the exit interface to use to forward the packet. The route resolvability process will vary depending upon the type of forwarding mechanism being used by the router. CEF (Cisco Express Forwarding) is the default behavior on most platforms running IOS 12.0 or later.

Figure 2 details the basic packet forwarding route resolvability process in the routing table for R1 without the use of CEF. When a packet is destined for the 2001:DB8:ACAD:3::/64 network, R1:

1. Looks for a match in the routing table and finds that it has to forward the packets to the next-hop IPv6 address 2001:DB8:ACAD:4::2. Every route that references only a next-hop IPv6 address and does not reference an exit interface must have the next-hop IPv6 address resolved using another route in the routing table with an exit interface.

2. R1 must now determine how to reach 2001:DB8:ACAD:4::2; therefore, it searches a second time looking for a match. In this case, the IPv6 address matches the route for the directly connected network 2001:DB8:ACAD:4::/64 with the exit interface Serial 0/0/0. This lookup tells the routing table process that this packet is forwarded out of that interface.

Therefore, it actually takes two routing table lookup processes to forward any packet to the 2001:DB8:ACAD:3::/64 network. When the router has to perform multiple lookups in the routing table before forwarding a packet, it is performing a process known as a recursive lookup.

A recursive static IPv6 route is valid (that is, it is a candidate for insertion in the routing table) only when the specified next hop resolves, either directly or indirectly, to a valid exit interface.

Use the Syntax Checker in Figure 3 and Figure 4 to configure next-hop static IPv6 routes.
